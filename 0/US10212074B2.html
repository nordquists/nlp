
    <html>
        <body>
            <search-app>
                <article class="result" itemscope="" itemtype="http://schema.org/ScholarlyArticle">
    <h1 itemprop="pageTitle">US10212074B2 - Level of hierarchy in MST for traffic localization and load balancing 
        - Google Patents</h1><section itemprop="abstract" itemscope="">
<h2>Abstract</h2>
<div html="" itemprop="content"><abstract lang="EN" load-source="patent-office" mxw-id="PA285654173">
<div class="abstract" id="p-0001" num="0000">In one embodiment, a multiple spanning tree (MST) region is defined in a network, where the MST region includes a plurality of network nodes interconnected by links. A MST cluster is defined within the MST region, where the MST cluster includes a plurality of network nodes selected from the plurality of network nodes of the MST region. A network node of the MST cluster generates one or more MST bridge protocol data units (BPDUs) that present the MST cluster as a single logical entity to network nodes of the MST region that are not included in the MST cluster, yet enables per-multiple spanning tree instance (per-MSTI) load balancing of traffic across inter-cluster links that connect network nodes included in the MST cluster and network nodes of the MST region that are not included in the MST cluster.</div>
</abstract>
</div>
</section><section itemprop="description" itemscope="">
<h2>Description</h2>
<div html="" itemprop="content"><div class="description" lang="EN" load-source="patent-office" mxw-id="PDES184851843">
<heading id="h-0001">RELATED APPLICATION</heading>
<div class="description-paragraph" id="p-0002" num="0001">This application is a continuation of U.S. patent application Ser. No. 13/168,571 filed on Jun. 24, 2011, the contents of which is incorporated by reference in its entirety.</div>
<heading id="h-0002">TECHNICAL FIELD</heading>
<div class="description-paragraph" id="p-0003" num="0002">The present disclosure relates generally to computer networks, and, more particularly, to multiple spanning tree protocols.</div>
<heading id="h-0003">BACKGROUND</heading>
<div class="description-paragraph" id="p-0004" num="0003">IEEE Std. 802.1Q-2005 multiple spanning tree protocol (MSTP) is widely used in computer networks. With IEEE Std. 802.1Q-2005 MSTP, a bridged network may be organized into multiple spanning tree (MST) regions. Frames originating at one network node inside of a MST region, and destined for another network node of the same MST region, are contained inside the MST region. From the point of view of nodes outside of the MST region, MST regions appear as a single logical entity (specifically, a single virtual bridge). As a result of this, load balancing of traffic is typically not available across the boundaries of MST regions. Even if there are multiple links that interconnect a MST is region with external nodes, only a single link generally may be utilized. This limitation of MST regions has proved problematic in certain network configurations. Sometimes it may be desirable to contain traffic among a particular set of network nodes and present them a single logical entity to external nodes, and also enable load balancing between the group of network nodes and external nodes. However, this is currently not possible using IEEE Std. 802.1Q-2005 MSTP.</div>
<description-of-drawings>
<heading id="h-0004">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<div class="description-paragraph" id="p-0005" num="0004">The embodiments described herein may be better understood by referring to the accompanying drawings in which like reference numerals indicate identically or functionally similar elements, of which:</div>
<div class="description-paragraph" id="p-0006" num="0005"> <figref idrefs="DRAWINGS">FIG. 1</figref> is a schematic block diagram of an example computer network comprising a plurality of network nodes interconnected by links;</div>
<div class="description-paragraph" id="p-0007" num="0006"> <figref idrefs="DRAWINGS">FIG. 2</figref> is a schematic block diagram of an example computer network that includes a plurality of network nodes, some of which are members of a master-satellite switching configuration;</div>
<div class="description-paragraph" id="p-0008" num="0007"> <figref idrefs="DRAWINGS">FIG. 3</figref> is a schematic block diagram of the example computer network of <figref idrefs="DRAWINGS">FIG. 1</figref> in which first and second MST clusters have been established with a MST region;</div>
<div class="description-paragraph" id="p-0009" num="0008"> <figref idrefs="DRAWINGS">FIG. 4</figref> is a schematic block diagram of an example network node, which is representative of the network nodes shown in <figref idrefs="DRAWINGS">FIGS. 1-3</figref>, and whose components may be used with the techniques for implementing MST clusters described herein;</div>
<div class="description-paragraph" id="p-0010" num="0009"> <figref idrefs="DRAWINGS">FIG. 5</figref> is a schematic block diagram of an intra-cluster MST BPDU that may be propagated between nodes within the same MST cluster to implement certain of the techniques described herein; and</div>
<div class="description-paragraph" id="p-0011" num="0010"> <figref idrefs="DRAWINGS">FIG. 6</figref> is a flow diagram of an example sequence of steps for implementing MST clusters within a network.</div>
</description-of-drawings>
<heading id="h-0005">DESCRIPTION OF EXAMPLE EMBODIMENTS</heading>
<heading id="h-0006">Overview</heading>
<div class="description-paragraph" id="p-0012" num="0011">According to embodiments of the disclosure, an additional level of hierarchy introduced to a multiple spanning tree (MST) environment. A MST region is defined in the network, where the MST region includes a plurality of network nodes interconnected by links. A MST cluster is defined within the MST region, where the MST cluster includes a plurality of network nodes selected from the plurality of network nodes of the MST region. A network node of the MST cluster generates one or more MST bridge protocol data units (BPDUs) that present the MST cluster as a single logical entity to network nodes of the MST region that are not included in the MST cluster, yet enable per-multiple spanning tree instance (per-MSTI) load balancing of traffic across inter-cluster links.</div>
<heading id="h-0007">Example Embodiments</heading>
<div class="description-paragraph" id="p-0013" num="0012">A computer network is a geographically distributed collection of nodes, such as bridges and switches, interconnected by communication links used to transport data between the nodes. Many types of computer networks are available, with the types ranging from local area networks (LANs) to wide area networks (WANs). The nodes typically communicate by exchanging discrete packets or messages of data according to pre-defined protocols. In this context, a protocol consists of a set of rules defining how the nodes interact with each other.</div>
<div class="description-paragraph" id="p-0014" num="0013">Most computer networks include redundant links so that a failure of any given link does not isolate any portion of the network. The existence of redundant links, however, may cause the formation of circuitous paths or “loops.” Loops are highly undesirable because data frames may traverse the loops indefinitely.</div>
<div class="description-paragraph" id="p-0015" num="0014">To avoid the formation of loops, most bridges and switches execute a spanning tree protocol which allows them to calculate an active network topology that is loop-free (i.e., a tree) and yet connects every node within the network (i.e., the tree is spanning). A basic spanning tree protocol, whose operation is illustrative of the class or protocols is IEEE Std. 802.1D-1998 spanning tree protocol (STP). In general, by executing IEEE Std. 802.1D-1998 STP, nodes elect a single node within the network to be the “Root.” For each LAN coupled to any node, exactly one port (the “Designated Port”) on one node (the “Designated Bridge”) is elected. The Designated Bridge is typically the one closest to the Root. All ports on the Root are Designated Ports.</div>
<div class="description-paragraph" id="p-0016" num="0015">Each non-Root also selects one port from among its non-Designated Ports (its “Root Port”) which gives the lowest cost path to the Root. The Root Ports and Designated Ports are selected for inclusion in the active topology and are placed in a forwarding state so that data frames may be forwarded to and from these ports. Ports not included within the active topology are placed in a blocking state. When a port is in the blocking state, data frames will not be forwarded to, or received from, the port. A network administrator may also exclude a port from the spanning tree by placing it in a disabled state.</div>
<div class="description-paragraph" id="p-0017" num="0016">To obtain the information necessary to run IEEE Std. 802.1D-1998 STP, nodes exchange special messages called bridge protocol data unit (BPDU) messages or simply BPDUs. BPDUs carry information, such as assumed root and lowest root path cost, used in computing the active topology.</div>
<div class="description-paragraph" id="p-0018" num="0017">In addition to IEEE Std. 802.1D-1998 STP, a variety of more advanced spanning tree protocols have been developed, that implement various refinements, optimizations, and extensions to the operation of IEEE Std. 802.1D-1998 STP. One such protocol is IEEE Std. 802.1Q-2005 multiple spanning tree protocol (MSTP). IEEE Std. 802.1Q-2005 MSTP organizes a bridged network into multiple spanning tree (MST) regions. Within each MST region, an internal spanning tree (IST) is established which provides connectivity to all nodes within the respective region, and to the ISTs established within other regions. The IST established within each MST region also provides connectivity to one common spanning tree (CST) established outside of the MST regions. The IST of a given MST region receives and sends BPDUs to the CST. Accordingly, all bridges of the bridged network are connected by a single Common and Internal Spanning Tree (CIST). From the point of view of outside devices, each MST region appears as a single logical entity, specifically, a single virtual bridge.</div>
<div class="description-paragraph" id="p-0019" num="0018">Within each MST region, IEEE Std. 802.1Q-2005 MSTP establishes a plurality of active topologies, each of which is called a multiple spanning tree instance (MSTI). Virtual LANs (VLANs) are assigned or mapped to the MSTIs. Because VLANs may be assigned to different MSTIs, frames associated with different VLANs can take different paths through a MST region. Each MSTI is basically a spanning tree that exists only inside the respective MST region, and the MSTIs do not interact outside of the MST region. Frames originating at one network node inside of a MST region and destined for another network node of the same MST region, follow a corresponding MSTI to reach their destination. Such internal traffic is contained inside the MST region, and is not allowed to, for example, leave the MST region, take external links, and then renter the MST region, as this may lead to the formation of loops.</div>
<div class="description-paragraph" id="p-0020" num="0019">IEEE Std. 802.1Q-2005 MSTP uses BPDUs to establish the ISTs and MSTIs, as well as to define the boundaries of the different MST regions. Unlike some other protocols, the bridges do not send separate BPDUs for each MSTI. Instead, every BPDU carries the information needed to compute the active topology for all of the MSTIs defined within the respective MST region.</div>
<div class="description-paragraph" id="p-0021" num="0020">As discussed above, from the point of view of external node, each MST region appears as a single logical entity (specifically, a single virtual bridge). As a result of this, load balancing of traffic is typically not available across boundaries of MST regions. Even if there are multiple links that interconnect a MST region with external nodes, only a single link generally may be utilized. This limitation of MST regions has proved problematic in certain network configurations. Sometimes it may be desirable to contain traffic among a particular set of network nodes and present them a single logical entity to external nodes, and also enable load balancing between the group of network nodes and external nodes. However, this is currently not possible using IEEE Std. 802.1Q-2005 MSTP.</div>
<div class="description-paragraph" id="p-0022" num="0021"> <figref idrefs="DRAWINGS">FIG. 1</figref> is a schematic block diagram of an example computer network <b>100</b> comprising a plurality of network nodes <b>110</b>-<b>155</b> (e.g., bridges or switches) interconnected by links, which illustrate some of the above discussed issues. The nodes <b>110</b>-<b>155</b> are interconnected by a plurality of links, referred to herein by reference to the names of the nodes at the opposing ends of the links (e.g., link sw<b>0</b>-sw<b>1</b> being the link connecting network node sw<b>0</b> <b>110</b> to network node sw<b>1</b> <b>115</b>, link sw<b>0</b>-sw<b>2</b> being the link connecting network node sw<b>0</b> <b>100</b> to network node sw<b>2</b> <b>120</b>, etc.). Suppose it is desired for nodes sw<b>4</b> <b>130</b>, sw<b>5</b> <b>135</b> and sw<b>6</b> <b>140</b> to present themselves to external nodes as a single logical entity, and to contain internal traffic among themselves. Further, suppose it is also desired that nodes sw<b>7</b> <b>145</b>, sw<b>8</b> <b>150</b> and sw<b>9</b> <b>155</b> present themselves as a single logical entity and contain internal traffic among themselves, and, additionally, that nodes sw<b>2</b> <b>120</b> and sw<b>3</b> <b>125</b> present themselves as a single logical entity and contain internal traffic among themselves. One could establish three MST regions: Region <b>1</b> <b>160</b> encompassing nodes sw<b>2</b> <b>120</b> and sw<b>3</b> <b>125</b>; Region <b>2</b> <b>170</b> encompassing nodes sw<b>4</b> <b>130</b>, sw<b>5</b> <b>135</b>, and sw<b>6</b> <b>140</b>; and Region <b>3</b> <b>180</b> encompassing nodes sw<b>7</b> <b>145</b>, sw<b>8</b> <b>150</b>, and sw<b>9</b> <b>155</b>. The establishment of such MST regions may effectively contain internal traffic. However, load balancing may not be enabled across the boundaries of the three MST regions, as each of the MST regions would appear as single virtual bridge on the CST. For example, all traffic between Region <b>1</b> <b>160</b> and Region <b>2</b> <b>170</b> would be allowed only to travel on a single link (e.g., link sw<b>2</b>-sw<b>4</b>) selected for inclusion in the CST, while other redundant links (e.g., link sw<b>2</b>-sw<b>6</b>) would not be used. Accordingly, available network bandwidth may not be efficiently utilized.</div>
<div class="description-paragraph" id="p-0023" num="0022">Network configurations similar to that shown in <figref idrefs="DRAWINGS">FIG. 1</figref>, with their corresponding issues, may arise in a variety of settings. For example, the setting may involve a master-satellite switching configuration. <figref idrefs="DRAWINGS">FIG. 2</figref> is a schematic block diagram of an example computer network <b>200</b> that includes a plurality of network nodes <b>210</b>-<b>280</b>, some of which (i.e. nodes sw<b>2</b> <b>220</b>, sw<b>3</b> <b>230</b> and sw<b>4</b> <b>240</b>) are members of a master-satellite switching configuration. Master node sw<b>2</b> <b>220</b> is connected to satellite nodes sw<b>3</b> <b>230</b> and sw<b>4</b> <b>240</b>. To present Master node sw<b>2</b> <b>220</b> and satellite nodes sw<b>3</b> <b>230</b> and sw<b>4</b> <b>240</b> as a single logical entity, and contain internal traffic among them, one may place such nodes within a MST region, i.e., Region <b>290</b>. Use of such a MST region, for example, may prevent traffic received from host <b>1</b> <b>250</b> and destined for host <b>2</b> <b>280</b>, from being directed along a path from satellite node sw<b>3</b> <b>230</b>, to node sw<b>5</b> <b>260</b>, to node sw<b>6</b> <b>270</b>, and then back to node sw<b>4</b> <b>240</b>, to reach host <b>2</b> <b>280</b>, rather than utilize the sw<b>3</b>-sw<b>4</b> link. However, use of such a MST region may also prevent load balancing across links to external nodes, for example, across links sw<b>3</b>-sw<b>5</b> and sw<b>4</b>-sw<b>6</b>, due to the MST region appearing to external nodes as a single virtual bridge.</div>
<div class="description-paragraph" id="p-0024" num="0023">Similarly, the above discussed issues may arise in the context of a multi-chassis virtual switching system (VSS) using MST in conjunction with virtual switch links (VSLs), or in the context of a data center, using MST among backbone or “top-of-the rack” devices. In these example scenarios as well, it may be desirable to both contain traffic among a particular set of nodes, and cause the group of nodes to externally present as a single logical entity, while also enabling load balancing between the group of nodes and external nodes. Accordingly, there is a need for a technique that can achieve these formerly mutually exclusive goals within a MST environment.</div>
<div class="description-paragraph" id="p-0025" num="0024">MST Clusters</div>
<div class="description-paragraph" id="p-0026" num="0025">According to embodiments of the present disclosure, an additional level of hierarchy, referred to herein as a “MST cluster”, is defined within a MST environment. A MST cluster includes a set of nodes selected from the nodes of a MST region. The group of nodes selected for inclusion in a MST cluster may be a group of nodes for which traffic containment is desired. The cluster is presented within BPDUs as a single logical entity. Internal traffic that is sourced and destined for network nodes of the MST cluster is contained within the MST cluster, and passed over “intra-cluster links”, i.e. links that couple nodes located within the MST cluster.</div>
<div class="description-paragraph" id="p-0027" num="0026">Unlike a MST region, load balancing is enabled across the boundary of a MST cluster. Since nodes within the MST cluster and the rest of the MST region may have consistent MST configurations (i.e., share the same MST region name, revision number and MST configuration table), per-MSTI load balancing may occur across the boundary of the MST cluster. In this manner, external traffic that is sourced from, or destined for, nodes of the MST region located external to MST cluster may be load balanced across “inter-cluster links”, i.e. links that couple nodes located within the MST cluster with nodes located external to the MST cluster that are within the MST region.</div>
<div class="description-paragraph" id="p-0028" num="0027"> <figref idrefs="DRAWINGS">FIG. 3</figref> is a schematic block diagram of the example computer network of <figref idrefs="DRAWINGS">FIG. 1</figref> in which first and second MST clusters <b>310</b>, <b>320</b> have been established within a MST region <b>330</b>. Network nodes sw<b>2</b> to sw<b>9</b> <b>120</b>-<b>155</b> are arranged into a MST region <b>330</b>. Within the MST region <b>330</b>, a plurality of MSTIs may be established. Nodes sw<b>4</b> <b>130</b>, sw<b>5</b> <b>135</b> and sw<b>6</b> <b>140</b>, in this example, are arranged into a first MST cluster <b>310</b>, with links sw<b>4</b>-sw<b>6</b>, sw<b>4</b>-sw<b>5</b> and sw<b>5</b>-sw<b>6</b> serving as intra-cluster links. Links sw<b>0</b>-sw<b>4</b>, sw<b>2</b>-sw<b>4</b>, sw<b>2</b>-sw<b>6</b>, sw<b>4</b>-sw<b>7</b> and sw<b>6</b>-sw<b>8</b> serve as inter-cluster links, and couple the first MST cluster <b>310</b> to external nodes. The first MST cluster <b>310</b> is presented to external nodes as a single logical entity, and internal traffic sourced and destined for network nodes within the first MST cluster <b>310</b> is contained therein.</div>
<div class="description-paragraph" id="p-0029" num="0028">Similarly, nodes sw<b>7</b> <b>145</b>, sw<b>8</b> <b>150</b> and sw<b>9</b> <b>155</b>, in this example, are arranged into a second MST cluster <b>320</b>, with links sw<b>7</b>-sw<b>8</b>, sw<b>7</b>-sw<b>9</b> and sw<b>8</b>-sw<b>9</b> serving as intra-cluster links. Links sw<b>1</b>-sw<b>7</b>, sw<b>3</b>-sw<b>7</b>, sw<b>3</b>-sw<b>8</b>, sw<b>4</b>-sw<b>7</b> and sw<b>6</b>-sw<b>8</b> serve as inter-cluster links, and couple the second MST cluster <b>320</b> to external nodes. Like the first MST cluster <b>310</b>, the second MST cluster <b>330</b> is presented to external nodes as a single logical entity, and internal traffic sourced and destined for network nodes within the second MST cluster <b>320</b> is contained therein.</div>
<div class="description-paragraph" id="p-0030" num="0029">Since nodes within the first and second MST clusters <b>310</b>, <b>320</b>, and the rest of the MST region <b>330</b>, have consistent MST configurations (i.e., share the same MST region name, revision number and MST configuration table) per-MSTI load balancing may occur across the boundaries of the MST clusters. That is, differing MSTIs of the MST region <b>330</b> may utilize different ones of the inter-cluster links, and frames associated with different MSTIs, may travel over different ones of the inter-cluster links. For example, per-MSTI load balancing may permit load balancing between inter-cluster links sw<b>2</b>-sw<b>4</b> and sw<b>2</b>-sw<b>6</b>, through association of some VLANs with an MSTI that utilizes inter-cluster link sw<b>2</b>-sw<b>4</b> and blocks inter-cluster link sw<b>2</b>-sw<b>6</b>, and other VLANs with an MSTI that utilizes inter-cluster link sw<b>2</b>-sw<b>6</b> and blocks link inter-cluster sw<b>2</b>-sw<b>4</b>. In this manner, load balancing may be permitted across cluster boundaries, while MST clusters still present an appearance to external devices of a single logical entity.</div>
<div class="description-paragraph" id="p-0031" num="0030"> <figref idrefs="DRAWINGS">FIG. 4</figref> is a schematic block diagram of an example network node (e.g., a bridge or switch) <b>400</b>, which is representative of the network nodes <b>110</b>-<b>155</b> and <b>210</b>-<b>280</b> shown in <figref idrefs="DRAWINGS">FIGS. 1-3</figref>, and whose components may be used with the techniques for implementing MST clusters described herein. The example network node <b>400</b> includes a plurality of network interfaces <b>410</b>, processor(s) <b>420</b>, and a memory <b>430</b> interconnected by a system bus <b>450</b>. The network interfaces <b>410</b> contain the mechanical, electrical, and signaling circuitry for communicating over links. The memory <b>430</b> includes a plurality of storage locations for storing software and data structures, including software and data structures. The processor(s) <b>420</b> include logic configured to execute the software and manipulate data from the data structures. An operating system <b>432</b>, portions of which are resident in memory <b>430</b> and executed by the processor(s) <b>420</b>, functionally organizes the network node <b>400</b>. A MSTP process <b>434</b> may interact with the operating system <b>432</b> to implement, for example, aspects of IEEE Std. 802.1Q-2005 MSTP, as well as the novel techniques for adding an additional level of hierarchy (i.e. MST clusters) to MST regions discussed herein.</div>
<div class="description-paragraph" id="p-0032" num="0031"> <figref idrefs="DRAWINGS">FIG. 5</figref> is a schematic block diagram of an intra-cluster MST BPDU <b>500</b> that may be propagated between nodes within the same MST cluster to implement certain of the techniques described herein. An intra-cluster MST BPDU <b>500</b> is intended to be propagated only within a MST cluster, and should not knowingly be forwarded across a cluster boundary. However, as discussed below, certain properties of the intra-cluster MST BPDU may permit interoperability with nodes running legacy MST implementations, which may not be aware of MST clusters or their respective boundaries.</div>
<div class="description-paragraph" id="p-0033" num="0032">A number of the fields within the intra-cluster MST BPDU <b>500</b> may be identical, or otherwise similar, to those within an IEEE Std. 802.1Q-2005 MSTP BPDU, and accordingly will be familiar to those skilled in the art. For example, a Protocol Identifier field <b>502</b>, a Protocol Version Identifier field <b>504</b>, a BPDU Type field <b>506</b>, a CIST Flags field <b>508</b>, a CIST Root Identifier field <b>510</b>, a CIST External Path Cost field <b>512</b>, a CIST Regional Root Identifier field <b>514</b>, a CIST Port Identifier filed <b>516</b>, a Message Age field <b>518</b>, a Max Age field <b>520</b>, a Hello Time field <b>522</b>, a Forward Delay filed <b>524</b>, a Version <b>1</b> Length filed <b>526</b>, a Version <b>3</b> Length field <b>528</b>, a MST Configuration Identifier field <b>530</b>, a CIST Internal Root Path Cost field <b>532</b>, a CIST Remaining Hops field <b>536</b>, and one or more MSTI configuration Messages <b>532</b>, may be identical, or otherwise similar, to those within a IEEE Std. 802.1Q-2005 MSTP BPDU. In the interest of brevity, the requirements and functions of such fields are not described in detail herein, and only fields that have been redefined, or newly introduced, as compared to an IEEE 802.1Q-2005 MSTP BPDU, are described in detail below.</div>
<div class="description-paragraph" id="p-0034" num="0033">Following a CIST Internal Root Path Cost field <b>532</b>, an IEEE 802.1Q-2005 MSTP BPDU typically would include a CIST Bridge Identifier field to indicate the bridge identifier of the node that transmitted the BPDU. In order to present an MST cluster as a single logical entity, such field may be redefined to operate as a CIST Cluster Root Identifier field <b>534</b>, to store the bridge identifier of a node of the cluster (i.e. a CIST cluster root node) that has the lowest cost path to the CIST regional root node. For example, referring to <figref idrefs="DRAWINGS">FIG. 3</figref>, node sw<b>4</b> <b>130</b> may serve as the CIST cluster root node. In which case, nodes sw<b>4</b> <b>130</b>, sw<b>5</b> <b>135</b> and sw<b>6</b> <b>140</b> would each generate intra-cluster MST BPDUs <b>500</b> that include the bridge identifier of node sw<b>4</b> <b>130</b> in their CIST Cluster Root Identifier field <b>534</b>.</div>
<div class="description-paragraph" id="p-0035" num="0034">Typically, an IEEE 802.1Q-2005 MSTP BPDU would terminate after one or more MSTI Configuration Messages <b>538</b>. To implement the techniques described herein, a new CIST Cluster Configuration Message <b>570</b> may be inserted after the one or more MSTI Configuration Messages <b>538</b>. Since the CIST Cluster Configuration Message <b>570</b> is located after the MSTI Configuration Messages <b>538</b>, it will be beyond the length typically indicated in the Version 3 Length field <b>528</b>. This may advantageously permit interoperation with nodes that are running certain legacy MSTP implementations, which would typically ignore information beyond the length indicated in the Version 3 length field.</div>
<div class="description-paragraph" id="p-0036" num="0035">The CIST Cluster Configuration Message <b>570</b> may include a CIST Intra Cluster Root Path Cost field <b>544</b>, a CIST Cluster Bridge Identifier filed <b>546</b>, and a CIST Cluster Remaining Hops field <b>548</b>.</div>
<div class="description-paragraph" id="p-0037" num="0036">The CIST Intra Cluster Root Path Cost field <b>544</b> stores a cost within the cluster to reach the CIST cluster root node. For example, referring to <figref idrefs="DRAWINGS">FIG. 3</figref>, if node sw<b>6</b> <b>140</b> generated the Intra Cluster MST BPDU <b>500</b>, and node sw<b>4</b> <b>130</b> is the CIST cluster root node, the CIST Intra Cluster Root Path Cost field <b>544</b> would store a cost between node sw<b>4</b> <b>130</b> and node sw<b>6</b> <b>140</b>.</div>
<div class="description-paragraph" id="p-0038" num="0037">The CIST Cluster Bridge Identifier field <b>546</b> stores the bridge identifier of the node that generated the Intra Cluster MST BPDU <b>500</b>. For example, referring to <figref idrefs="DRAWINGS">FIG. 3</figref>, if node sw<b>6</b> <b>140</b> generated the Intra Cluster MST BPDU <b>500</b>, its bridge identifier would be included in the CIST Cluster Bridge Identifier field <b>546</b>.</div>
<div class="description-paragraph" id="p-0039" num="0038">The CIST Cluster Remaining Hops field <b>548</b> stores a number of hops within the MST cluster which limits the propagation and longevity of received spanning tree information for the CIST.</div>
<div class="description-paragraph" id="p-0040" num="0039">Following the CIST Cluster Configuration Message <b>570</b>, one or more MSTI Cluster Configuration Messages <b>580</b>, corresponding to the cluster described in the CIST Cluster Configuration Message <b>570</b>, may be included to provide information about respective MSTIs supported by the MST cluster. As with the CIST Cluster Configuration Message <b>570</b>, the MSTI Cluster Configuration Messages <b>580</b> are beyond the length typically indicated in the Version 3 Length field <b>528</b> and thus will typically be ignored by legacy MSTP implementations.</div>
<div class="description-paragraph" id="p-0041" num="0040">Each such message <b>570</b> may be similar to a MSTI Configuration Message <b>538</b>, but instead contain MST cluster specific information. A MSTI Cluster Configuration Message may include a MSTI Cluster Root Identifier field <b>550</b>, a MSTI Intra Cluster Root Path Cost field <b>552</b>, and a MSTI Cluster Remaining Hops field <b>554</b>.</div>
<div class="description-paragraph" id="p-0042" num="0041">The MSTI Cluster Root Identifier field <b>550</b> stores the bridge identifier of a node of the cluster serving as a root node of the cluster for the respective MSTI. For example, referring to <figref idrefs="DRAWINGS">FIG. 3</figref>, node sw<b>6</b> <b>140</b> may serve as the root node of the cluster for one MSTI, and node sw<b>4</b> <b>140</b> may serve as the root node of the cluster for another MSTI. In each such case, the respective node's bridge identifier may be stored in the MSTI Cluster Root Identifier field <b>550</b>.</div>
<div class="description-paragraph" id="p-0043" num="0042">The MSTI Intra Cluster Root Path Cost field <b>552</b> stores a cost within the cluster to reach the cluster root node for the respective MSTI. For example, referring to <figref idrefs="DRAWINGS">FIG. 3</figref>, if node sw<b>4</b> <b>130</b> generated the Intra Cluster MST BPDU <b>500</b>, and node sw<b>4</b> <b>130</b> is the cluster root node for the respective MSTI, the MSTI Intra Cluster Root Path Cost field <b>552</b> would store a cost between node sw<b>6</b> <b>140</b> and node sw<b>4</b> <b>130</b>.</div>
<div class="description-paragraph" id="p-0044" num="0043">The MSTI Cluster Remaining Hops field <b>554</b> stores a number of hops within the MST cluster which limits the propagation and longevity of received spanning tree information for the respective MSTI.</div>
<div class="description-paragraph" id="p-0045" num="0044">The above discussed intra-cluster MST BPDU <b>500</b> may be limited in size due to Ethernet frame size limits, such that, a intra-cluster MST BPDU <b>500</b> may consume no more than about 1500 bytes. As such, a single intra-cluster MST BPDU <b>500</b> may be limited to contain information for at most 32 different MSTIs, in addition to the CIST. If more MSTIs are configured, multiple intra-cluster MST BPDUs may be utilized to describe the network configuration.</div>
<div class="description-paragraph" id="p-0046" num="0045">The information contained in BPDUs, and that is used to select root nodes and shortest paths by a spanning tree protocol, is typically referred to a “spanning tree priority vector.” Spanning tree priority vectors provide a basis for a concise specification of a protocol's computation of the active topology. In IEEE 802.1Q-2005 MSTP, the CIST priority vector consists of a) root identifier (RootID) (i.e., the bridge identifier of the CIST root node), b) external root path cost (ExtRootPathCost) (i.e., the path cost between MST Regions from the transmitting Bridge to the CIST Root), c) regional root identifier (RRootID) (i.e., the bridge identifier of the CIST regional root node), d) internal root path cost (IntRootPathCost) (i.e., the path cost to the CIST regional root node), e) designated bridge identifier (DesignatedBridgeID) (i.e., the bridge identifier for the transmitting node for the CIST), f) Designated Port Identifier (DesignatedPortID) (i.e., the Port Identifier for the transmitting port for the CIST) and g) the BPDU-receiving port ID (RcvPortID) which is not conveyed in BPDUs, but used as a tie-breaker between otherwise equal priority vectors within a receiving node. To implement the additional level of hierarchy as described herein, the IEEE 802.1Q-2005 MSTP CIST priority vector may be modified. A cluster root identifier (CRootID) (i.e., the bridge identifier of the CIST cluster root node) and an intra-cluster root path cost (IntraRootPathCost) (i.e., the path cost to the CIST cluster root node) may be added to the priority vector. Accordingly, a complete CIST priority vector that supports MST clusters may be defined as: root identifier (RootID), b) external root path cost (ExtRootPathCost), c) regional root identifier (RRootID), d) internal root path cost (IntRootPathCost), e) cluster root identifier (CRootID), f) intra-cluster root path cost (IntraRootPathCost), g) designated bridge identifier (DesignatedBridgeID), h) Designated Port Identifier (DesignatedPortID) and i) the BPDU-receiving port ID (RcvPortID). It should be understood that external root path cost (ExtRootPathCost) is updated across MST region boundaries, internal root path cost (IntRootPathCost) is updated across MST cluster boundaries, but not within a MST cluster, and intra-cluster root path cost (IntraRootPathCost) is updated within a MST cluster.</div>
<div class="description-paragraph" id="p-0047" num="0046">Similarly, in IEEE 802.1Q-2005 MSTP, the MST priority vector consists of a) regional root identifier (RRootID) (i.e., the bridge identifier of the MSTI regional root for this particular MSTI in this MST region), b) internal root path cost (IntRootPathCost) (i.e., the path cost to the MSTI Regional Root for this particular MSTI in this MST region), c) designated bridge identifier (DesignatedBridgeID) (i.e., the bridge identifier for the transmitting node for this MSTI), d) Designated Port Identifier (DesignatedPortID) (i.e., the port identifier for the transmitting port for this MSTI) and e) receiving port identifier (RcvPortID), which is not conveyed in BPDUs, but used as tie-breaker between otherwise equal priority vectors within a receiving node. To implement the additional level of hierarchy as described herein, the IEEE 802.1Q-2005 MST priority vector may be modified. A cluster root identifier (CRootID) (i.e., the bridge identifier of the cluster root node for this MSTI) and an intra-cluster root path cost (IntraRootPathCost) (i.e., the path cost to the cluster root node for this MSTI) are added to the priority vector. Accordingly, a complete MST priority vector that supports MST clusters may be defined as: a) regional root identifier (RRootID), b) internal root path cost (IntRootPathCost), c) cluster root identifier (CRootID), d) intra-cluster root path cost (IntraRootPathCost), e) designated bridge identifier (DesignatedBridgeID), f) Designated Port Identifier (Designated-PortID) and f) receiving port identifier (RcvPortID).</div>
<div class="description-paragraph" id="p-0048" num="0047"> <figref idrefs="DRAWINGS">FIG. 6</figref> is a flow diagram of an example sequence of steps <b>600</b> for implementing MST clusters within a network. Such sequence of steps may be implemented, at least in part, by MSTP process <b>434</b>, working in conjunction with the operating system <b>432</b>, when their instructions are executed on processor(s) <b>220</b>. At step <b>610</b> a multiple spanning tree (MST) region is defined that includes a plurality of network nodes interconnected by links. At step <b>620</b>, a MST cluster is defined within the MST region, where the MST cluster includes a plurality of network nodes selected from the plurality of network nodes of the MST region. At step <b>630</b>, MST BPDUs are generated that present the MST cluster as a single logical entity to network nodes of the MST region that are not included in the MST cluster, yet enables per-MSTI load balancing of traffic across inter-cluster links that connect network nodes included in the MST cluster and network nodes of the MST region that are not included in the MST cluster. Specifically, the BPDUs may include a CIST Cluster Root Identifier field <b>534</b>, that stores the bridge identifier of a node of the cluster that has the lowest cost path to CIST regional root node; may include one or more MSTI Configuration Messages <b>570</b>, that indicate a CIST intra cluster root path cost, a CIST cluster bridge identifier, and a CIST cluster remaining hops count; and may include one or more corresponding MSTI Cluster Configuration Messages <b>580</b>, that indicate a MSTI cluster root identifier, MSTI intra cluster root path cost, and a MSTI cluster remaining hops count. Further, by specification of consistent MST configurations (i.e., the same MST region name, revision number and MST configuration table), per-MSTI load balancing may be provided across inter-cluster links.</div>
<div class="description-paragraph" id="p-0049" num="0048">In summary, the present disclosure provides an additional level of hierarchy, (MST clusters) within a MST environment. A MST cluster includes a set of nodes selected from the nodes of a MST region. A MST cluster is presented within BPDUs as a single logical entity. Internal traffic that is sourced and destined for network nodes of the MST cluster is contained within the MST cluster, and passed over intra-cluster links. Since nodes within the MST cluster and the rest of the MST region may have consistent MST configurations, per-MSTI load balancing may occur across the boundary of the MST cluster. In this manner, external traffic that is sourced from, or destined for, nodes of the MST region located external to MST cluster may be load balanced across inter-cluster links.</div>
<div class="description-paragraph" id="p-0050" num="0049">It should be understood that various adaptations and modifications may be made within the spirit and scope of the embodiments herein. For example, at least some of the above-described embodiments may be implemented in software, in hardware, or a combination thereof. A software implementation may include computer-executable instructions stored in a non-transitory computer-readable medium, such as a volatile or persistent memory, a hard-disk, a compact disk (CD), or other tangible medium. A hardware implementation may include configured processors, logic circuits, application specific integrated circuits, and/or other types of hardware components. Further, a combined software/hardware implementation may include both computer-executable instructions stored in a non-transitory computer-readable medium, as well as one or more hardware components, for example, processors, memories, etc. Accordingly, it should be understood that the above descriptions are meant to be taken only by way of example. It is the object of the appended claims to cover all such variations and modifications as come within the true spirit and scope of the embodiments herein.</div>
</div>
</div>
</section><section itemprop="claims" itemscope="">
<h2>Claims (<span itemprop="count">20</span>)</h2>
<div html="" itemprop="content"><div class="claims" lang="EN" load-source="patent-office" mxw-id="PCLM178737779">
<claim-statement>What is claimed is:</claim-statement>
<div class="claim"> <div class="claim" id="CLM-00001" num="00001">
<div class="claim-text">1. A method comprising:
<div class="claim-text">defining a multiple spanning tree (MST) region in a network, the MST region comprising a plurality of network nodes interconnected by links;</div>
<div class="claim-text">defining a plurality of non-overlapping MST clusters within the MST region, each of the MST clusters being a subset of at least two of the plurality of network nodes within the MST region, each of the MST clusters presenting itself as a single logical entity and permitting traffic on a plurality of inter-cluster links associated with the subset of the plurality of network nodes; and</div>
<div class="claim-text">enabling load balancing of traffic across the plurality of inter-cluster links, each link of the plurality of inter-cluster links connecting a respective network node in one of the MST clusters to a respective network node of the MST region that is outside of the one of the MST clusters.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00002" num="00002">
<div class="claim-text">2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising: including a bridge identifier of a network node of the one of the MST clusters that has a lowest cost path to a Common and Internal Spanning Tree (CIST) regional root node in one or more MST bridge protocol data units (BPDUs).</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00003" num="00003">
<div class="claim-text">3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the bridge identifier of the network node of the one of the MST clusters that has the lowest cost path to the CIST regional root node is stored in a CIST Cluster Root Identifier field of the one or more MST BPDUs.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00004" num="00004">
<div class="claim-text">4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<div class="claim-text">including a cost within the one of the MST clusters to reach a Common and Internal Spanning Tree (CIST) cluster root node in one or more MST bridge protocol data units (BPDUs).</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00005" num="00005">
<div class="claim-text">5. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the cost within the one of the MST clusters to reach the CIST cluster root node is stored in a CIST Intra Cluster Root Path Cost field of a CIST Cluster Configuration Message in the one or more MST BPDUs.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00006" num="00006">
<div class="claim-text">6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<div class="claim-text">generating, by one or more processors, one or more MST bridge protocol data units (BPDUs) that present the one of the MST clusters as a single logical entity to network nodes of the MST region that are not included in the MST cluster; and</div>
<div class="claim-text">including a respective bridge identifier of a particular network node that generated the MST BPDUs in the one or more MST BPDUs.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00007" num="00007">
<div class="claim-text">7. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the particular network node that generated the MST BPDUs is stored in a MSTI Cluster Root Identifier field of a MSTI Cluster Configuration Message in the one or more MST BPDUs.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00008" num="00008">
<div class="claim-text">8. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<div class="claim-text">including a number of hops within the one of the MST clusters for a Common and Internal Spanning Tree (CIST) in one or more MST bridge protocol data units (BPDUs).</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00009" num="00009">
<div class="claim-text">9. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the number of hops within the one of the MST clusters for the CIST is stored in a CIST Cluster Remaining Hops field of a CIST Cluster Configuration Message in the one or more MST BPDUs.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00010" num="00010">
<div class="claim-text">10. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<div class="claim-text">including a respective bridge identifier of a particular node of the one of the MST clusters serving as a root node of the one of the MST clusters for a respective MSTI in one or more MST bridge protocol data units (BPDUs).</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00011" num="00011">
<div class="claim-text">11. The method of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein a cost within the one of the MST clusters to reach the root node associated with the respective MSTI cluster is stored in a MSTI Cluster Root Identifier field of a MSTI Cluster Configuration Message in the one or more MST BPDUs.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00012" num="00012">
<div class="claim-text">12. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<div class="claim-text">including a cost within the one of the MST clusters to reach a cluster root node for a respective MSTI in one or more MST bridge protocol data units (BPDUs).</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00013" num="00013">
<div class="claim-text">13. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the cost within the one of the MST clusters to reach the cluster root node for the respective MSTI is stored in a MSTI Intra Cluster Root Path Cost field of a MSTI Cluster Configuration Message in the one or more MST BPDUs.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00014" num="00014">
<div class="claim-text">14. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<div class="claim-text">including a number of hops within the one of the MST clusters for a respective MSTI in one or more MST bridge protocol data units (BPDUs).</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00015" num="00015">
<div class="claim-text">15. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the number of hops within the one of the MST clusters for the respective MSTI is stored in a MSTI Cluster Remaining Hops field of a MSTI Cluster Configuration Message in the one or more MST BPDUs.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00016" num="00016">
<div class="claim-text">16. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the one or more MST BPDUs are intra cluster MST BPDUs.</div>
</div>
</div> <div class="claim"> <div class="claim" id="CLM-00017" num="00017">
<div class="claim-text">17. An apparatus comprising:
<div class="claim-text">a network interface configured to couple the apparatus to one or more network nodes of a network;</div>
<div class="claim-text">a processor coupled to the network interface and configured to execute one or more processes; and</div>
<div class="claim-text">a memory configured to store a multiple spanning tree protocol (MSTP) process executable by the processor, the MSTP process when executed operable to:
<div class="claim-text">determine a multiple spanning tree (MST) region has been defined in the network, wherein the MST region comprises a plurality of network nodes interconnected by links;</div>
<div class="claim-text">determine a plurality of non-overlapping MST clusters within the MST region, each of the MST clusters being a subset of at least two of the plurality of network nodes within the MST region, wherein each of the MST clusters presenting itself as a single logical entity and permits traffic on a plurality of inter-cluster links associated with the subset of the plurality of network nodes; and</div>
<div class="claim-text">enable load balancing of traffic across the plurality of inter-cluster links, each link of the plurality of inter-cluster links connecting a respective network node in one of the MST clusters to a respective network node of the MST region that is outside of the one of the MST clusters.</div>
</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00018" num="00018">
<div class="claim-text">18. The apparatus of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein a bridge identifier is stored in a Common and Internal Spanning Tree (CIST) Cluster Root Identifier field of one or more MST bridge protocol data units (BPDUs), wherein a CIST Cluster Configuration Message in the one or more MST BPDUs comprises a CIST Intra Cluster Root Path Cost field containing a value representing a cost within the one of the MST clusters to reach a Common and Internal Spanning Tree (CIST) cluster root node in the one or more MST BPDUs.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00019" num="00019">
<div class="claim-text">19. The apparatus of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein one or more MST bridge protocol data units (BPDUs) comprise a number of hops within the one of the MST clusters for a Common and Internal Spanning Tree (CIST) regional root node.</div>
</div>
</div> <div class="claim"> <div class="claim" id="CLM-00020" num="00020">
<div class="claim-text">20. A non-transitory computer-readable storage medium comprising:
<div class="claim-text">computer-executable instructions stored thereon which, when executed by one or more processors, cause the one or more processors to:
<div class="claim-text">define a multiple spanning tree (MST) region in a network, the MST region comprising a plurality of network nodes interconnected by links;</div>
<div class="claim-text">define a plurality of non-overlapping MST clusters within the MST region, each of the MST clusters being a subset of at least two of the plurality of network nodes within the MST region, each of the MST clusters presenting itself as a single logical entity and permitting traffic on a plurality of inter-cluster links associated with a subset of the plurality of network nodes; and</div>
<div class="claim-text">enable load balancing of traffic across the plurality of inter-cluster links, each link of the plurality of inter-cluster links connecting a respective network node in one of the MST clusters to a respective network node of the MST region that is outside of the one o the MST clusters.</div>
</div>
</div>
</div>
</div> </div>
</div>
</section>
                </article>
            </search-app>
        </body>
    </html>
    