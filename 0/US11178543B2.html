
    <html>
        <body>
            <search-app>
                <article class="result" itemscope="" itemtype="http://schema.org/ScholarlyArticle">
    <h1 itemprop="pageTitle">US11178543B2 - Apparatus and method for mobility procedure involving mobility management entity relocation 
        - Google Patents</h1><section itemprop="abstract" itemscope="">
<h2>Abstract</h2>
<div html="" itemprop="content"><abstract lang="EN" load-source="patent-office" mxw-id="PA471446315">
<div class="abstract" id="p-0001" num="0000">A device that identifies entry into a new service area, transmits a service area update request to a network device associated with a network, receives a control plane message from the network indicating control plane device relocation or a key refresh due to a service area change in response to transmitting the service area update request, and derives a first key based in part on data included in the control plane message and a second key shared between the device and a key management device. Another device that receives a handover command from a network device associated with a network, the handover command indicating a new service area, derives a first key based on data included in the handover command and on a second key shared between the device and a key management device, and sends a handover confirmation message that is secured based on the first key.</div>
</abstract>
</div>
</section><section itemprop="description" itemscope="">
<h2>Description</h2>
<div html="" itemprop="content"><div class="description" lang="EN" load-source="patent-office" mxw-id="PDES310885826">
<heading id="h-0001">CLAIM OF PRIORITY</heading>
<div class="description-paragraph" id="p-0002" num="0001">The present application for patent is a divisional application of U.S. application Ser. No. 15/787,575 entitled “Apparatus and Method for Mobility Procedure Involving Mobility Management Entity Relocation” filed Oct. 18, 2017, now U.S. Pat. No. 10,462,656, issued on Oct. 29, 2019, which in turn was a divisional application of U.S. application Ser. No. 15/089,396 entitled “Apparatus and Method for Mobility Procedure Involving Mobility Management Entity Relocation” filed Apr. 1, 2016, now U.S. Pat. No. 9,883,385, issued on Jan. 30, 2018, which in turn claims priority to provisional application Ser. No. 62/218,863 entitled “Apparatus and Method for Mobility Procedure Involving Mobility Management Entity Relocation” filed Sep. 15, 2015, the entire disclosures of which are hereby expressly incorporated by reference.</div>
<heading id="h-0002">BACKGROUND</heading>
<heading id="h-0003">Field</heading>
<div class="description-paragraph" id="p-0003" num="0002">The present disclosure relates generally to apparatuses and methods for improved mobility procedures involving mobility management entity (MME) relocation.</div>
<heading id="h-0004">Background</heading>
<div class="description-paragraph" id="p-0004" num="0003">A current cellular network architecture, shown in <figref idrefs="DRAWINGS">FIG. 1</figref>, uses a mobility management entity (MME) <b>110</b> to implement procedures for controlling access to the cellular network by a user equipment (UE) <b>120</b>. Typically, the MME is owned and operated by a network service provider (system operator) as a core network element, and is located in a secure location controlled by the network service provider. The core network <b>100</b> has a control plane including a Home Subscriber Server (HSS) <b>130</b> and the MME, and a user plane including a Packet Data Network (PDN) Gateway (PGW) <b>140</b> and a Serving Gateway (SGW) <b>150</b>. The MME is connected to an evolved Node B (eNodeB) <b>160</b>. The eNodeB provides radio interfaces, RRC <b>180</b> and PDCP/RLC <b>190</b>, with the UE.</div>
<div class="description-paragraph" id="p-0005" num="0004">In future cellular network architectures it is envisioned that the MMEs <b>110</b> or network components that perform many of the functions of the MMEs <b>110</b> will be pushed out towards the network edge where they are less secure either because they are physically more accessible and/or are not isolated from other network operators. As network functions are moved to, for example, the cloud (e.g., internet), it may not be assumed that they are secure because they may have a lower level of physical isolation, or no physical isolation. Further, network equipment may not be owned by a single network service provider. As an example, multiple MME instances may be hosted with a single physical hardware device. As a result, the keys sent to the MMEs may need refreshing more frequently and hence it may not be advisable to forward the authentication vectors (AVs) to the MMEs.</div>
<div class="description-paragraph" id="p-0006" num="0005">There is a need for improved apparatuses and methods that provide additional security for the cellular network architectures of the future where MME functions are performed close to the network edge.</div>
<heading id="h-0005">SUMMARY</heading>
<div class="description-paragraph" id="p-0007" num="0006">One feature provides a device (e.g., user device) that comprises a wireless communication interface adapted to transmit and receive data wirelessly to and from a network, and a processing circuit communicatively coupled to the wireless communication interface. The processing circuit may be adapted to identify entry into a new service area, transmit a service area update request to a network device associated with the network, receive a control plane message from the network indicating control plane device relocation or a key refresh due to a service area change in response to transmitting the service area update request, and derive a first key based in part on data included in the control plane message received and a second key shared between the device and a key management device, the key management device associated with the network. According to one aspect, the control plane message is received from a target control plane device due to the service area change, the target control plane device being a different control plane device from one currently serving the device. According to another aspect, the data included in the control plane message includes a control plane device identifier that identifies a control plane device that is and/or will be serving the device.</div>
<div class="description-paragraph" id="p-0008" num="0007">According to one aspect, deriving the first key is further based in part on a counter value Key Count maintained at the key management device and included in the control plane message. According to another aspect, the processing circuit is further adapted to derive at least one of an evolved node B (eNB) key K<sub>eNB</sub>, a non-access stratum key K<sub>NAS</sub>, and/or a next hop (NH) key based on the first key to secure communications between the device and the network. According to yet another aspect, the new service area is at least one of a new tracking area and/or a new routing area, and the service area update request is associated with at least one of a tracking area update and/or a routing area update.</div>
<div class="description-paragraph" id="p-0009" num="0008">According to one aspect, the control plane message is a security mode command, the target control plane device is a target mobility management entity (MME), the key management device is a session key management function (SKMF) device, and the second key is a session root key for an authentication session. According to another aspect, a control plane device maintains a mobility management context and a session management context for the device, and the key management device maintains the second key.</div>
<div class="description-paragraph" id="p-0010" num="0009">Another feature provides a device comprising a wireless communication interface adapted to transmit and receive data wirelessly to a network, and a processing circuit communicatively coupled to the wireless communication interface. The processing circuit is adapted to receive a handover command from a network device associated with the network, the handover command indicating a new service area, derive a first key based on data included in the handover command and on a second key shared between the device and a key management device, the key management device associated with the network, and send a handover confirmation message that is secured based on the first key. According to one aspect, the handover command includes a target control plane device identifier associated with a target control plane device serving a target radio access node that is and/or will be serving the device. According to another aspect, deriving the first key is based in part on the target control plane device identifier.</div>
<div class="description-paragraph" id="p-0011" num="0010">According to one aspect, the target control plane device is a target mobility management entity (MME), the key management device is a session key management function (SKMF) device, and the target control plane device identifier is an MME identifier associated with the target MME. According to another aspect, deriving the first key is further based in part on a counter value Key Count maintained at the key management device. According to yet another aspect, the second key is a session root key for an authentication session.</div>
<div class="description-paragraph" id="p-0012" num="0011">Another feature provides a network device associated with a network, the network device comprising a communication interface adapted to transmit and receive information, and a processing circuit communicatively coupled to the communication interface. The processing circuit is adapted to receive a service area update request from a device for which the network device does not have a device context or the device has changed service areas, transmit a request for a first key to a key management device, receive the first key from the key management device, the first key based in part on a second key shared between the key management device and the device, and transmit a control plane message to the device that includes data allowing the device to derive the first key. According to one aspect, the network device is a mobility management entity (MME) and the first key is further based on an MME identifier that identifies the MME. According to another aspect, the processing circuit is further adapted to transmit a device context request to a prior control plane device that previously served the device if the network device does not have the device context, and receive the device context from the prior control plane device in response to transmitting the device context request.</div>
<div class="description-paragraph" id="p-0013" num="0012">According to one aspect, the data includes a control plane device identifier that identifies the network device. According to another aspect, the processing circuit is further adapted to receive a counter value Key Count from the key management device along with the first key, and include the counter value Key Count in the data transmitted to the device. According to yet another aspect, the processing circuit is further adapted to transmit a service area update to the device after receiving notification from the device that the control plane message was successfully received.</div>
<div class="description-paragraph" id="p-0014" num="0013">According to one aspect, the service area update request is associated with at least one of a tracking area update and/or a routing area update and changing service areas includes at least one of changing tracking areas and/or changing routing areas. According to another aspect, the control plane message is a non-access stratum security mode command, the key management device is a session key management function (SKMF) device, the device is a user equipment, the device context is a user equipment context associated with the user equipment, and the second key is a session root key for an authentication session.</div>
<div class="description-paragraph" id="p-0015" num="0014">Another feature provides a network device associated with a network, the network device comprising a communication interface adapted to transmit and receive information, and a processing circuit communicatively coupled to the communication interface. The processing circuit adapted to receive a forward relocation request at the network device from a source control plane device, transmit a request for a first key to a key management device, receive the first key from the key management device, the first key based in part on a second key shared between the key management device and a device, and transmit a handover request to a target radio access node (RAN) with a RAN session key derived from the first key. According to one aspect, the processing circuit is further adapted to receive a handover request acknowledgement message from the target RAN indicating the target RAN will serve the device. According to another aspect, the processing circuit is further adapted to transmit an acknowledgement message to the key management device indicating receipt of the first key only after receiving the handover request acknowledgement message from the target RAN.</div>
<div class="description-paragraph" id="p-0016" num="0015">According to one aspect, the processing circuit is further adapted to transmit a forward relocation response to the source control plane device that includes data utilized by the device to derive the first key. According to another aspect, the network device is a target control plane device that will serve the device and the data includes a target control plane device identifier that identifies the target control plane device. According to yet another aspect, the target control plane device is a target mobility management entity (MME), the source control plane device is a source MME, the target control plane device identifier is a globally unique MME identifier (GUMMEI), the key management device is a session key management function (SKMF) device, and the device is a user equipment.</div>
<div class="description-paragraph" id="p-0017" num="0016">According to one aspect, the data includes a counter value Key Count maintained at the key management device. According to another aspect, the processing circuit adapted to receive the first key from the key management device is further adapted to receive a counter value Key Count along with the first key.</div>
<div class="description-paragraph" id="p-0018" num="0017">Another feature provides a method operational at a device for performing tracking area updates involving mobility management entity (MME) relocation or a change of tracking area, the method comprising identifying entry into a new tracking area, transmitting a tracking area update (TAU) request to a network device associated with a wireless communication network, receiving a security mode command from the network device indicating MME relocation or a key refresh due to a change of tracking area in response to transmitting the TAU request, and deriving a first key K<sub>ASME </sub>based in part on data included in the security mode command received. According to one aspect, the security mode command is sent by an MME to refresh the first key K<sub>ASME</sub>. According to another aspect, the security mode command is sent by a target MME due to tracking area change.</div>
<div class="description-paragraph" id="p-0019" num="0018">According to one aspect, the data included in the security mode command includes an MME identifier. According to another aspect, the MME identifier is a globally unique MME identifier (GUMMEI). According to yet another aspect, deriving the first key K<sub>ASME </sub>is based in part on the GUMMEI.</div>
<div class="description-paragraph" id="p-0020" num="0019">According to one aspect, deriving the first key K<sub>ASME </sub>is further based in part on a second key K<sub>SKMF </sub>shared between the device and a session key management function (SKMF) device. According to another aspect, deriving the first key K<sub>ASME </sub>is further based in part on a counter value Key Count maintained at the SKMF device. According to yet another aspect, the data included in the security mode command further includes the counter value Key Count.</div>
<div class="description-paragraph" id="p-0021" num="0020">According to one aspect, the method further comprises receiving a tracking area update message from the network device. According to another aspect, the method further comprises decrypting the tracking area update message using one or more keys derived from the first key K<sub>ASME</sub>. According to yet another aspect, the tracking area update message includes a new globally unique temporary identifier (GUTI).</div>
<div class="description-paragraph" id="p-0022" num="0021">Another feature provides a device comprising a wireless communication interface adapted to transmit and receive data wirelessly with a network device associated with a wireless communication network, and a processing circuit communicatively coupled to the wireless communication interface, the processing circuit adapted to identify entry into a new tracking area, transmit a tracking area update (TAU) request to the network device associated with the wireless communication network, receive a security mode command from the network device indicating mobility management entity (MME) relocation or a key refresh due to a change of tracking area in response to transmitting the TAU request, and derive a first key K<sub>ASME </sub>based in part on data included in the security mode command received.</div>
<div class="description-paragraph" id="p-0023" num="0022">Another feature provides a device comprising means for identifying entry into a new tracking area, means for transmitting a tracking area update (TAU) request to a network device associated with a wireless communication network, means for receiving a security mode command from the network device indicating mobility management entity (MME) relocation or a key refresh due to a change of tracking area in response to transmitting the TAU request, and means for deriving a first key K<sub>ASME </sub>based in part on data included in the security mode command received.</div>
<div class="description-paragraph" id="p-0024" num="0023">Another feature provides a non-transitory computer-readable storage medium having instructions for performing tracking area updates involving mobility management entity (MME) relocation or a change of tracking area stored thereon, the instructions when executed by at least one processor causes the processor to identify entry into a new tracking area, transmit a tracking area update (TAU) request to a network device associated with a wireless communication network, receive a security mode command from the network device indicating MME relocation or a key refresh due to a change of tracking area in response to transmitting the TAU request, and derive a first key K<sub>ASME </sub>based in part on data included in the security mode command received.</div>
<div class="description-paragraph" id="p-0025" num="0024">Another feature provides a method operational at a device for performing handover involving mobility management entity (MME) relocation or a change of tracking area, the method comprising receiving a handover command from a network device indicating a new tracking area, deriving a first key K<sub>ASME </sub>based on data included in the handover command, and sending a handover confirmation message secured based on the first key K<sub>ASME</sub>. According to one aspect, the method further comprises verifying the handover command before deriving the first key K<sub>ASME</sub>. According to another aspect, the handover command includes a target MME identifier associated with a target MME serving the network device.</div>
<div class="description-paragraph" id="p-0026" num="0025">According to one aspect, deriving the first key K<sub>ASME </sub>is based in part on the target MME identifier. According to another aspect, the target MME identifier is a globally unique MME identifier (GUMMEI) associated with the target MME serving the network device. According to yet another aspect, deriving the first key K<sub>ASME </sub>is further based in part on a second key K<sub>SKMF </sub>shared between the device and a session key management function (SKMF) device serving the target MME.</div>
<div class="description-paragraph" id="p-0027" num="0026">According to one aspect, deriving the first key K<sub>ASME </sub>is further based in part on a counter value Key Count maintained at the SKMF device. According to another aspect, the data included in the handover command further includes the counter value Key Count.</div>
<div class="description-paragraph" id="p-0028" num="0027">Another feature provides a device comprising a wireless communication interface adapted to transmit and receive data wirelessly with a network device associated with a wireless communication network, and a processing circuit communicatively coupled to the wireless communication interface, the processing circuit adapted to receive a handover command from the network device indicating a new tracking area, derive a first key K<sub>ASME </sub>based on data included in the handover command, and send a handover confirmation message secured based on the first key K<sub>ASME</sub>.</div>
<div class="description-paragraph" id="p-0029" num="0028">Another feature provides a device comprising means for receiving a handover command from a network device indicating a new tracking area, means for deriving a first key K<sub>ASME </sub>based on data included in the handover command, and means for sending a handover confirmation message secured based on the first key K<sub>ASME</sub>.</div>
<div class="description-paragraph" id="p-0030" num="0029">Another feature provides a non-transitory computer-readable storage medium having instructions for performing handover involving mobility management entity (MME) relocation or a change of tracking area stored thereon, the instruction when executed by at least one processor causes the processor to receive a handover command from a network device indicating a new tracking area, derive a first key K<sub>ASME </sub>based on data included in the handover command, and send a handover confirmation message secured based on the first key K<sub>ASME</sub>.</div>
<div class="description-paragraph" id="p-0031" num="0030">Another feature provides a method for performing a tracking area update involving mobility management entity (MME) relocation or a change of tracking area at the MME, the method comprising receiving a tracking area update (TAU) request from a user equipment (UE) for which the MME does not have a UE context associated with the UE or for which the UE has changed tracking areas, transmitting a request for a first key K<sub>ASME </sub>to a session key management function (SKMF) device, receiving the first key K<sub>ASME </sub>from the SKMF device, and transmitting a non-access stratum (NAS) security mode command (SMC) to the UE that includes data allowing the UE to derive the first key K<sub>ASME</sub>. According to one aspect, the method further comprises transmitting a UE context request to a source MME that previously served the UE if the MME does not have the UE context. According to another aspect, the method further comprises receiving the UE context from the source MME in response to transmitting the UE context request. According to yet another aspect, the method further comprises transmitting a key acknowledgment to the SKMF device after receiving the first key K<sub>ASME</sub>.</div>
<div class="description-paragraph" id="p-0032" num="0031">According to one aspect, the data includes an MME identifier that identifies the MME. According to another aspect, the MME identifier is a globally unique MME identifier (GUMMEI). According to yet another aspect, the data includes a counter value Key Count maintained at the SKMF device.</div>
<div class="description-paragraph" id="p-0033" num="0032">According to one aspect, receiving the first key K<sub>ASME </sub>from the SKMF device further includes receiving a counter value Key Count from the SKMF device. According to another aspect, the method further comprises transmitting a tracking area update to the UE after receiving notification from the UE that NAS SMC is successfully completed. According to yet another aspect, the method further comprises transmitting an encrypted tracking area update to the UE concurrently with the NAS SMC. According to another aspect, transmitting the request for the first key K<sub>ASME </sub>includes transmitting a UE location update.</div>
<div class="description-paragraph" id="p-0034" num="0033">Another feature provides a network device associated with a wireless communication network, the network device comprising a communication interface adapted to transmit and receive information, and a processing circuit communicatively coupled to the communication interface, the processing circuit adapted to receive a tracking area update (TAU) request from a user equipment (UE) for which the network device does not have a UE context associated with the UE or for which the UE has changed tracking areas, transmit a request for a first key K<sub>ASME </sub>to a session key management function (SKMF) device, receive the first key K<sub>ASME </sub>from the SKMF device, and transmit a non-access stratum (NAS) security mode command (SMC) to the UE that includes data allowing the UE to derive the first key K<sub>ASME</sub>.</div>
<div class="description-paragraph" id="p-0035" num="0034">Another feature provides a network device associated with a wireless communication network, the network device comprising means for receiving a tracking area update (TAU) request from a user equipment (UE) for which the network device does not have a UE context associated with the UE or for which the UE has changed tracking areas, means for transmitting a request for a first key K<sub>ASME </sub>to a session key management function (SKMF) device, means for receiving the first key K<sub>ASME </sub>from the SKMF device, and means for transmitting a non-access stratum (NAS) security mode command (SMC) to the UE that includes data allowing the UE to derive the first key K<sub>ASME</sub>.</div>
<div class="description-paragraph" id="p-0036" num="0035">Another feature provides a non-transitory computer-readable storage medium having instructions for performing a tracking area update involving mobility management entity (MME) relocation or a change of tracking area at the MME stored thereon, the instructions when executed by at least one processor causes the processor to receive a tracking area update (TAU) request from a user equipment (UE) for which the MME does not have a UE context associated with the UE or for which the UE has changed tracking areas, transmit a request for a first key K<sub>ASME </sub>to a session key management function (SKMF) device, receive the first key K<sub>ASME </sub>from the SKMF device, and transmit a non-access stratum (NAS) security mode command (SMC) to the UE that includes data allowing the UE to derive the first key K<sub>ASME</sub>.</div>
<div class="description-paragraph" id="p-0037" num="0036">Another feature provides a method for performing handover involving mobility management entity (MME) relocation or a change of tracking area at the MME, the method comprising receiving a forward relocation request at a target MME from a source MME, transmitting a request for a first key K<sub>ASME </sub>to a session key management function (SKMF) device, receiving the first key K<sub>ASME </sub>from the SKMF device, and transmitting a handover request to a target radio access node (RAN) with a key K<sub>eNB </sub>derived from the first key K<sub>ASME</sub>. According to one aspect, the method further comprises receiving a handover request acknowledgement message from the target RAN indicating the target RAN will serve a user equipment (UE). According to another aspect, the method further comprises transmitting an acknowledgement message to the SKMF indicating receipt of the first key K<sub>ASME </sub>only after receiving the handover request acknowledgement message from the target RAN.</div>
<div class="description-paragraph" id="p-0038" num="0037">According to one aspect, the method further comprises transmitting a forward relocation response to the source MME that includes data utilized by a UE to derive the first key K<sub>ASME</sub>. According to another aspect, the data includes an MME identifier that identifies the target MME. According to yet another aspect, the MME identifier is a globally unique MME identifier (GUMMEI).</div>
<div class="description-paragraph" id="p-0039" num="0038">According to one aspect, the data includes a counter value Key Count maintained at the SKMF device. According to another aspect, receiving the first key K<sub>ASME </sub>from the SKMF device further includes receiving a counter value Key Count from the SKMF device.</div>
<div class="description-paragraph" id="p-0040" num="0039">Another feature provides a network device comprising a communication interface adapted to transmit and receive information, and a processing circuit communicatively coupled to the communication interface, the processing circuit adapted to receive a forward relocation request at the network device from a source mobility management entity (MME), transmit a request for a first key K<sub>ASME </sub>to a session key management function (SKMF) device, receive the first key K<sub>ASME </sub>from the SKMF device, and transmit a handover request to a target radio access node (RAN) with a key K<sub>eNB </sub>derived from the first key K<sub>ASME</sub>.</div>
<div class="description-paragraph" id="p-0041" num="0040">Another feature provides a network device associated with a wireless communication network, the network device comprising means for receiving a forward relocation request at the network device from a source mobility management entity (MME), means for transmitting a requesting for a first key K<sub>ASME </sub>to a session key management function (SKMF) device, means for receiving the first key K<sub>ASME </sub>from the SKMF device, and means for transmitting a handover request to a target radio access node (RAN) with a key K<sub>eNB </sub>derived from the first key K<sub>ASME</sub>.</div>
<div class="description-paragraph" id="p-0042" num="0041">Another feature provides a non-transitory computer-readable storage medium having instructions for performing handover involving mobility management entity (MME) relocation or a change of tracking area at the MME stored thereon, the instructions when executed by at least one processor causes the processor to receive a forward relocation request at the network device from a source MME, transmit a requesting for a first key K<sub>ASME </sub>to a session key management function (SKMF) device, receive the first key K-ASME from the SKMF device, and transmit a handover request to a target radio access node (RAN) with a key K<sub>eNB </sub>derived from the first key K<sub>ASME</sub>.</div>
<description-of-drawings>
<heading id="h-0006">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<div class="description-paragraph" id="p-0043" num="0042"> <figref idrefs="DRAWINGS">FIG. 1</figref> is a block diagram of an example of a wireless communication system found in the prior art.</div>
<div class="description-paragraph" id="p-0044" num="0043"> <figref idrefs="DRAWINGS">FIG. 2</figref> is flow chart of a method for deriving digital keys for a cellular network security.</div>
<div class="description-paragraph" id="p-0045" num="0044"> <figref idrefs="DRAWINGS">FIG. 3</figref> is a block diagram of a first embodiment of a wireless communication system having an improved network key hierarchy.</div>
<div class="description-paragraph" id="p-0046" num="0045"> <figref idrefs="DRAWINGS">FIG. 4</figref> is a block diagram of a second embodiment of a wireless communication system having an improved network key hierarchy.</div>
<div class="description-paragraph" id="p-0047" num="0046"> <figref idrefs="DRAWINGS">FIG. 5</figref> is a block diagram of a third embodiment of a wireless communication system having an improved network key hierarchy.</div>
<div class="description-paragraph" id="p-0048" num="0047"> <figref idrefs="DRAWINGS">FIG. 6</figref> is a schematic diagram of an improved key hierarchy for a cellular network.</div>
<div class="description-paragraph" id="p-0049" num="0048"> <figref idrefs="DRAWINGS">FIG. 7</figref> illustrates a flow diagram of an attach procedure and initial data transfer for a UE connecting to a wireless communication network (e.g., wireless cellular network).</div>
<div class="description-paragraph" id="p-0050" num="0049"> <figref idrefs="DRAWINGS">FIG. 8</figref> illustrates a flow diagram of an S1-handover procedure.</div>
<div class="description-paragraph" id="p-0051" num="0050"> <figref idrefs="DRAWINGS">FIG. 9</figref> illustrates a flow diagram of a tracking area update procedure after a UE moves to a new location requiring an MME relocation.</div>
<div class="description-paragraph" id="p-0052" num="0051"> <figref idrefs="DRAWINGS">FIG. 10</figref> illustrates a first exemplary schematic block diagram of a device such as a user device/equipment.</div>
<div class="description-paragraph" id="p-0053" num="0052"> <figref idrefs="DRAWINGS">FIG. 11</figref> illustrates a first exemplary method operational at a device for performing service area updates involving control plane device relocation or a change of service area.</div>
<div class="description-paragraph" id="p-0054" num="0053"> <figref idrefs="DRAWINGS">FIG. 12</figref> illustrates a second exemplary method operational at a device for performing handover involving control plane device relocation or a change of service area.</div>
<div class="description-paragraph" id="p-0055" num="0054"> <figref idrefs="DRAWINGS">FIG. 13</figref> illustrates a first exemplary schematic block diagram of a network device such as an MME.</div>
<div class="description-paragraph" id="p-0056" num="0055"> <figref idrefs="DRAWINGS">FIG. 14</figref> illustrates a first exemplary method operational at a network device for performing a service area update involving control plane device relocation or a change of service area at the control plane device.</div>
<div class="description-paragraph" id="p-0057" num="0056"> <figref idrefs="DRAWINGS">FIG. 15</figref> illustrates a second exemplary method operational at a network device for performing handover involving control plane device relocation or a change of service area at the control plane device.</div>
<div class="description-paragraph" id="p-0058" num="0057"> <figref idrefs="DRAWINGS">FIG. 16</figref> illustrates a second exemplary schematic block diagram of a device such as a user device/equipment.</div>
<div class="description-paragraph" id="p-0059" num="0058"> <figref idrefs="DRAWINGS">FIG. 17</figref> illustrates a third exemplary schematic block diagram of a device such as a user device/equipment.</div>
<div class="description-paragraph" id="p-0060" num="0059"> <figref idrefs="DRAWINGS">FIG. 18</figref> illustrates a second exemplary schematic block diagram of a network device such as an MME.</div>
<div class="description-paragraph" id="p-0061" num="0060"> <figref idrefs="DRAWINGS">FIG. 19</figref> illustrates a third exemplary schematic block diagram of a network device such as an MME.</div>
</description-of-drawings>
<heading id="h-0007">DETAILED DESCRIPTION</heading>
<div class="description-paragraph" id="p-0062" num="0061">The word “exemplary” is used herein to mean “serving as an example, instance, or illustration.” Any embodiment described herein as “exemplary” is not necessarily to be construed as preferred or advantageous over other embodiments.</div>
<div class="description-paragraph" id="p-0063" num="0062">With reference to <figref idrefs="DRAWINGS">FIGS. 2 and 3</figref>, an aspect of the present disclosure may reside in a method <b>200</b> for deriving digital keys for cellular network security. In the method, a user equipment (UE) <b>320</b> mutually authenticates with a session key management function device (“SKMF”) <b>300</b> (e.g., security anchor function (SEAF)). The user equipment derives a first session key (e.g, K<sub>SKMF</sub>) shared with the SKMF <b>300</b> using a secret key (SK) shared with a home subscriber server (HSS) <b>330</b>. The user equipment then derives a second session key (e.g, K<sub>ASME</sub>) shared with a mobility management entity (MME) <b>310</b> (e.g., access and mobility management function (AMF)) using the first session key.</div>
<div class="description-paragraph" id="p-0064" num="0063">In more detailed aspects of the disclosure, the SKMF (authenticator) may be a trust anchor (or key anchor) located deep inside the telecommunications network that derives a key (e.g., K<sub>ASME</sub>) for each MME. Thus, as MMEs and/or network devices that perform their functions are pushed to the network's edge, the SKMF stays deep inside the network and is very secure. The first session key may be derived using a first key derivation function having the secret key and a serving network identity (SN_id) as inputs. The first key derivation function may be based on, e.g., HMAC-256. The mutual authentication may be performed using an extensible authentication protocol (EAP), or specific NAS signaling. The second session key may be derived during an authentication and key agreement (AKA) procedure (for the currently attached MME with the UE), or during a handover involving an MME relocation. The session may be defined for the currently attached MME by the AAA server. The MME relocation may be performed within a group of MMEs sharing an MME group identity (MMEGI). Alternatively, the MME relocation may be performed with another MME having a different MMEGI.</div>
<div class="description-paragraph" id="p-0065" num="0064">In other more detailed aspects of the disclosure, the second session key may be derived using a second key derivation function having the first session key and a unique globally unique MME identifier (GUMMEI) as inputs. The GUMMEI may be based on a combination of an MMEGI and an MME code. The second key derivation function may be based on HMAC-256. Alternatively, the second session key may be derived using a second key derivation function having the first session key and an MMEGI as inputs.</div>
<div class="description-paragraph" id="p-0066" num="0065">Another aspect of the disclosure may reside in a method for deriving a key for a user equipment <b>320</b>. In the method, a network entity receives a session key (e.g, K<sub>ASME</sub>), for the user equipment, from the SKMF <b>300</b>. A communication channel for receiving the session key may be security protected. The network entity may be an eNB <b>360</b>, MME, GW, etc. Alternatively, an aspect of the disclosure may reside in a method wherein the network entity may receive the session key, for the user equipment, from another network entity in a same group. In a more detailed aspect of the disclosure, a network entity may request a session key (e.g, K<sub>ASME</sub>) from the SKMF when a source MME requests a handover without transferring a session key.</div>
<div class="description-paragraph" id="p-0067" num="0066">Another aspect of the disclosure, the SKMF <b>300</b> may mutually authenticate with a user equipment <b>320</b>. The SKMF <b>300</b> may derive a session key (e.g, K<sub>ASME</sub>) for use in communicating with a UE <b>320</b> connected to an MME <b>310</b>. The SKMF <b>300</b> may send the session key, for the UE <b>320</b>, to the MME <b>10</b>. Mutually authenticating with the UE <b>320</b> may include the SKMF <b>300</b> forwarding a request to an HSS <b>330</b> for authentication information for the UE <b>320</b>. The authentication information may include authentication vectors (AVs) for the UE <b>320</b>. Mutually authenticating with the UE <b>320</b> may further include the SKMF <b>300</b> receiving an authentication response from the UE <b>320</b>. An authentication vector may include an expected response (XRES), an authentication value (AUTN), a random number (RAND), and the first session key (e.g., K<sub>SKMF</sub>). The AUTN may be based on a sequence number and a secret key (SK) which the UE <b>320</b> shares with the HSS <b>330</b>.</div>
<div class="description-paragraph" id="p-0068" num="0067">The present disclosure allows network functions (e.g., the MME <b>310</b>) to be moved to an edge of the network away from a network core. The SKMF <b>300</b> may be placed between the MME <b>310</b> and the HSS <b>330</b>. The SKMF <b>300</b> may act a local key anchor. Accordingly, the trust required by the MME <b>310</b> may be reduced. As a result, an MME <b>310</b> for a UE <b>320</b> would not be transferred during MME relocation.</div>
<div class="description-paragraph" id="p-0069" num="0068">The UE may perform Authentication Key Agreement (AKA) with the SKMF. The HHS may send an AV to the SKMF. The AV may include XRES, AUTN, RAND, and K<sub>SKMF</sub>. K<sub>SKMF </sub>may be derived from a shared secret key SK between the UE and the HSS. Thus, mutual authentication may be performed between the UE and the SKMF. This architecture may be used in a fifth generation (5G) cellular network.</div>
<div class="description-paragraph" id="p-0070" num="0069">If the AKA is successful, the SKMF sends an MME key (e.g., K<sub>ASME</sub>) to the MME. The MME key (and other keys derived from it) may be derived according to the details provided further below.</div>
<div class="description-paragraph" id="p-0071" num="0070">In a roaming scenario (i.e., the UE is in a visited network), the SKMF in the visited network may become the local key anchor. Similarly, the AKA may be performed through the SKMF. As shown in <figref idrefs="DRAWINGS">FIGS. 4 and 5</figref>, an SKMF <b>300</b>, which is in the visited network, and not in the home network <b>406</b>, is the local key anchor. During an MME relocation (e.g., handover or tracking area update) within the local network, the SKMF derives a new K<sub>ASME </sub>and provides it to the target/new MME. The radio access node (RAN) session key (e.g., K<sub>eNB</sub>) may be derived from the new K<sub>ASME</sub>.</div>
<div class="description-paragraph" id="p-0072" num="0071"> <figref idrefs="DRAWINGS">FIG. 6</figref> illustrates a schematic diagram of an improved key hierarchy for a cellular network. The UE's universal subscriber identity module (USIM) and the network's authentication center (AuC) store the shared secret key (SK). From the SK the integrity key (IK) and cipher key (CK) are derived and provided to the HSS. The HSS may in turn generate the first session key (K<sub>SKMF</sub>) and provide it to the SKMF. The first session key K<sub>SKMF </sub>is valid during the entire authentication session. The SKMF may utilize the K<sub>SKMF </sub>to generate the second session key (K<sub>ASME</sub>) and provide that key to the MME. The K<sub>ASME </sub>may be valid for only a specific MME. The MME may in turn generate other keys (K<sub>NASenc</sub>, K<sub>NASint</sub>, K<sub>eNB</sub>/NH, etc.) based on the K<sub>ASME</sub>.</div>
<div class="description-paragraph" id="p-0073" num="0072">Exemplary Attach, Handover, and Tracking Area Update (TAU) Processes</div>
<div class="description-paragraph" id="p-0074" num="0073">Aspects of the disclosure are descried in some parts below with respect to 4G Long Term Evolution system components. This is merely exemplary. The disclosure is not limited by any one specific network system such as 4G LTE and instead may be applied to other types of communication systems including but not limited to 5G systems.</div>
<div class="description-paragraph" id="p-0075" num="0074">During an initial attach to a network, a UE performs an authentication and key agreement (AKA) procedure with a session key management function (SKMF) device. Once authentication is successful, SKMF derives a key (e.g., K<sub>ASME</sub>) for the MME to which the UE is attached and provides the key to the MME.</div>
<div class="description-paragraph" id="p-0076" num="0075">When a tracking area update (TAU) involving MME relocation is requested by a UE, the new MME (e.g., target MME) that receives the TAU request receives a new key K<sub>ASME </sub>from the SKMF and establishes a security association with the UE by performing a non-access stratum (NAS) security mode command (SMC) procedure. Similarly, when a handover involving MME relocation happens, the target MME also gets a new key K<sub>ASME </sub>from the SKMF and establishes a security association with the UE.</div>
<div class="description-paragraph" id="p-0077" num="0076">An MME that supports two tracking areas may initiate a change of K<sub>ASME </sub>when the UE moves between tracking areas. This hides the network configuration from UE. For example, the UEs only see tracking areas not MMEs. This may happen both in response to a TAU and a handover that changes tracking areas.</div>
<div class="description-paragraph" id="p-0078" num="0077"> <figref idrefs="DRAWINGS">FIG. 7</figref> illustrates a flow diagram of an attach procedure and initial data transfer for a UE connecting to a wireless communication network (e.g., wireless cellular network) according to one aspect of the disclosure. First, the UE transmits an attach request <b>702</b> to an eNB, which in turn transmits an initial UE message <b>704</b> to the MME. Next, the UE and the SKMF perform an authentication and key agreement (AKA) <b>706</b>. To perform the AKA, the SKMF transmits an authentication information request <b>707</b> to the HSS and in response it receives an authentication vector <b>708</b> from the HSS that may include an expected response (XRES), an authentication value (AUTN), a random number (RAND), and an MME specific key K<sub>SKMF</sub>. The AUTN may be based on a sequence number and a secret key (SK) which the UE shares with the HSS.</div>
<div class="description-paragraph" id="p-0079" num="0078">Once AKA is successful, the SKMF may derive a session key K<sub>ASME </sub>(e.g., “first key”) based on K<sub>SKMF </sub>(e.g., “second key”), an MME identifier (e.g., GUMMEI), and/or a counter value (e.g., Key Count). Thus, K<sub>ASME </sub>may equal KDF(K<sub>SKMF</sub>, GUMMEI|Key Count) where KDF is a key derivation function. The counter value Key Count is a counter value that may be incremented by the SKMF to enable the SKMF to derive a fresh K<sub>ASME </sub>key for the same MME whenever handover back to the MME occurs. According to one aspect, a number used once (nonce) may be used instead of the counter value. According to another aspect, the GUMMEI may be omitted if it's not used to authorize a particular MME identity. For example, if SKMF is always in the same network as the MMEs it provides K<sub>ASME </sub>for, then including GUMMEI in the key derivation may be unnecessary. Thus, according to another example, K<sub>ASME </sub>may equal KDF(K<sub>SKMF</sub>, nonce). The MME specific key K<sub>ASME </sub>is then sent to the MME <b>710</b>. The MME may then use the key K<sub>ASME </sub>to perform a non-access stratum (NAS) security mode command (SMC) procedure <b>712</b> with the UE. During the NAS SMC procedure <b>712</b>, the MME may provide its GUMMEI and/or the Key Count to the UE so the UE can also derive K<sub>ASME</sub>. The remaining <b>714</b>-<b>728</b> shown in <figref idrefs="DRAWINGS">FIG. 7</figref> are similar to those found in 4G LTE cellular communication protocols.</div>
<div class="description-paragraph" id="p-0080" num="0079"> <figref idrefs="DRAWINGS">FIG. 8</figref> illustrates a flow diagram of an S1-handover procedure according to one aspect of the disclosure. First, the source eNB (i.e., the current eNB) transmits a handover (HO) required message <b>802</b> to the source MME (i.e., the current MME). Next, the source MME transmits/forwards a relocation request <b>804</b> to the target MME (i.e., the new MME). The target MME may create and transmit a session request <b>806</b> to a target serving gateway (S-GW) and receive a session response <b>808</b> from the target S-GW. The target MME may also transmit a key request <b>810</b> for an MME specific key K<sub>ASME </sub>to the SKMF. In so doing, the target MME may provide the SKMF with its GUMMEI. The SKMF may in turn generate the K<sub>ASME </sub>using the MME's GUMMEI, the K<sub>SKMF </sub>key it previously received from the HSS (described above), and the Key Count. According to one aspect, a number used once (nonce) may be used instead of the Key Count. According to another aspect, the GUMMEI may be omitted if it is not desired to authorize a particular MME identity. The SKMF transmits the K<sub>ASME </sub> <b>812</b> to the target MME. According to one aspect, the target MME may transmit the session request <b>806</b> to the target S-GW and transmit the key request <b>810</b> at about the same time. Thus, steps <b>806</b> and <b>810</b> may be carried out concurrently with steps <b>808</b> and <b>812</b>.</div>
<div class="description-paragraph" id="p-0081" num="0080">The target MME may then transmit a handover request <b>814</b> to the target eNB (i.e., the potential new eNB) and in response the target eNB sends back a handover response <b>816</b>. The handover request <b>814</b> may include the key K<sub>eNB </sub>derived by the target MME using K<sub>ASME</sub>. The handover response <b>816</b> indicates whether the target eNB agrees to accept the handover. If the target eNB does agree to accept the handover then the target MME sends a key (i.e., K<sub>ASME</sub>) acknowledgement message <b>818</b> to the SKMF. Upon receiving the key acknowledgement message, the SKMF may then increment the Key Count counter value. The step of sending the key acknowledgement message <b>818</b> is delayed until the handover request acknowledgement <b>816</b> is received because the handover request may be rejected by the target eNB. In such case, a new K<sub>ASME </sub>doesn't need to be derived by the UE, and SKMF may not need to increase the Key Count. After the target MME sends the source MME the relocation response <b>820</b>, the source MME sends a handover command <b>822</b> to the source eNB which is forwarded <b>824</b> to the UE. The handover command <b>822</b>, <b>824</b> may include the GUMMEI of the target MME and the Key Count so that the UE can derive the new K<sub>ASME </sub>and the new K<sub>eNB </sub>for the target eNB. The UE responds with a handover confirmation message <b>826</b> to the target eNB. The handover confirmation message <b>826</b> is integrity protected and ciphered.</div>
<div class="description-paragraph" id="p-0082" num="0081"> <figref idrefs="DRAWINGS">FIG. 9</figref> illustrates a flow diagram of a tracking area update procedure after a UE moves to a new location requiring an MME relocation according to one aspect of the disclosure. First, the UE generates and transmits a tracking area update request <b>902</b> to the eNB. The eNB in turn forwards the tracking area update request <b>904</b> to a target MME that will be associated with the UE. The eNB determines which new/target MME to send the tracking area update request to based on various criteria including the location of the UE. The tracking area update request may include a globally unique temporary identifier (GUTI) which in turn includes the GUMMEI of the source MME (i.e., MME currently associated with the UE). The target MME may then use the GUMMEI in the tracking area update request it receives to transmit a UE context request message <b>906</b> to the source MME. The source MME then responds with the UE context information in a UE context response message <b>908</b>. An acknowledgment <b>910</b> may be sent from the target MME to the source MME once this response is received.</div>
<div class="description-paragraph" id="p-0083" num="0082">The target MME may then send a location update and a key request (i.e., K<sub>ASME </sub>key request) to the SKMF <b>912</b>. The location update is forwarded to the HSS which then sends a location cancelation message <b>914</b> to the old MME (old MME may transmit a location cancelation acknowledgement message <b>916</b> back to the HSS). The SKMF <b>912</b> may generate a new K<sub>ASME </sub>for the target MME based on the GUMMEI of the target MME and/or the Key Count counter value as previously described. According to one aspect, a number used once (nonce) may be used instead of the Key Count. According to another aspect, the GUMMEI may be omitted if it is not desired to authorize a particular MME identity. The new K<sub>ASME </sub> <b>918</b> is transmitted to the target MME along with a location update acknowledgment. Upon receiving K<sub>ASME </sub>from the SKMF, the target MME may reply with a key acknowledgement message <b>920</b> to the SKMF. According to one aspect, the target MME may transmit the UE context request message <b>906</b> to the source MME at about the same time it transmits the location update and key request <b>912</b> to the SKMF. Thus, steps <b>906</b>, <b>908</b>, and <b>910</b> may be performed concurrently with steps <b>914</b>, <b>916</b>, <b>918</b>, <b>920</b>.</div>
<div class="description-paragraph" id="p-0084" num="0083">Once the target MME has received the K<sub>ASME </sub>from the SKMF, the target MME may then perform a non-access stratum security mode command procedure <b>922</b>, <b>924</b> with the UE. During the security mode command procedure the UE derives the key K<sub>ASME </sub>used by the target MME since the target MME provides the UE with its GUMMEI. Once the UE also has the same K<sub>ASME </sub>as the target MME, the UE and the target MME may engage in secure communications based on the K<sub>ASME </sub>key. For example, the target MME may engage in a tracking area update exchange <b>926</b>, <b>928</b> with the UE whose communications are encrypted by K<sub>ASME </sub>or other keys (e.g., NAS encryption and integrity protection keys) derived from K<sub>ASME</sub>. This exchange may include a message sent from the target MME to the UE that includes the new GUTI based on the target MME's GUMMEI. Such a message is again encrypted by K<sub>ASME </sub>or another key derived from K<sub>ASME</sub>.</div>
<div class="description-paragraph" id="p-0085" num="0084">As shown in <figref idrefs="DRAWINGS">FIG. 9</figref> and described above, the NAS SMC <b>922</b>, <b>924</b> is followed by the tracking area update process <b>926</b>, <b>928</b>. In some aspects of the disclosure, the NAS SMC <b>922</b>, <b>924</b> and the tracking area update process <b>926</b>, <b>928</b> may be combined. For example, the NAS SMC message <b>922</b> sent from the target MME to the UE may be combined with the tracking area update message <b>926</b>. In so doing, only part of the combined message (e.g., the part associated with the tracking area update) may be encrypted, while the portion of the message that helps the UE derive K<sub>ASME </sub>is left unencrypted. A new temporary mobile subscriber identity (TMSI), which is part of GUTI, allocated by the MME may be encrypted.</div>
<div class="description-paragraph" id="p-0086" num="0085">Key Derivation</div>
<div class="description-paragraph" id="p-0087" num="0086">As discussed above, AKA is run between the UE and the SKMF. The key K<sub>SKMF </sub>is derived by the HSS and sent to the SKMF. From the HSS' perspective, authentication vectors are constructed in the same manner as 4G LTE and sent to the SKMF instead of the MME. Thus, HSS may be connected to SKMF without any modification.</div>
<div class="description-paragraph" id="p-0088" num="0087">SKMF derives an MME specific key K<sub>ASME </sub>for a given MME and thus the MME's GUMMEI may be used in the K<sub>ASME </sub>key derivation process. A NAS Count value may be initialized to zero (0) for a new K<sub>ASME</sub>. In one example, the old NAS Count values are not discarded if tracking area update(s) doesn't complete. For the freshness of the key K<sub>ASME </sub>the UE and the SKMF may maintain a Key Count counter value and use it for K<sub>ASME </sub>derivation. This may be done to avoid deriving the same K<sub>ASME </sub>in cases where the UE moves back to an old MME (e.g., source MME). The Key Count counter value may be initialized to zero (0) or some other pre-determined value when the initial AKA is performed successfully. In some aspect, a nonce may be used instead of the Key Count counter value. In another aspect, the GUMMEI may be omitted from the key derivation.</div>
<div class="description-paragraph" id="p-0089" num="0088">The key derivation function (KDF) used to generate the keys K<sub>SKMF</sub>, K<sub>ASME</sub>, K<sub>eNB</sub>, next hop (NH), etc. may utilize HMAC-SHA-256, HMAC-SHA-3, etc. The input string S may be constructed from n+1 input parameters. For example, S=[FC∥P<sub>0</sub>∥L<sub>0</sub>∥P<sub>1</sub>∥L<sub>1</sub>∥P<sub>2</sub>∥L<sub>2</sub>∥ . . . ∥P<sub>N</sub>∥L<sub>N</sub>]. The field code FC may be a single octet used to distinguish between different instances of the algorithm and may use a value in the range 0x50-0x5F. The input parameters P<sub>0 </sub>through P<sub>N </sub>are the n+1 input parameter encodings. P<sub>0 </sub>may be a static ASCII-encoded string. The values L<sub>0 </sub>through L<sub>N </sub>are two octet representations of the length of the corresponding input parameters P<sub>0 </sub>through P<sub>N</sub>.</div>
<div class="description-paragraph" id="p-0090" num="0089">K<sub>SKMF </sub>Derivation.</div>
<div class="description-paragraph" id="p-0091" num="0090">K<sub>SKMF</sub>=KDF(K<sub>CK/JK</sub>, S). The input S may be equal to [FC∥P<sub>0</sub>∥L<sub>0</sub>∥P<sub>1</sub>∥L<sub>1</sub>] where FC=0x50, P<sub>0</sub>=SN id, L<sub>0</sub>=length of SN id (i.e., L<sub>0</sub>=0x00 0x03), P<sub>1</sub>=SQN XOR AK, and L<sub>1</sub>=length of P<sub>1 </sub>(i.e., L<sub>1</sub>=0x00 0x06). SQN is the sequence number and AK is anonymity key, and XOR is the exclusive OR operation. The value SQN XOR AK is sent to the UE as part of the authentication token (AUTN). If AK is not used then AK may be treated in accordance with TS 33.102 (i.e., 000 . . . 0). The input key K<sub>CK/IK </sub>is the concatenation of the cipher key (CK) and the integrity key (IK), i.e., K<sub>CK/IK</sub>=CK∥IK.</div>
<div class="description-paragraph" id="p-0092" num="0091">K<sub>ASME </sub>Derivation.</div>
<div class="description-paragraph" id="p-0093" num="0092">K<sub>ASME</sub>=KDF(K<sub>SKMF</sub>, S). The input S may be equal to [FC∥P<sub>0</sub>∥L<sub>0</sub>∥P<sub>1</sub>∥L<sub>1</sub>] where FC=0x51, P<sub>0</sub>=GUMMEI, L<sub>0</sub>=length of 48 bit GUMMEI (i.e., L<sub>0</sub>=0x00 0x06), P<sub>1</sub>=Key Count, and L<sub>1 </sub>may equal the length of P<sub>1 </sub>(e.g., L<sub>1</sub>=0x00 0x08). This is merely one example of how K<sub>ASME </sub>may be derived. In another aspects, the GUMMEI may be omitted and rand number used once (e.g., nonce) may be used instead of the Key Count counter value.</div>
<div class="description-paragraph" id="p-0094" num="0093">NH Derivation.</div>
<div class="description-paragraph" id="p-0095" num="0094">NH=KDF(K<sub>ASME</sub>, S). The input S may be equal to [FC∥P<sub>0</sub>∥L<sub>0</sub>] where FC=0x52, P<sub>0</sub>=Sync-Input, L<sub>0</sub>=length of Sync-Input (i.e., L<sub>0</sub>=0x00 0x20). The Sync-Input parameter may be newly derived K<sub>eNB </sub>for the initial NH derivation, and the previous NH for all subsequent derivations. This results in an NH chain, where the next NH is always fresh and derived from the previous NH.</div>
<div class="description-paragraph" id="p-0096" num="0095">K<sub>eNB </sub>Derivation.</div>
<div class="description-paragraph" id="p-0097" num="0096">K′<sub>eNB</sub>=KDF(K<sub>x</sub>, S). When deriving K′<sub>eNB </sub>from the current K<sub>eNB </sub>or from a fresh NH and the target physical cell identifier in the UE and the eNB as specified in clause 7.2.8 for handover purposes, the input S may be equal to [FC∥P<sub>0</sub>∥L<sub>0</sub>∥P<sub>1</sub>∥L<sub>1</sub>] where FC=0x53, P<sub>0</sub>=target physical cell identifier (PCI), L<sub>0</sub>=length of PCI (e.g., L<sub>0</sub>=0x00 0x02), P<sub>1</sub>=EARFCN-DL (target physical cell downlink frequency), and L<sub>1</sub>=length of P<sub>1 </sub>(e.g., L<sub>1</sub>=0x00 0x02). The input key K<sub>x </sub>may be the 256 bit next hop (NH) key when the index in the handover increases otherwise the current 256 bit K<sub>eNB </sub>is used.</div>
<div class="description-paragraph" id="p-0098" num="0097"> <figref idrefs="DRAWINGS">FIGS. 7-9</figref> shown and described above assume that the MMEs change from source to target MME. However, the same process flow diagrams may be used when a single MME assumes the role of two MMEs (source MME and target MME) and there is no actual interface between the two MMEs.</div>
<div class="description-paragraph" id="p-0099" num="0098">In the above description with regards to <figref idrefs="DRAWINGS">FIGS. 7-9</figref> and key derivation, specific non-exclusive, non-limiting examples of network components and related terminology was used to demonstrate aspects of the disclosure of the present application. For example, the “user equipment” may be just one example of a device. The MMEs may be just one example of control plane devices. The SMKF may be just one example of a key management device. The MME identifier (e.g., GUMMEI) may be just one example of a control plane device identifier. The tracking area may be just one example of a service area, and similarly, the tracking area update may be just one example a service area update. The SMC and NAS SMC may be just some examples of control plane messages. The eNB may be just one example of a radio access node.</div>
<div class="description-paragraph" id="p-0100" num="0099"> <figref idrefs="DRAWINGS">FIG. 10</figref> illustrates a schematic block diagram of a device <b>1000</b> (e.g., “user device”, “user equipment”, “wireless device”, etc.) according to one aspect of the disclosure. The user device <b>1000</b> may be any wireless communication device such as, but not limited to, a mobile phone, a smartphone, a laptop, a personal digital assistant (PDA), a tablet, a computer, a smartwatch, and a head-mounted wearable computer (e.g., Google Glass®). The user device <b>1000</b> may include at least one or more wireless communication interfaces <b>1002</b>, one or more memory circuits <b>1004</b>, one or more input and/or output (I/O) devices/circuits <b>1006</b>, and/or one or more processing circuits <b>1008</b> that may be communicatively coupled to one another. For example, the interface <b>1002</b>, the memory circuit <b>1004</b>, the I/O devices <b>1006</b>, and the processing circuit <b>1008</b> may be communicatively coupled to each other through a bus <b>1010</b>. The wireless communication interface <b>1002</b> allows the user device <b>1000</b> to communicate wirelessly with the wireless communication network <b>104</b>. Thus, the interface <b>1002</b> allows the user device <b>1000</b> to communicate wirelessly with wireless wide area networks (WWAN), such as mobile telecommunication cellular networks, as well as short range, wireless local area networks (e.g., WiFi®, Zigbee®, Bluetooth®, etc.).</div>
<div class="description-paragraph" id="p-0101" num="0100">The memory circuit <b>1004</b> may include one or more volatile memory circuits and/or non-volatile memory circuits. Thus, the memory circuit <b>1004</b> may include dynamic random access memory (DRAM), static random access memory (SRAM), magnetoresistive random access memory (MRAM), electrically erasable programmable read-only memory (EEPROM), flash memory, etc. The memory circuit <b>1004</b> may store one or more cryptographic keys. The memory circuit <b>1004</b> may also store instructions that may be executed by the processing circuit <b>1008</b>. The I/O devices/circuits <b>1006</b> may include one or more keyboards, mice, displays, touchscreen displays, printers, fingerprint scanners, and any other input and/or output devices.</div>
<div class="description-paragraph" id="p-0102" num="0101">The processing circuit <b>1008</b> (e.g., processor, central processing unit (CPU), application processing unit (APU), etc.) may execute instructions stored at the memory circuit <b>1006</b> and/or instructions stored at another computer-readable storage medium (e.g., hard disk drive, optical disk drive, solid-state drive, etc.) communicatively coupled to the user device <b>1000</b>. The processing circuit <b>1008</b> may perform any one of the steps and/or processes of the user device <b>1000</b> described herein including those discussed with reference to <figref idrefs="DRAWINGS">FIGS. 2, 3, 4, 5, 6, 7, 8, 9, 11, and 12</figref>.</div>
<div class="description-paragraph" id="p-0103" num="0102"> <figref idrefs="DRAWINGS">FIG. 11</figref> illustrates a method <b>1100</b> operational at a device. The device may be an integrated circuit, a plurality of integrated circuits, or an electronic device that incorporates one or more integrated circuits. The method may be for performing service area updates involving control plane device relocation or a change of service area. First, entry into a new service area (e.g., new tracking area, new routing area, etc.) is identified <b>1102</b> at the device. Next, a service area update request is transmitted <b>1104</b> to a network device associated with a network. Then, a control plane message (one non-limiting, non-exclusive example includes a security mode command) is received <b>1106</b> from the network indicating control plane device relocation or a key refresh due to a service area change in response to transmitting the service area update request. Next, a first key (e.g., K<sub>ASME</sub>) is derived 1108 based in part on data included in the control plane message received and a second key (e.g., K<sub>SKMF</sub>) shared between the device and a key management device (e.g., SKMF), where the key management device is associated with the network. According to one aspect, the control plane message is received from a target control plane device (e.g., target MME) due to the service area change, the target control plane device being a different control plane device (e.g., source MME) from one currently serving the device. According to another aspect, the data included in the control plane message includes a control plane device identifier (e.g., MME identifier such as but not limited to GUMMEI) that identifies a control plane device that is and/or will be serving the device.</div>
<div class="description-paragraph" id="p-0104" num="0103">According to one aspect, deriving the first key is further based in part on a counter value Key Count maintained at the key management device and is included in the control plane message. According to another aspect, at least one of an evolved node B (eNB) key K<sub>eNB</sub>, a non-access stratum key K<sub>NAS</sub>, and/or a next hop (NH) key is derived based on the first key to secure communications between the device and the network. According to yet another aspect, the new service area is at least one of a new tracking area and/or a new routing area, and the service area update request is associated with at least one of a tracking area update and/or a routing area update.</div>
<div class="description-paragraph" id="p-0105" num="0104">According to one aspect, the control plane message is a security mode command, the target control plane device is a target MME, the key management device is an SKMF device, and the second key is a session root key (e.g., anchor key K<sub>SEAF</sub>) for an authentication session. According to another aspect, a control plane device maintains a mobility management context and a session management context for the device, and the key management device maintains the second key.</div>
<div class="description-paragraph" id="p-0106" num="0105"> <figref idrefs="DRAWINGS">FIG. 12</figref> illustrates a method <b>1200</b> operational at a device for performing handover involving control plane device relocation or a change of service area. First, a handover command is received <b>1202</b> from a network device (e.g., source eNB) associated with the network, where the handover command indicates a new service area (e.g., new tracking area, new routing area, etc.). Next, a first key (e.g., K<sub>ASME</sub>) is derived 1204 based on data included in the handover command and on a second key (e.g., K<sub>SKMF</sub>) shared between the device and a key management device (e.g., SKMF), where the key management device is associated with the network. Then, a handover confirmation message that is secured based on the first key is sent <b>1206</b> to the network device.</div>
<div class="description-paragraph" id="p-0107" num="0106">According to one aspect, the handover command includes a target control plane device identifier (e.g., target MME identifier that may include GUMMEI) associated with a target control plane device (e.g., target MME) serving a target radio access node (e.g., target eNB) that is and/or will be serving the device. According to another aspect, deriving the first key is based in part on the target control plane device identifier. According to yet another aspect, the target control plane device is a target mobility management entity (MME), the key management device is a session key management function (SKMF) device, and the target control plane device identifier is an MME identifier associated with the target MME.</div>
<div class="description-paragraph" id="p-0108" num="0107"> <figref idrefs="DRAWINGS">FIG. 13</figref> illustrates a schematic block diagram of a network device <b>1300</b> according to one aspect of the disclosure. The network device <b>1300</b> may be an MME, a RAN, S-GW, and/or P-GW. The network device <b>1300</b> may include at least one or more wireless communication interfaces <b>1302</b>, one or more memory circuits <b>1304</b>, one or more input and/or output (I/O) devices/circuits <b>1306</b>, and/or one or more processing circuits <b>1308</b> that may be communicatively coupled to one another. For example, the interface <b>1302</b>, the memory circuit <b>1304</b>, the I/O devices <b>1306</b>, and the processing circuit <b>1308</b> may be communicatively coupled to each other through a bus <b>1310</b>. The wireless communication interface <b>1302</b> allows the network device <b>1300</b> to communicate wirelessly with the user device <b>102</b>. Thus, the interface <b>1302</b> allows the network device <b>1300</b> to communicate wirelessly through wireless wide area networks (WWAN), such as mobile telecommunication cellular networks, and/or short range, wireless local area networks (e.g., WiFi®, Zigbee®, Bluetooth®, etc.).</div>
<div class="description-paragraph" id="p-0109" num="0108">The memory circuit <b>1304</b> may include one or more volatile memory circuits and/or non-volatile memory circuits. Thus, the memory circuit <b>1304</b> may include DRAM, SRAM, MRAM, EEPROM, flash memory, etc. The memory circuit <b>1304</b> may store one or more cryptographic keys. The memory circuit <b>1304</b> may also store instructions that may be executed by the processing circuit <b>1308</b>. The I/O devices/circuits <b>1306</b> may include one or more keyboards, mice, displays, touchscreen displays, printers, fingerprint scanners, and any other input and/or output devices.</div>
<div class="description-paragraph" id="p-0110" num="0109">The processing circuit <b>1308</b> (e.g., processor, central processing unit (CPU), application processing unit (APU), etc.) may execute instructions stored at the memory circuit <b>1306</b> and/or instructions stored at another computer-readable storage medium (e.g., hard disk drive, optical disk drive, solid-state drive, etc.) communicatively coupled to the network device <b>1300</b>. The processing circuit <b>1308</b> may perform any one of the steps and/or processes of a network devices described herein including those discussed with reference to <figref idrefs="DRAWINGS">FIGS. 2, 3, 4, 5, 6, 7, 8, 9, 14, and 15</figref>.</div>
<div class="description-paragraph" id="p-0111" num="0110"> <figref idrefs="DRAWINGS">FIG. 14</figref> illustrates a method <b>1400</b> operational at a network device for performing a tracking area update involving control plane device relocation or a change of service area at the control plane device. First, a service area update request is received <b>1402</b> from a device (e.g., user equipment) for which the network device does not have a device context (e.g., UE context) or the device has changed service areas (e.g., tracking areas or routing areas). Next, a request for a first key (e.g., K<sub>ASME</sub>) is transmitted <b>1404</b> to a key management device (e.g., SKMF). Then, the first key is received <b>1406</b> from the key management device, where the first key based in part on a second key (e.g., K<sub>SKMF</sub>) shared between the key management device and the device. Next, a control plane message is transmitted <b>1408</b> to the device that includes data allowing the device to derive the first key. According to one aspect, the network device is a mobility management entity (MME) and the first key is further based on an MME identifier that identifies the MME. According to another aspect, a device context request is transmitted to a prior control plane device that previously served the device if the network device does not have the device context.</div>
<div class="description-paragraph" id="p-0112" num="0111">According to one aspect, the device context is received from the prior control plane device in response to transmitting the device context request. According to another aspect, the data includes a control plane device identifier that identifies the network device. According to yet another aspect, a counter value Key Count is received from the key management device along with the first key.</div>
<div class="description-paragraph" id="p-0113" num="0112">According to one aspect, the counter value Key Count is included in the data transmitted to the device. According to another aspect, a service area update is transmitted to the device after receiving notification from the device that the control plane message was successfully received. According to yet another aspect, the service area update request is associated with at least one of a tracking area update and/or a routing area update and changing service areas includes at least one of changing tracking areas and/or changing routing areas. According to another aspect, the control plane message is a non-access stratum security mode command, the key management device is a session key management function (SKMF) device, the device is a user equipment, the device context is a user equipment context associated with the user equipment, and the second key is a session root key (e.g., anchor key K<sub>SEAF</sub>) for an authentication session.</div>
<div class="description-paragraph" id="p-0114" num="0113"> <figref idrefs="DRAWINGS">FIG. 15</figref> illustrates a method <b>1500</b> operational at a network device for performing handover involving a control plane device relocation or a change of service area at the control plane device. First, a forward relocation request is received <b>1502</b> at the network device from a source control plane device. Next, a request for a first key is transmitted <b>1504</b> to a key management (SKMF) device. Then, the first key is received <b>1506</b> from the key management device, where the first key is based in part on a second key shared between the key management device and a device. Next, a handover request is transmitted to a target radio access node (RAN) with a RAN session key (e.g., RAN key) derived from the first key. According to one aspect, a handover request acknowledgement message is received from the target RAN indicating the target RAN will serve the device. According to another aspect, an acknowledgement message is transmitted to the key management device indicating receipt of the first key only after receiving the handover request acknowledgement message from the target RAN.</div>
<div class="description-paragraph" id="p-0115" num="0114">According to one aspect, a forward relocation response is transmitted to the source control plane device that includes data utilized by the device to derive the first key. According to another aspect, the network device is a target control plane device that will serve the device and the data includes a target control plane device identifier that identifies the target control plane device. According to yet another aspect, the target control plane device is a target mobility management entity (MME), the source control plane device is a source MME, the target control plane device identifier is a globally unique MME identifier (GUMMEI), the key management device is a session key management function (SKMF) device, and the device is a user equipment. According to yet another aspect, a counter value Key Count is received along with the first key.</div>
<div class="description-paragraph" id="p-0116" num="0115"> <figref idrefs="DRAWINGS">FIG. 16</figref> illustrates a block diagram of a device <b>1600</b> (e.g., user device/equipment) according to one aspect of the disclosure. The device <b>1600</b> may include a service area identification circuit <b>1602</b>, a service area update request transmission circuit <b>1604</b>, a control plane message receiving circuit <b>1606</b>, and/or a first key derivation circuit <b>1608</b>, which may all be communicatively coupled via a communication bus <b>1610</b>. Each of the circuits <b>1602</b>, <b>1604</b>, <b>1606</b>, <b>1608</b> of the device <b>1600</b> may be specialized circuits (e.g., application specific integrated circuits (ASICs), field programmable gate arrays (FPGAs), etc.) that are specifically wired to perform their respective specific functions.</div>
<div class="description-paragraph" id="p-0117" num="0116">The service area identification circuit <b>1602</b> may be one example of a means for identifying entry into a new service area. The service area update request transmission circuit <b>1604</b> may be one example of a means for transmitting a service area update request to a network device associated with the network. The control plane message receiving circuit <b>1606</b> may be one example of a means for receiving a control plane message from the network indicating control plane device relocation or a key refresh due to a service area change in response to transmitting the service area update request. The first key derivation circuit <b>1608</b> may be one example of a means for deriving a first key based in part on data included in the control plane message received and a second key shared between the device and a key management device.</div>
<div class="description-paragraph" id="p-0118" num="0117"> <figref idrefs="DRAWINGS">FIG. 17</figref> illustrates a block diagram of a device <b>1700</b> (e.g., user device/equipment) according to one aspect of the disclosure. The device <b>1700</b> may include a handover command receiving circuit <b>1702</b>, a first key derivation circuit <b>1704</b>, and/or a handover confirmation transmission circuit <b>1706</b>, which may all be communicatively coupled via a communication bus <b>1708</b>. Each of the circuits <b>1702</b>, <b>1704</b>, <b>1706</b> of the device <b>1700</b> may be specialized circuits (e.g., ASICs, FPGAs, etc.) that are specifically wired to perform their respective specific functions.</div>
<div class="description-paragraph" id="p-0119" num="0118">The handover command receiving circuit <b>1702</b> may be one example of a means for receiving a handover command from a network device associated with the network, the handover command indicating a new service area. The first key derivation circuit <b>1704</b> may be one example of a means for deriving a first key based on data included in the handover command and on a second key shared between the device and a key management device. The handover confirmation transmission circuit <b>1706</b> may be one example of a means for sending a handover confirmation message that is secured based on the first key.</div>
<div class="description-paragraph" id="p-0120" num="0119"> <figref idrefs="DRAWINGS">FIG. 18</figref> illustrates a block diagram of a network device <b>1800</b> (e.g., MME) according to one aspect of the disclosure. The device <b>1800</b> may include a first key request transmission circuit <b>1802</b>, a service area update request receiving circuit <b>1804</b>, a first key receiving circuit <b>1806</b>, and/or control plane message transmission circuit <b>1808</b>, which may all be communicatively coupled via a communication bus <b>1810</b>. Each of the circuits <b>1802</b>, <b>1804</b>, <b>1806</b>, <b>1808</b> of the network device <b>1800</b> may be specialized circuits (e.g., ASICs, FPGAs, etc.) that are specifically wired to perform their respective specific functions.</div>
<div class="description-paragraph" id="p-0121" num="0120">The first key request transmission circuit <b>1802</b> may be one example of a means for transmitting a request for a first key to a key management device. The service area update request receiving circuit <b>1804</b> may be one example of a means for receiving a service area update request from a device for which the network device does not have a device context or the device has changed service areas. The first key receiving circuit <b>1806</b> may be one example of a means for receiving the first key from the key management device, the first key based in part on a second key shared between the key management device and the device. The control plane message transmission circuit <b>1808</b> may be one example of a means for transmitting a control plane message to the device that includes data allowing the device to derive the first key.</div>
<div class="description-paragraph" id="p-0122" num="0121"> <figref idrefs="DRAWINGS">FIG. 19</figref> illustrates a block diagram of a network device <b>1900</b> (e.g., MME) according to one aspect of the disclosure. The device <b>1900</b> may include a forward relocation request receiving circuit <b>1902</b>, a first key request transmission circuit <b>1904</b>, a first key receiving circuit <b>1906</b>, and/or a handover request transmission circuit <b>1908</b>, which may all be communicatively coupled via a communication bus <b>1910</b>. Each of the circuits <b>1902</b>, <b>1904</b>, <b>1906</b>, <b>1908</b> of the network device <b>1900</b> may be specialized circuits (e.g., ASICs, FPGAs, etc.) that are specifically wired to perform their respective specific functions.</div>
<div class="description-paragraph" id="p-0123" num="0122">The forward relocation request receiving circuit <b>1902</b> may be one example of a means for receiving a forward relocation request at the network device from a source control plane device. The first key request transmission circuit <b>1904</b> may be one example of a means for transmitting a request for a first key to a key management device. The first key receiving circuit <b>1906</b> may be one example of a means for receiving the first key from the key management device, the first key based in part on a second key shared between the key management device and a device. The handover request transmission circuit <b>1908</b> may be one example of a means for transmitting a handover request to a target radio access node (RAN) with a RAN session key derived from the first key.</div>
<div class="description-paragraph" id="p-0124" num="0123">One or more of the components, steps, features, and/or functions illustrated in <figref idrefs="DRAWINGS">FIGS. 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18</figref>, and/or <b>19</b> may be rearranged and/or combined into a single component, step, feature or function or embodied in several components, steps, or functions. Additional elements, components, steps, and/or functions may also be added without departing from the invention. The apparatus, devices, and/or components illustrated in <figref idrefs="DRAWINGS">FIGS. 1, 3, 4, 5, 7, 8, 9, 10, 13, 16, 17, 18</figref>, and/or <b>19</b> may be configured to perform one or more of the methods, features, or steps described in <figref idrefs="DRAWINGS">FIGS. 2, 6, 7, 8, 9, 11, 12, 14</figref>, and/or <b>15</b>. The algorithms described herein may also be efficiently implemented in software and/or embedded in hardware.</div>
<div class="description-paragraph" id="p-0125" num="0124">Also, it is noted that the aspects of the present disclosure may be described as a process that is depicted as a flowchart, a flow diagram, a structure diagram, or a block diagram. Although a flowchart may describe the operations as a sequential process, many of the operations can be performed in parallel or concurrently. In addition, the order of the operations may be re-arranged. A process is terminated when its operations are completed. A process may correspond to a method, a function, a procedure, a subroutine, a subprogram, etc. When a process corresponds to a function, its termination corresponds to a return of the function to the calling function or the main function.</div>
<div class="description-paragraph" id="p-0126" num="0125">Moreover, a storage medium may represent one or more devices for storing data, including read-only memory (ROM), random access memory (RAM), magnetic disk storage mediums, optical storage mediums, flash memory devices and/or other machine-readable mediums and, processor-readable mediums, and/or computer-readable mediums for storing information. The terms “machine-readable medium”, “computer-readable medium”, and/or “processor-readable medium” may include, but are not limited to non-transitory mediums such as portable or fixed storage devices, optical storage devices, and various other mediums capable of storing or containing instruction(s) and/or data. Thus, the various methods described herein may be fully or partially implemented by instructions and/or data that may be stored in a “machine-readable medium”, “computer-readable medium”, and/or “processor-readable medium” and executed by one or more processors, machines and/or devices.</div>
<div class="description-paragraph" id="p-0127" num="0126">Furthermore, aspects of the disclosure may be implemented by hardware, software, firmware, middleware, microcode, or any combination thereof. When implemented in software, firmware, middleware or microcode, the program code or code segments to perform the necessary tasks may be stored in a machine-readable medium such as a storage medium or other storage(s). A processor may perform the necessary tasks. A code segment may represent a procedure, a function, a subprogram, a program, a routine, a subroutine, a module, a software package, a class, or any combination of instructions, data structures, or program statements. A code segment may be coupled to another code segment or a hardware circuit by passing and/or receiving information, data, arguments, parameters, or memory contents. Information, arguments, parameters, data, etc. may be passed, forwarded, or transmitted via any suitable means including memory sharing, message passing, token passing, network transmission, etc.</div>
<div class="description-paragraph" id="p-0128" num="0127">The various illustrative logical blocks, modules, circuits, elements, and/or components described in connection with the examples disclosed herein may be implemented or performed with a general purpose processor, a digital signal processor (DSP), an application specific integrated circuit (ASIC), a field programmable gate array (FPGA) or other programmable logic component, discrete gate or transistor logic, discrete hardware components, or any combination thereof designed to perform the functions described herein. A general purpose processor may be a microprocessor, but in the alternative, the processor may be any conventional processor, controller, microcontroller, or state machine. A processor may also be implemented as a combination of computing components, e.g., a combination of a DSP and a microprocessor, a number of microprocessors, one or more microprocessors in conjunction with a DSP core, or any other such configuration.</div>
<div class="description-paragraph" id="p-0129" num="0128">The methods or algorithms described in connection with the examples disclosed herein may be embodied directly in hardware, in a software module executable by a processor, or in a combination of both, in the form of processing unit, programming instructions, or other directions, and may be contained in a single device or distributed across multiple devices. A software module may reside in RAM memory, flash memory, ROM memory, EPROM memory, EEPROM memory, registers, hard disk, a removable disk, a CD-ROM, or any other form of storage medium known in the art. A storage medium may be coupled to the processor such that the processor can read information from, and write information to, the storage medium. In the alternative, the storage medium may be integral to the processor.</div>
<div class="description-paragraph" id="p-0130" num="0129">Those of skill in the art would further appreciate that the various illustrative logical blocks, modules, circuits, and algorithm steps described in connection with the aspects disclosed herein may be implemented as electronic hardware, computer software, or combinations of both. To clearly illustrate this interchangeability of hardware and software, various illustrative components, blocks, modules, circuits, and steps have been described above generally in terms of their functionality. Whether such functionality is implemented as hardware or software depends upon the particular application and design constraints imposed on the overall system.</div>
<div class="description-paragraph" id="p-0131" num="0130">The various features of the invention described herein can be implemented in different systems without departing from the invention. It should be noted that the foregoing aspects of the disclosure are merely examples and are not to be construed as limiting the invention. The description of the aspects of the present disclosure is intended to be illustrative, and not to limit the scope of the claims. As such, the present teachings can be readily applied to other types of apparatuses and many alternatives, modifications, and variations will be apparent to those skilled in the art.</div>
</div>
</div>
</section><section itemprop="claims" itemscope="">
<h2>Claims (<span itemprop="count">24</span>)</h2>
<div html="" itemprop="content"><div class="claims" lang="EN" load-source="patent-office" mxw-id="PCLM306526367">
<claim-statement>What is claimed is:</claim-statement>
<div class="claim"> <div class="claim" id="CLM-00001" num="00001">
<div class="claim-text">1. A user equipment (UE) for use in wireless communication, the UE comprising:
<div class="claim-text">a wireless communication interface configured to transmit and receive data wirelessly to a network; and</div>
<div class="claim-text">a processing circuit communicatively coupled to the wireless communication interface, the processing circuit configured to:
<div class="claim-text">receive a handover command from a first network apparatus of a current service area for a handover of the UE from the first network apparatus to a second network apparatus of a new service area, the first network apparatus implementing a mobility management function associated with the network, the handover command received from the first network apparatus through a source access node of the current service area, the handover command indicating the new service area and identifying the second network apparatus, the second network apparatus implementing a mobility management function associated with the new service area;</div>
<div class="claim-text">derive a first key based on data included in the handover command and on a second key shared between the UE and a key management device that is separate from the first network apparatus and the second network apparatus, the key management device associated with the network, wherein the first key is based on a device identifier within the data that identifies the second network apparatus; and</div>
<div class="claim-text">send a handover confirmation message that is secured based on the first key, the handover confirmation message confirming the handover from the first network apparatus of the current service area to the second network apparatus of the new service area.</div>
</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00002" num="00002">
<div class="claim-text">2. The UE of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the second network apparatus is a target control plane device and the handover command is configured to include a target control plane device identifier associated with the target control plane device.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00003" num="00003">
<div class="claim-text">3. The UE of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the processing circuit is further configured to derive the first key based in part on the target control plane device identifier.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00004" num="00004">
<div class="claim-text">4. The UE of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the target control plane device is a target mobility management entity (MME), the key management device is a session key management function (SKMF) device, and the target control plane device identifier is configured as an MME identifier associated with the target MME.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00005" num="00005">
<div class="claim-text">5. The UE of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the processing circuit is further configured to derive the first key based in part on a counter value obtained from the data of the handover command.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00006" num="00006">
<div class="claim-text">6. The UE of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the second key is configured as a session root key for an authentication session.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00007" num="00007">
<div class="claim-text">7. The UE of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the processing circuit is further configured to derive the first key based in part on a nonce obtained from the data of the handover command.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00008" num="00008">
<div class="claim-text">8. The UE of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the processing circuit is further configured to derive a third key based on the first key and the data of the handover command, the third key configured for securing communications between the UE and a target access node.</div>
</div>
</div> <div class="claim"> <div class="claim" id="CLM-00009" num="00009">
<div class="claim-text">9. A method operational at a UE for use in wireless communications, the method comprising:
<div class="claim-text">receiving a handover command from a first network apparatus of a current service area for a handover of the UE from the first network apparatus to a second network apparatus of a new service area, the first network apparatus implementing a mobility management function associated with a network, the handover command received from the first network apparatus through a source access node of the current service area, the handover command indicating the new service area and identifying the second network apparatus, the second network apparatus implementing a mobility management function associated with the new service area;</div>
<div class="claim-text">deriving a first key based on data included in the handover command and on a second key shared between the UE and a key management device that is separate from the first network apparatus and the second network apparatus, the key management device associated with the network, wherein the first key is based on a device identifier within the data that identifies the second network apparatus; and</div>
<div class="claim-text">sending a handover confirmation message that is secured based on the first key, the handover confirmation message confirming the handover from the first network apparatus of the current service area to the second network apparatus of the new service area.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00010" num="00010">
<div class="claim-text">10. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the second network apparatus is a target control plane device and the handover command includes a target control plane device identifier associated with the target control plane device.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00011" num="00011">
<div class="claim-text">11. The method of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein deriving the first key is based in part on the target control plane device identifier.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00012" num="00012">
<div class="claim-text">12. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein deriving the first key is further based in part on a counter value obtained from the data of the handover command the data.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00013" num="00013">
<div class="claim-text">13. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the second key is a session root key for an authentication session.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00014" num="00014">
<div class="claim-text">14. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein deriving the first key is based in part on a nonce obtained from the data of the handover command.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00015" num="00015">
<div class="claim-text">15. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising deriving a third key based on the first key and the data of the handover command and securing communications between the UE and a target access node using the third key.</div>
</div>
</div> <div class="claim"> <div class="claim" id="CLM-00016" num="00016">
<div class="claim-text">16. An apparatus for wireless communication comprising:
<div class="claim-text">means for receiving a handover command at a user equipment (UE) from a first network apparatus of a current service area for a handover of the UE from the first network apparatus to a second network apparatus of a new service area, the first network apparatus implementing a mobility management function associated with a network, the handover command received from the first network apparatus through a source access node of the current service area, the handover command indicating the new service area and identifying the second network apparatus, the second network apparatus implementing a mobility management function associated with the new service area;</div>
<div class="claim-text">means for deriving a first key at the UE based on data included in the handover command and on a second key shared between the UE and a key management device that is separate from the first network apparatus and the second network apparatus, the key management device associated with the network, wherein the first key is based on a device identifier within the data that identifies the second network apparatus; and</div>
<div class="claim-text">means for sending a handover confirmation message from the UE that is secured based on the first key, the handover confirmation message confirming the handover from the first network apparatus of the current service area to the second network apparatus of the new service area.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00017" num="00017">
<div class="claim-text">17. The apparatus of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the second network apparatus is a target control plane device and the means for receiving a handover command comprises means for receiving a target control plane device identifier associated with the target control plane device.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00018" num="00018">
<div class="claim-text">18. The apparatus of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein the means for deriving the first key comprises means for deriving the first key based in part on the target control plane device identifier.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00019" num="00019">
<div class="claim-text">19. The apparatus of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the means for deriving the first key further comprises means for deriving the first key based in part on a counter value obtained from the data of the handover command.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00020" num="00020">
<div class="claim-text">20. The apparatus of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the second key is a session root key for an authentication session.</div>
</div>
</div> <div class="claim"> <div class="claim" id="CLM-00021" num="00021">
<div class="claim-text">21. A processor-readable storage medium having one or more instructions which when executed by at least one processing circuit of a user equipment (UE) causes the at least one processing circuit to:
<div class="claim-text">receive a handover command from a first network apparatus of a current service area for a handover of the UE from the first network apparatus to a second network apparatus of a new service area, the first network apparatus implementing a mobility management function associated with a network, the handover command received from the first network apparatus through a source access node of a current service area, the handover command indicating a new service area and identifying a second network apparatus, the second network apparatus implementing a mobility management function associated with the new service area;</div>
<div class="claim-text">derive a first key based on data included in the handover command and on a second key shared between the UE and a key management device that is separate from the first network apparatus and the second network apparatus, the key management device associated with the network, wherein the first key is based on a device identifier within the data that identifies the second network apparatus; and</div>
<div class="claim-text">send a handover confirmation message that is secured based on the first key, the handover confirmation message confirming the handover from the first network apparatus of the current service area to the second network apparatus of the new service area.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00022" num="00022">
<div class="claim-text">22. The processor-readable storage medium of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the second network apparatus is a target control plane device and the handover command includes a target control plane device identifier associated with the target control plane device.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00023" num="00023">
<div class="claim-text">23. The processor-readable storage medium of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the one or more instructions include instructions for deriving the first key based in part on the target control plane device identifier.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00024" num="00024">
<div class="claim-text">24. The processor-readable storage medium of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the one or more instructions include instructions for deriving the first key based in part on a counter value obtained from within the data of the handover command.</div>
</div>
</div> </div>
</div>
</section>
                </article>
            </search-app>
        </body>
    </html>
    