
    <html>
        <body>
            <search-app>
                <article class="result" itemscope="" itemtype="http://schema.org/ScholarlyArticle">
    <h1 itemprop="pageTitle">US9998742B2 - Adaptive cross component residual prediction 
        - Google Patents</h1><section itemprop="abstract" itemscope="">
<h2>Abstract</h2>
<div html="" itemprop="content"><abstract lang="EN" load-source="patent-office" mxw-id="PA230957371">
<div class="abstract" id="p-0001" num="0000">A system and method for encoding and decoding video data. A predicted residual signal of a target color component is determined as a function of one or more linear parameters of a linear model and of a residual signal of a source color component. A residual signal of the target color component is determined as a function of a remaining residual signal of the target color component and of the predicted residual signal of the target color component.</div>
</abstract>
</div>
</section><section itemprop="description" itemscope="">
<h2>Description</h2>
<div html="" itemprop="content"><div class="description" lang="EN" load-source="patent-office" mxw-id="PDES137948910">
<div class="description-paragraph" id="p-0002" num="0001">This application claims the benefit of U.S. Provisional Patent Application No. 62/108,491, filed Jan. 27, 2015, the entire content of which is incorporated herein by reference.</div>
<heading id="h-0001">TECHNICAL FIELD</heading>
<div class="description-paragraph" id="p-0003" num="0002">This disclosure relates to video coding.</div>
<heading id="h-0002">BACKGROUND</heading>
<div class="description-paragraph" id="p-0004" num="0003">Digital video capabilities can be incorporated into a wide range of devices, including digital televisions, digital direct broadcast systems, wireless broadcast systems, personal digital assistants (PDAs), laptop or desktop computers, tablet computers, e-book readers, digital cameras, digital recording devices, digital media players, video gaming devices, video game consoles, cellular or satellite radio telephones, so-called “smart phones,” video teleconferencing devices, video streaming devices, and the like. Digital video devices implement video coding techniques, such as those described in the standards defined by MPEG-2, MPEG-4, ITU-T H.263, ITU-T H.264/MPEG-4, Part 10, Advanced Video Coding (AVC), ITU-T H.265, High Efficiency Video Coding (HEVC), and extensions of such standards, such as scalable video coding (SVC), multiview video coding (MVC), scalable HEVC (SHVC), multiview HEVC (MV-HEVC), 3D-HEVC, and the HEVC Range Extensions. The video devices may transmit, receive, encode, decode, and/or store digital video information more efficiently by implementing such video coding techniques.</div>
<div class="description-paragraph" id="p-0005" num="0004">Video coding techniques include spatial (intra-picture) prediction and/or temporal (inter-picture) prediction to reduce or remove redundancy inherent in video sequences. For block-based video coding, a video slice (e.g., a video frame or a portion of a video frame) may be partitioned into video blocks, which may also be referred to as treeblocks, coding tree units (CTUs), coding units (CUs) and/or coding nodes. Video blocks may include luma blocks and chroma blocks. In an intra-coded (I) slice of a picture, blocks are encoded using spatial prediction with respect to reference samples in neighboring blocks in the same picture. Video blocks in an inter-coded (P or B) slice of a picture may use spatial prediction with respect to reference samples in neighboring blocks in the same picture or temporal prediction with respect to reference samples in other reference pictures. Pictures may be referred to as frames, and reference pictures may be referred to as reference frames.</div>
<div class="description-paragraph" id="p-0006" num="0005">Spatial or temporal prediction results in a predictive block for a block to be coded. Residual data represents pixel differences between the original block to be coded and the predictive block. An inter-coded block is encoded according to a motion vector that points to a block of reference samples forming the predictive block, and the residual data indicating the difference between the coded block and the predictive block. An intra-coded block is encoded according to an intra-coding mode and the residual data. For further compression, the residual data may be transformed from the pixel domain to a transform domain, resulting in residual transform coefficients, which then may be quantized. The quantized transform coefficients may be entropy coded to achieve even more compression.</div>
<heading id="h-0003">SUMMARY</heading>
<div class="description-paragraph" id="p-0007" num="0006">This disclosure is related to the field of video coding, and more particularly is related to adaptive cross component residual prediction. Particular techniques of this disclosure may reduce, eliminate or otherwise control inter-component redundancy. It may be used in the context of advanced video codecs, such as extensions of HEVC or the next generation of video coding standards.</div>
<div class="description-paragraph" id="p-0008" num="0007">In one aspect, this disclosure describes a method of encoding video data, the method comprising determining, within an encoder, a predicted residual signal of a target color component of a current block as a function of one or more parameters of a linear model and of a residual signal of a source color component of the current block; determining, within the encoder, a remaining residual signal for the target color component based on a residual signal of the target color component and the predicted residual signal of the target color component; encoding values of the remaining residual signal of the target color component; and outputting the encoded remaining residual signal values in a video bitstream.</div>
<div class="description-paragraph" id="p-0009" num="0008">In another aspect, this disclosure describes a device for encoding video data, the device comprising: a memory configured to store the video data; and one or more processors configured to: determine a predicted residual signal of a target color component of a current block as a function of one or more parameters of a linear model and of a residual signal of a source color component of the current block; determine a remaining residual signal for the target color component based on a residual signal of the target color component and the predicted residual signal of the target color component; encode values of the remaining residual signal of the target color component; and output the encoded remaining residual signal values in a video bitstream.</div>
<div class="description-paragraph" id="p-0010" num="0009">In another aspect, this disclosure describes a device for encoding video data, the device comprising: means for determining, within an encoder, a predicted residual signal of a target color component of a current block as a function of one or more parameters of a linear model and of a residual signal of a source color component of the current block; means for determining, within the encoder, a remaining residual signal for the target color component based on a residual signal of the target color component and the predicted residual signal of the target color component; means for encoding values of the remaining residual signal of the target color component; and means for outputting the encoded remaining residual signal values in a video bitstream.</div>
<div class="description-paragraph" id="p-0011" num="0010">In another aspect, this disclosure describes a computer-readable storage medium having stored thereon instructions that, when executed, cause one or more processors of a device for encoding video data to: determine a predicted residual signal of a target color component of a current block as a function of one or more parameters of a linear model and of a residual signal of a source color component of the current block; determine a remaining residual signal for the target color component based on a residual signal of the target color component and the predicted residual signal of the target color component; encode values of the remaining residual signal of the target color component; and output the encoded remaining residual signal values in a video bitstream.</div>
<div class="description-paragraph" id="p-0012" num="0011">In another aspect, this disclosure describes a method of decoding video data, comprising: determining, as a function of one or more linear parameters of a linear model and of a residual signal of a source color component, a predicted residual signal of a target color component; and determining a residual signal of the target color component as a function of a decoded remaining residual signal of the target color component and of the predicted residual signal of the target color component.</div>
<div class="description-paragraph" id="p-0013" num="0012">In another aspect, this disclosure describes a device for decoding video data, the device comprising: a memory configured to store the video data; and one or more processors configured to: determine, as a function of one or more linear parameters of a linear model and of a residual signal of a source color component, a predicted residual signal of a target color component; and determine a residual signal of the target color component as a function of a decoded remaining residual signal of the target color component and of the predicted residual signal of the target color component.</div>
<div class="description-paragraph" id="p-0014" num="0013">In another aspect, this disclosure describes a device for decoding video data, the device comprising: means for determining, as a function of one or more linear parameters of a linear model and of a residual signal of a source color component, a predicted residual signal of a target color component; and means for determining a residual signal of the target color component as a function of a decoded remaining residual signal of the target color component and of the predicted residual signal of the target color component.</div>
<div class="description-paragraph" id="p-0015" num="0014">In another aspect, this disclosure describes a computer-readable storage medium having stored thereon instructions that, when executed, cause one or more processors of a device for decoding video data to: determine, as a function of one or more linear parameters of a linear model and of a residual signal of a source color component, a predicted residual signal of a target color component; and determine a residual signal of the target color component as a function of a decoded remaining residual signal of the target color component and of the predicted residual signal of the target color component.</div>
<div class="description-paragraph" id="p-0016" num="0015">The details of one or more examples of the disclosure are set forth in the accompanying drawings and the description below. Other features, objects, and advantages will be apparent from the description, drawings, and claims.</div>
<description-of-drawings>
<heading id="h-0004">BRIEF DESCRIPTION OF DRAWINGS</heading>
<div class="description-paragraph" id="p-0017" num="0016"> <figref idrefs="DRAWINGS">FIG. 1</figref> is a block diagram illustrating an example video encoding and decoding system that may be configured or otherwise operable to implement or otherwise utilize one or more techniques described in this disclosure.</div>
<div class="description-paragraph" id="p-0018" num="0017"> <figref idrefs="DRAWINGS">FIG. 2</figref> is a block diagram illustrating an example of a video encoder that may be configured or otherwise operable to implement or otherwise utilize one or more techniques described in this disclosure.</div>
<div class="description-paragraph" id="p-0019" num="0018"> <figref idrefs="DRAWINGS">FIG. 3</figref> is a block diagram illustrating an example of a video decoder that may be configured or otherwise operable to implement or otherwise utilize one or more techniques described in this disclosure.</div>
<div class="description-paragraph" id="p-0020" num="0019"> <figref idrefs="DRAWINGS">FIG. 4</figref> is a flowchart illustrating an example of the encoding of video data, in accordance with one aspect of this disclosure.</div>
<div class="description-paragraph" id="p-0021" num="0020"> <figref idrefs="DRAWINGS">FIG. 5</figref> is a flowchart illustrating a more detailed example of the encoding of video data, in accordance with one aspect of this disclosure.</div>
<div class="description-paragraph" id="p-0022" num="0021"> <figref idrefs="DRAWINGS">FIG. 6</figref> is a flowchart illustrating the prediction of the residual signal of a first color component from the residual signal of a second color component, in accordance with one aspect of this disclosure.</div>
<div class="description-paragraph" id="p-0023" num="0022"> <figref idrefs="DRAWINGS">FIG. 7</figref> is a flowchart illustrating the prediction of the residual signal of a Cb color component from the residual signal of a Cr color component, in accordance with one aspect of this disclosure.</div>
<div class="description-paragraph" id="p-0024" num="0023"> <figref idrefs="DRAWINGS">FIG. 8</figref> is a flowchart illustrating the derivation of parameters of a linear model based on inter prediction, in accordance with one aspect of this disclosure.</div>
<div class="description-paragraph" id="p-0025" num="0024"> <figref idrefs="DRAWINGS">FIG. 9</figref> is a flowchart illustrating the derivation of parameters of a linear model based on intra prediction, in accordance with one aspect of this disclosure.</div>
</description-of-drawings>
<heading id="h-0005">DETAILED DESCRIPTION</heading>
<div class="description-paragraph" id="p-0026" num="0025">This disclosure describes various techniques for video coding and/or compression. In particular examples, this disclosure is related to cross component prediction, which is used to reduce inter component redundancy. It may be used in the context of advanced video codecs, such as extensions of HEVC or the next generation of video coding standards.</div>
<div class="description-paragraph" id="p-0027" num="0026">Color video plays an essential role in multimedia systems, where various color spaces are used to efficiently represent color. A color space specifies color with numerical values using multiple components. A popular color space is the RGB color space, where color is represented as a combination of three primary color component values (i.e., red, green and blue). For color video compression, the YCbCr color space has been widely used. See, e.g., A. Ford and A. Roberts, “Colour space conversions,” University of Westminster, London, Tech. Rep., August 1998.</div>
<div class="description-paragraph" id="p-0028" num="0027">Video coding standards include ITU-T H.261, ISO/IEC MPEG-1 Visual, ITU-T H.262 or ISO/IEC MPEG-2 Visual, ITU-T H.263, ISO/IEC MPEG-4 Visual and ITU-T H.264 (also known as ISO/IEC MPEG-4 AVC), including its Scalable Video Coding (SVC) and Multi-view Video Coding (MVC) extensions.</div>
<div class="description-paragraph" id="p-0029" num="0028">A new international standard for video coding, named High Efficiency Video Coding (HEVC), was developed and finalized by the Joint Collaboration Team on Video Coding (JCT-VC), a group of video coding experts from the ITU-T Video Coding Experts Group (VCEG) and from the ISO/IEC Motion Picture Experts Group (MPEG). The first version of the HEVC standard was finalized in April 2013. A second version of HEVC including the RExt, SHVC and MV-HEVC extensions was finalized in October 2014. The third version of HEVC including the 3D-HEVC extension was finalized in February 2015, is currently in force and is available at http://www.itu.int/rec/T-REC-H.265. This third edition of the HEVC standard is referred to as the HEVC standard hereinafter. The second and third editions of the HEVC standard include the Format Range Extension (RExt), which extends video coding for color spaces other than YCbCr 4:2:0, such as YCbCr 4:2:2, YCbCr 4:4:4, and RGB 4:4:4.</div>
<div class="description-paragraph" id="p-0030" num="0029">YCbCr and RGB are the two primary color spaces used to represent digital video. RGB represents color as a combination of Red, Green and Blue, while YCbCr represents digital video as brightness (Y or luma), Blue minus luma (Cb, chroma blue or chrominance blue) and Red minus luma (Cr, chroma red or chrominance red). YCbCr can be easily converted from RGB color space via a linear transformation. The redundancy between different components, namely the cross component redundancy, is significantly reduced in the YCbCr color space. In addition, one advantage of YCbCr is backward compatibility with black and white TV, as the Y signal conveys the luminance information. In addition, chrominance bandwidth can be reduced by subsampling the Cb and Cr components in 4:2:0 chroma sampling format with significantly less subjective impact than subsampling in RGB. Because of these advantages, YCbCr has been the major color space in video compression.</div>
<div class="description-paragraph" id="p-0031" num="0030">There are also other color spaces, such as YCoCg, that can be used in video compression. YCoCg represents digital video as brightness (Y or luma), orange minus luma (Co, chroma orange or chrominance orange) and Green minus luma (Cr, chroma green or chrominance green). YCbCr can be easily converted from RGB color space via a linear transformation. In this document, regardless of the actual color space used, the terms Y, Cb, and Cr are used to represent the three color components in each video compression scheme. It should be understood that the techniques can be applied to other three color spaces as well.</div>
<div class="description-paragraph" id="p-0032" num="0031"> <figref idrefs="DRAWINGS">FIG. 1</figref> is a block diagram illustrating an example video encoding and decoding system that may be configured or otherwise operable to implement or otherwise utilize one or more techniques described in this disclosure. As shown in <figref idrefs="DRAWINGS">FIG. 1</figref>, system <b>10</b> includes a source device <b>12</b> that generates encoded video data to be decoded at a later time by a destination device <b>14</b>. Source device <b>12</b> and destination device <b>14</b> may comprise any of a wide range of devices, including desktop computers, notebook (i.e., laptop) computers, tablet computers, set-top boxes, telephone handsets such as so-called “smart” phones, so-called “smart” pads, televisions, cameras, display devices, digital media players, video gaming consoles, video streaming device, or the like. In some cases, source device <b>12</b> and destination device <b>14</b> may be equipped for wireless communication.</div>
<div class="description-paragraph" id="p-0033" num="0032">Destination device <b>14</b> may receive, via a link <b>16</b>, the encoded video data to be decoded. Link <b>16</b> may comprise any type of medium or device capable of moving the encoded video data from source device <b>12</b> to destination device <b>14</b>. In one example, link <b>16</b> may comprise a communication medium to enable source device <b>12</b> to transmit encoded video data directly to destination device <b>14</b> in real-time. The encoded video data may be modulated according to a communication standard, such as a wireless communication protocol, and transmitted to destination device <b>14</b>. The communication medium may comprise any wireless or wired communication medium, such as a radio frequency (RF) spectrum or one or more physical transmission lines. The communication medium may form part of a packet-based network, such as a local area network, a wide-area network, or a global network such as the Internet. The communication medium may include routers, switches, base stations, or any other equipment that may be useful to facilitate communication from source device <b>12</b> to destination device <b>14</b>.</div>
<div class="description-paragraph" id="p-0034" num="0033">Alternatively, encoded data may be output from output interface <b>22</b> to a storage device <b>31</b>. Similarly, encoded data may be accessed from storage device <b>31</b> by input interface. Storage device <b>31</b> may include any of a variety of distributed or locally accessed data storage media such as a hard drive, Blu-ray discs, DVDs, CD-ROMs, flash memory, volatile or non-volatile memory, or any other suitable digital storage media for storing encoded video data. In a further example, storage device <b>31</b> may correspond to a file server or another intermediate storage device that may hold the encoded video generated by source device <b>12</b>. Destination device <b>14</b> may access stored video data from storage device <b>31</b> via streaming or download. The file server may be any type of server capable of storing encoded video data and transmitting that encoded video data to the destination device <b>14</b>. Example file servers include a web server (e.g., for a website), an FTP server, network attached storage (NAS) devices, or a local disk drive. Destination device <b>14</b> may access the encoded video data through any standard data connection, including an Internet connection. This may include a wireless channel (e.g., a Wi-Fi connection), a wired connection (e.g., DSL, cable modem, etc.), or a combination of both that is suitable for accessing encoded video data stored on a file server. The transmission of encoded video data from storage device <b>31</b> may be a streaming transmission, a download transmission, or a combination of both.</div>
<div class="description-paragraph" id="p-0035" num="0034">The techniques of this disclosure are not limited to wireless applications or settings. The techniques may be applied to video coding in support of any of a variety of multimedia applications, such as over-the-air television broadcasts, cable television transmissions, satellite television transmissions, streaming video transmissions, e.g., via the Internet, encoding of digital video for storage on a data storage medium, decoding of digital video stored on a data storage medium, or other applications. In some examples, system <b>10</b> may be configured to support one-way or two-way video transmission to support applications such as video streaming, video playback, video broadcasting, and/or video telephony.</div>
<div class="description-paragraph" id="p-0036" num="0035">In the example of <figref idrefs="DRAWINGS">FIG. 1</figref>, source device <b>12</b> includes a video source <b>18</b>, video encoder <b>20</b> and an output interface <b>22</b>. In some cases, output interface <b>22</b> may include a modulator/demodulator (modem) and/or a transmitter. In source device <b>12</b>, video source <b>18</b> may include a source such as a video capture device, e.g., a video camera, a video archive containing previously captured video, a video feed interface to receive video from a video content provider, and/or a computer graphics system for generating computer graphics data as the source video, or a combination of such sources. As one example, if video source <b>18</b> is a video camera, source device <b>12</b> and destination device <b>14</b> may form so-called camera phones or video phones. However, the techniques described in this disclosure may be applicable to video coding in general, and may be applied to wireless and/or wired applications.</div>
<div class="description-paragraph" id="p-0037" num="0036">The captured, pre-captured, or computer-generated video may be encoded by video encoder <b>20</b>. The encoded video data may be transmitted directly to destination device <b>14</b> via output interface <b>22</b> of source device <b>12</b>. The encoded video data may also (or alternatively) be stored onto storage device <b>31</b> for later access by destination device <b>14</b> or other devices, for decoding and/or playback.</div>
<div class="description-paragraph" id="p-0038" num="0037">Destination device <b>14</b> includes an input interface <b>28</b>, a video decoder <b>30</b>, and a display device <b>32</b>. In some cases, input interface <b>28</b> may include a receiver and/or a modem. Input interface <b>28</b> of destination device <b>14</b> receives the encoded video data over link <b>16</b>. The encoded video data communicated over link <b>16</b>, or provided on storage device <b>31</b>, may include a variety of syntax elements generated by video encoder <b>20</b> for use by a video decoder, such as video decoder <b>30</b>, in decoding the video data. Such syntax elements may be included with the encoded video data transmitted on a communication medium, stored on a storage medium, or stored a file server.</div>
<div class="description-paragraph" id="p-0039" num="0038">Display device <b>32</b> may be integrated with, or external to, destination device <b>14</b>. In some examples, destination device <b>14</b> may include an integrated display device and also be configured to interface with an external display device. In other examples, destination device <b>14</b> may be a display device. In general, display device <b>32</b> displays the decoded video data to a user, and may comprise any of a variety of display devices such as a liquid crystal display (LCD), a plasma display, an organic light emitting diode (OLED) display, or another type of display device.</div>
<div class="description-paragraph" id="p-0040" num="0039">Video encoder <b>20</b> and video decoder <b>30</b> may operate according to a video compression standard, such as the High Efficiency Video Coding (HEVC) standard mentioned above, and may conform to the HEVC Test Model (HM). Alternatively, video encoder <b>20</b> and video decoder <b>30</b> may operate according to other proprietary or industry standards, such as the ITU-T H.264 standard, alternatively referred to as MPEG-4, Part 10, Advanced Video Coding (AVC), or extensions of such standards. The techniques of this disclosure, however, are not limited to any particular coding standard. Other examples of video compression standards include MPEG-2 and ITU-T H.263.</div>
<div class="description-paragraph" id="p-0041" num="0040">Although not shown in <figref idrefs="DRAWINGS">FIG. 1</figref>, in some aspects, video encoder <b>20</b> and video decoder <b>30</b> may each be integrated with an audio encoder and decoder, and may include appropriate MUX-DEMUX units, or other hardware and software, to handle encoding of both audio and video in a common data stream or separate data streams. If applicable, in some examples, MUX-DEMUX units may conform to the ITU H.223 multiplexer protocol, or other protocols such as the user datagram protocol (UDP).</div>
<div class="description-paragraph" id="p-0042" num="0041">Video encoder <b>20</b> and video decoder <b>30</b> each may be implemented as any of a variety of suitable encoder circuitry, such as circuitry having one or more processors, microprocessors, digital signal processors (DSPs), application specific integrated circuits (ASICs), field programmable gate arrays (FPGAs), discrete logic, software, hardware, firmware or any combinations thereof. When the techniques are implemented partially in software, a device may store instructions for the software in a suitable, non-transitory computer-readable medium and execute the instructions in hardware using one or more processors to perform the techniques of this disclosure. Each of video encoder <b>20</b> and video decoder <b>30</b> may be included in one or more encoders or decoders, either of which may be integrated as part of a combined encoder/decoder (CODEC) in a respective device.</div>
<div class="description-paragraph" id="p-0043" num="0042">In general, the working model of the HM describes that a video frame or picture may be divided into a sequence of treeblocks or largest coding units (LCU) that include both luma and chroma samples. A treeblock has a similar purpose as a macroblock of the H.264 standard. A slice includes a number of consecutive treeblocks in coding order. A video frame or picture may be partitioned into one or more slices. Each treeblock may be split into coding units (CUs) according to a quadtree. For example, a treeblock, as a root node of the quadtree, may be split into four child nodes, and each child node may in turn be a parent node and be split into another four child nodes. A final, unsplit child node, as a leaf node of the quadtree, comprises a coding node, i.e., a coded video block. Syntax data associated with a coded bitstream may define a maximum number of times a treeblock may be split, and may also define a minimum size of the coding nodes.</div>
<div class="description-paragraph" id="p-0044" num="0043">In one example approach, a CU may include a luma coding block and two chroma coding blocks. In another example approach, a CU may include a luma coding block, a Co coding block and a Cg coding block in an YCoCg color space. In another example approach, a CU may include a red coding block, a green coding block and a blue coding block in an RGB color space.</div>
<div class="description-paragraph" id="p-0045" num="0044">In one example approach, the CU may have associated prediction units (PUs) and transform units (TUs). Each of the PUs may include one luma prediction block and two chroma prediction blocks, and each of the TUs may include one luma transform block and two chroma transform blocks. Each of the coding blocks may be partitioned into one or more prediction blocks that comprise blocks to samples to which the same prediction applies. Each of the coding blocks may also be partitioned in one or more transform blocks that comprise blocks of sample on which the same transform is applied.</div>
<div class="description-paragraph" id="p-0046" num="0045">A size of the CU generally corresponds to a size of the coding node and is typically square in shape. The size of the CU may range from 8×8 pixels up to the size of the treeblock with a maximum of 64×64 pixels or greater. Each CU may define one or more PUs and one or more TUs. Syntax data included in a CU may describe, for example, partitioning of the coding block into one or more prediction blocks. Partitioning modes may differ between whether the CU is skip or direct mode encoded, intra-prediction mode encoded, or inter-prediction mode encoded. Prediction blocks may be partitioned to be square or non-square in shape. Syntax data included in a CU may also describe, for example, partitioning of the coding block into one or more transform blocks according to a quadtree. Transform blocks may be partitioned to be square or non-square in shape.</div>
<div class="description-paragraph" id="p-0047" num="0046">The HEVC standard allows for transformations according to TUs, which may be different for different CUs. The TUs are typically sized based on the size of PUs within a given CU defined for a partitioned LCU, although this may not always be the case. The TUs are typically the same size or smaller than the PUs. In some examples, residual samples corresponding to a CU may be subdivided into smaller units using a quadtree structure known as “residual quad tree” (RQT). The leaf nodes of the RQT may represent the TUs. Pixel difference values associated with the TUs may be transformed to produce transform coefficients, which may be quantized.</div>
<div class="description-paragraph" id="p-0048" num="0047">In general, a PU includes data related to the prediction process. For example, when the PU is intra-mode encoded, the PU may include data describing an intra-prediction mode for the PU. As another example, when the PU is inter-mode encoded, the PU may include data defining a motion vector for the PU. The data defining the motion vector for a PU may describe, for example, a horizontal component of the motion vector, a vertical component of the motion vector, a resolution for the motion vector (e.g., one-quarter pixel precision or one-eighth pixel precision), a reference picture to which the motion vector points, and/or a reference picture list (e.g., List <b>0</b>, List <b>1</b>, or List C) for the motion vector.</div>
<div class="description-paragraph" id="p-0049" num="0048">In general, a TU is used for the transform and quantization processes. A given CU having one or more PUs may also include one or more TUs. Following prediction, video encoder <b>20</b> may calculate residual values from the video block identified by the coding node in accordance with the PU. The coding node is then updated to reference the residual values rather than the original video block. The residual values comprise pixel difference values that may be transformed into transform coefficients, quantized, and scanned using the transforms and other transform information specified in the TUs to produce serialized transform coefficients for entropy coding. The coding node may once again be updated to refer to these serialized transform coefficients. This disclosure typically uses the term “video block” to refer to a coding node of a CU. In some specific cases, this disclosure may also use the term “video block” to refer to a treeblock, i.e., LCU, or a CU, which includes a coding node and PUs and TUs.</div>
<div class="description-paragraph" id="p-0050" num="0049">A video sequence typically includes a series of video frames or pictures. A group of pictures (GOP) generally comprises a series of one or more of the video pictures. A GOP may include syntax data in a header of the GOP, a header of one or more of the pictures, or elsewhere, that describes a number of pictures included in the GOP. Each slice of a picture may include slice syntax data that describes an encoding mode for the respective slice. Video encoder <b>20</b> typically operates on video blocks within individual video slices in order to encode the video data. A video block may correspond to a coding node within a CU. The video blocks may have fixed or varying sizes, and may differ in size according to a specified coding standard.</div>
<div class="description-paragraph" id="p-0051" num="0050">As an example, the HM supports prediction in various PU sizes. Assuming that the size of a particular CU is 2N×2N, the HM supports intra-prediction in PU sizes of 2N×2N or N×N, and inter-prediction in symmetric PU sizes of 2N×2N, 2N×N, N×2N, or N×N. The HM also supports asymmetric partitioning for inter-prediction in PU sizes of 2N×nU, 2N×nD, nL×2N, and nR×2N. In asymmetric partitioning, one direction of a CU is not partitioned, while the other direction is partitioned into 25% and 75%. The portion of the CU corresponding to the 25% partition is indicated by an “n” followed by an indication of “Up”, “Down,” “Left,” or “Right.” Thus, for example, “2N×nU” refers to a 2N×2N CU that is partitioned horizontally with a 2N×0.5N PU on top and a 2N×1.5N PU on bottom.</div>
<div class="description-paragraph" id="p-0052" num="0051">In this disclosure, “N×N” and “N by N” may be used interchangeably to refer to the pixel dimensions of a video block in terms of vertical and horizontal dimensions, e.g., 16×16 pixels or 16 by 16 pixels. In general, a 16×16 block will have 16 pixels in a vertical direction (y=16) and 16 pixels in a horizontal direction (x=16). Likewise, an N×N block generally has N pixels in a vertical direction and N pixels in a horizontal direction, where N represents a nonnegative integer value. The pixels in a block may be arranged in rows and columns. Moreover, blocks need not necessarily have the same number of pixels in the horizontal direction as in the vertical direction. For example, blocks may comprise N×M pixels, where M is not necessarily equal to N.</div>
<div class="description-paragraph" id="p-0053" num="0052">Following intra-predictive or inter-predictive coding using the PUs of a CU, video encoder <b>20</b> may calculate residual data to which the transforms specified by TUs of the CU are applied. The residual data may correspond to pixel differences between pixels of the unencoded picture and prediction values corresponding to the CUs. Video encoder <b>20</b> may form the residual data for the CU, and then transform the residual data to produce transform coefficients.</div>
<div class="description-paragraph" id="p-0054" num="0053">Following any transforms to produce transform coefficients, video encoder <b>20</b> may perform quantization of the transform coefficients. Quantization generally refers to a process in which transform coefficients are quantized to possibly reduce the amount of data used to represent the coefficients, providing further compression. The quantization process may reduce the bit depth associated with some or all of the coefficients. For example, an n-bit value may be rounded down to an m-bit value during quantization, where n is greater than m.</div>
<div class="description-paragraph" id="p-0055" num="0054">In some examples, video encoder <b>20</b> may utilize a predefined scan order to scan the quantized transform coefficients to produce a serialized vector that can be entropy encoded. In other examples, video encoder <b>20</b> may perform an adaptive scan. After scanning the quantized transform coefficients to form a one-dimensional vector, video encoder <b>20</b> may entropy encode the one-dimensional vector, e.g., according to context adaptive variable length coding (CAVLC), context adaptive binary arithmetic coding (CABAC), syntax-based context-adaptive binary arithmetic coding (SBAC), Probability Interval Partitioning Entropy (PIPE) coding or another entropy encoding methodology. Video encoder <b>20</b> may also entropy encode syntax elements associated with the encoded video data for use by video decoder <b>30</b> in decoding the video data.</div>
<div class="description-paragraph" id="p-0056" num="0055">To perform CABAC, video encoder <b>20</b> may assign a context within a context model to a symbol to be transmitted. The context may relate to, for example, whether neighboring values of the symbol are non-zero or not. To perform CAVLC, video encoder <b>20</b> may select a variable length code for a symbol to be transmitted. Codewords in VLC may be constructed such that relatively shorter codes correspond to more probable symbols, while longer codes correspond to less probable symbols. In this way, the use of VLC may achieve a bit savings over, for example, using equal-length codewords for each symbol to be transmitted. The probability determination may be based on a context assigned to the symbol.</div>
<div class="description-paragraph" id="p-0057" num="0056"> <figref idrefs="DRAWINGS">FIG. 2</figref> is a block diagram illustrating an example of a video encoder that may be configured or otherwise operable to implement or otherwise utilize one or more techniques described in this disclosure. Video encoder <b>20</b> may perform intra- and inter-coding of video blocks within video slices. Intra-coding relies on spatial prediction to reduce or remove spatial redundancy in video within a given video frame or picture. Inter-coding relies on temporal prediction to reduce or remove temporal redundancy in video within adjacent frames or pictures of a video sequence. Intra-mode (I mode) may refer to any of several spatial based coding modes. Inter-modes, such as uni-directional prediction (P mode) or bi-prediction (B mode), may refer to any of several temporal-based coding modes.</div>
<div class="description-paragraph" id="p-0058" num="0057">As shown in <figref idrefs="DRAWINGS">FIG. 2</figref>, video encoder <b>20</b> receives a current video block within a video frame to be encoded. In the example of <figref idrefs="DRAWINGS">FIG. 2</figref>, video encoder <b>20</b> includes video data memory <b>38</b>, prediction processing unit <b>40</b>, reference picture memory <b>64</b>, summer <b>50</b>, transform processing unit <b>52</b>, quantization unit <b>54</b>, and entropy encoding unit <b>56</b>. Prediction processing unit <b>40</b>, in turn, includes motion compensation unit <b>44</b>, motion estimation unit <b>42</b>, and intra-prediction unit <b>46</b>, and partition unit <b>48</b>. For video block reconstruction, video encoder <b>20</b> also includes inverse quantization unit <b>58</b>, inverse transform unit <b>60</b>, and summer <b>62</b>. A deblocking filter (not shown in <figref idrefs="DRAWINGS">FIG. 2</figref>) may also be included to filter block boundaries to remove blockiness artifacts from reconstructed video. If desired, the deblocking filter would typically filter the output of summer <b>62</b>. Additional filters (in loop or post loop) may also be used in addition to the deblocking filter. Such filters are not shown for brevity, but if desired, may filter the output of summer <b>62</b> (as an in-loop filter).</div>
<div class="description-paragraph" id="p-0059" num="0058">During the encoding process, video encoder <b>20</b> receives a video frame or slice to be coded and stores it to video data memory <b>38</b>. The frame or slice may be divided into multiple video blocks by prediction processing unit <b>40</b>. Motion estimation unit <b>42</b> and motion compensation unit <b>44</b> perform inter-predictive coding of the received video block relative to one or more blocks in one or more reference frames to provide temporal prediction. Intra-prediction unit <b>46</b> may alternatively perform intra-predictive coding of the received video block relative to one or more neighboring blocks in the same frame or slice as the block to be coded to provide spatial prediction. Video encoder <b>20</b> may perform multiple coding passes, e.g., to select an appropriate coding mode for each block of video data.</div>
<div class="description-paragraph" id="p-0060" num="0059">Moreover, partition unit <b>48</b> may partition blocks of video data into sub-blocks, based on evaluation of previous partitioning schemes in previous coding passes. For example, partition unit <b>48</b> may initially partition a frame or slice into LCUs, and partition each of the LCUs into sub-CUs based on rate-distortion analysis (e.g., rate-distortion optimization). Prediction processing unit <b>40</b> may further produce a quadtree data structure indicative of partitioning of an LCU into sub-CUs. Leaf-node CUs of the quadtree may include one or more PUs and one or more TUs.</div>
<div class="description-paragraph" id="p-0061" num="0060">Prediction processing unit <b>40</b> may select one of the coding modes, intra or inter, e.g., based on error results, and provides the resulting intra- or inter-coded block to summer <b>50</b> to generate residual block data and to summer <b>62</b> to reconstruct the encoded block for use as a reference frame. Prediction processing unit <b>40</b> also provides syntax elements, such as motion vectors, intra-mode indicators, partition information, and other such syntax information, to entropy encoding unit <b>56</b>. Prediction processing unit <b>40</b> may select one or more inter-modes using rate-distortion analysis.</div>
<div class="description-paragraph" id="p-0062" num="0061">Motion estimation unit <b>42</b> and motion compensation unit <b>44</b> may be highly integrated, but are illustrated separately for conceptual purposes. Motion estimation, performed by motion estimation unit <b>42</b>, is the process of generating motion vectors, which estimate motion for video blocks. A motion vector, for example, may indicate the displacement of a PU of a video block within a current video frame or picture relative to a predictive block within a reference frame (or other coded unit) relative to the current block being coded within the current frame (or other coded unit). A predictive block is a block that is found to closely match the block to be coded, in terms of pixel difference, which may be determined by sum of absolute difference (SAD), sum of square difference (SSD), or other difference metrics. In some examples, video encoder <b>20</b> may calculate values for sub-integer pixel positions of reference pictures stored in reference picture memory <b>64</b>. For example, video encoder <b>20</b> may interpolate values of one-quarter pixel positions, one-eighth pixel positions, or other fractional pixel positions of the reference picture. Therefore, motion estimation unit <b>42</b> may perform a motion search relative to the full pixel positions and fractional pixel positions and output a motion vector with fractional pixel precision.</div>
<div class="description-paragraph" id="p-0063" num="0062">Motion estimation unit <b>42</b> calculates a motion vector for a PU of a video block in an inter-coded slice by comparing the position of the PU to the position of a predictive block of a reference picture. The reference picture may be selected from a first reference picture list (List <b>0</b>) or a second reference picture list (List <b>1</b>), each of which identify one or more reference pictures stored in reference picture memory <b>64</b>. Motion estimation unit <b>42</b> sends the calculated motion vector to entropy encoding unit <b>56</b> and motion compensation unit <b>44</b>.</div>
<div class="description-paragraph" id="p-0064" num="0063">Motion compensation, performed by motion compensation unit <b>44</b>, may involve fetching or generating the predictive block based on the motion vector determined by motion estimation unit <b>42</b>. Again, motion estimation unit <b>42</b> and motion compensation unit <b>44</b> may be functionally integrated, in some examples. Upon receiving the motion vector for the PU of the current video block, motion compensation unit <b>44</b> may locate the predictive block to which the motion vector points in one of the reference picture lists. Summer <b>50</b> forms a residual video block by subtracting pixel values of the predictive block from the pixel values of the current video block being coded, forming pixel difference values, as discussed below. In general, motion estimation unit <b>42</b> performs motion estimation relative to luma coding blocks, and motion compensation unit <b>44</b> uses motion vectors calculated based on the luma coding blocks for both chroma coding blocks and luma coding blocks. Prediction processing unit <b>40</b> may also generate syntax elements associated with the video blocks and the video slice for use by video decoder <b>30</b> in decoding the video blocks of the video slice.</div>
<div class="description-paragraph" id="p-0065" num="0064">Intra-prediction unit <b>46</b> may intra-predict a current block, as an alternative to the inter-prediction performed by motion estimation unit <b>42</b> and motion compensation unit <b>44</b>, as described above. In particular, intra-prediction unit <b>46</b> may determine an intra-prediction mode to use to encode a current block. In some examples, intra-prediction unit <b>46</b> may encode a current block using various intra-prediction modes, e.g., during separate encoding passes, and intra-prediction unit <b>46</b> (or prediction processing unit <b>40</b>, in some examples) may select an appropriate intra-prediction mode to use from the tested modes.</div>
<div class="description-paragraph" id="p-0066" num="0065">For example, intra-prediction unit <b>46</b> may calculate rate-distortion values using a rate-distortion analysis for the various tested intra-prediction modes, and select the intra-prediction mode having the best rate-distortion characteristics among the tested modes. Rate-distortion analysis generally determines an amount of distortion (or error) between an encoded block and an original, unencoded block that was encoded to produce the encoded block, as well as a bit rate (that is, a number of bits) used to produce the encoded block. Intra-prediction unit <b>46</b> may calculate ratios from the distortions and rates for the various encoded blocks to determine which intra-prediction mode exhibits the best rate-distortion value for the block.</div>
<div class="description-paragraph" id="p-0067" num="0066">After selecting an intra-prediction mode for a block, intra-prediction unit <b>46</b> may provide information indicative of the selected intra-prediction mode for the block to entropy encoding unit <b>56</b>. Entropy encoding unit <b>56</b> may encode the information indicating the selected intra-prediction mode. Video encoder <b>20</b> may include in the transmitted bitstream configuration data, which may include a plurality of intra-prediction mode index tables and a plurality of modified intra-prediction mode index tables (also referred to as codeword mapping tables), definitions of encoding contexts for various blocks, and indications of a most probable intra-prediction mode, an intra-prediction mode index table, and a modified intra-prediction mode index table to use for each of the contexts.</div>
<div class="description-paragraph" id="p-0068" num="0067">Video encoder <b>20</b> forms a residual video block by subtracting the prediction data from mode select unit <b>40</b> from the original video block being coded. Summer <b>50</b> represents the component or components that perform this subtraction operation. Transform processing unit <b>52</b> applies a transform, such as a discrete cosine transform (DCT) or a conceptually similar transform, to the residual block, producing a video block comprising residual transform coefficient values. Transform processing unit <b>52</b> may perform other transforms which are conceptually similar to DCT. Wavelet transforms, integer transforms, sub-band transforms or other types of transforms could also be used. In any case, transform processing unit <b>52</b> applies the transform to the residual block, producing a block of residual transform coefficients. The transform may convert the residual information from a pixel value domain to a transform domain, such as a frequency domain. Transform processing unit <b>52</b> may send the resulting transform coefficients to quantization unit <b>54</b>. Quantization unit <b>54</b> quantizes the transform coefficients to further reduce bit rate. The quantization process may reduce the bit depth associated with some or all of the coefficients. The degree of quantization may be modified by adjusting a quantization parameter. In some examples, quantization unit <b>54</b> may then perform a scan of the matrix including the quantized transform coefficients. Alternatively, entropy encoding unit <b>56</b> may perform the scan.</div>
<div class="description-paragraph" id="p-0069" num="0068">Following quantization, entropy encoding unit <b>56</b> entropy codes the quantized transform coefficients. For example, entropy encoding unit <b>56</b> may perform context adaptive variable length coding (CAVLC), context adaptive binary arithmetic coding (CABAC), syntax-based context-adaptive binary arithmetic coding (SBAC), probability interval partitioning entropy (PIPE) coding or another entropy coding technique. In the case of context-based entropy coding, context may be based on neighboring blocks. Following the entropy coding by entropy encoding unit <b>56</b>, the encoded bitstream may be transmitted to another device (e.g., video decoder <b>30</b>) or archived for later transmission or retrieval.</div>
<div class="description-paragraph" id="p-0070" num="0069">Inverse quantization unit <b>58</b> and inverse transform unit <b>60</b> apply inverse quantization and inverse transformation, respectively, to reconstruct the residual block in the pixel domain, e.g., for later use as a reference block. Motion compensation unit <b>44</b> may calculate a reference block by adding the residual block to a predictive block of one of the frames of reference picture memory <b>64</b>. Motion compensation unit <b>44</b> may also apply one or more interpolation filters to the reconstructed residual block to calculate sub-integer pixel values for use in motion estimation. Summer <b>62</b> adds the reconstructed residual block to the motion compensated prediction block produced by motion compensation unit <b>44</b> to produce a reconstructed video block for storage in reference picture memory <b>64</b>. The reconstructed video block may be used by motion estimation unit <b>42</b> and motion compensation unit <b>44</b> as a reference block to inter-code a block in a subsequent video frame.</div>
<div class="description-paragraph" id="p-0071" num="0070"> <figref idrefs="DRAWINGS">FIG. 3</figref> is a block diagram illustrating an example of a video decoder that may be configured or otherwise operable to implement or otherwise utilize one or more techniques described in this disclosure. In the example of <figref idrefs="DRAWINGS">FIG. 3</figref>, video decoder <b>30</b> includes video data memory <b>68</b>, an entropy decoding unit <b>70</b>, motion compensation unit <b>72</b>, intra prediction unit <b>74</b>, inverse quantization unit <b>76</b>, inverse transform unit <b>78</b>, summer <b>80</b>, and reference picture memory <b>82</b>. In the example of <figref idrefs="DRAWINGS">FIG. 3</figref>, video decoder <b>30</b> includes prediction unit <b>71</b>, which, in turn, includes motion compensation unit <b>72</b> and intra prediction unit <b>74</b>. Video decoder <b>30</b> may, in some examples, perform a decoding pass generally reciprocal to the encoding pass described with respect to video encoder <b>20</b> (<figref idrefs="DRAWINGS">FIG. 2</figref>). Motion compensation unit <b>72</b> may generate prediction data based on motion vectors received from entropy decoding unit <b>70</b>, while intra prediction unit <b>74</b> may generate prediction data based on intra-prediction mode indicators received from entropy decoding unit <b>70</b>.</div>
<div class="description-paragraph" id="p-0072" num="0071">During the decoding process, video data memory <b>68</b> of video decoder <b>30</b> receives an encoded video bitstream and stores the encoded video bitstream to video data memory <b>68</b>. The encoded video bitstream represents video blocks of an encoded video slice and associated syntax elements transmitted from video encoder <b>20</b>. Entropy decoding unit <b>70</b> entropy decodes the bitstream to generate quantized coefficients, motion vectors or intra-prediction mode indicators, and other syntax elements. Entropy decoding unit <b>70</b> forwards the motion vectors and other syntax elements to motion compensation unit <b>72</b>. Video decoder <b>30</b> may receive the syntax elements at the video slice level and/or the video block level.</div>
<div class="description-paragraph" id="p-0073" num="0072">When the video slice is coded as an intra-coded (I) slice, intra prediction unit <b>74</b> may generate prediction data for a video block of the current video slice based on a signaled intra prediction mode and data from previously decoded blocks of the current frame or picture. When the video frame is coded as an inter-coded (i.e., B, P or GPB frames) slice, motion compensation unit <b>72</b> produces predictive blocks for a video block of the current video slice based on the motion vectors and other syntax elements received from entropy decoding unit <b>70</b>. Predicted slices (P slices) and Generalized P and B slices (GPB slices) may use data from previous frames to define the slice, while a Bidirectional predicted slice (B slice) may use both previous and forward frames to define the slice. In some example approaches, the predictive blocks may be produced from one of the reference pictures within one of the reference picture lists. Video decoder <b>30</b> may construct the reference frame lists, List <b>0</b> and List <b>1</b>, using default construction techniques based on reference pictures stored in reference picture memory <b>82</b>.</div>
<div class="description-paragraph" id="p-0074" num="0073">Motion compensation unit <b>72</b> determines prediction information for a video block of the current video slice by parsing the motion vectors and other syntax elements, and uses the prediction information to produce the predictive blocks for the current video block being decoded. For example, motion compensation unit <b>72</b> uses some of the received syntax elements to determine a prediction mode (e.g., intra- or inter-prediction) used to code the video blocks of the video slice, an inter-prediction slice type (e.g., B slice, P slice, or GPB slice), construction information for one or more of the reference picture lists for the slice, motion vectors for each inter-encoded video block of the slice, inter-prediction status for each inter-coded video block of the slice, and other information to decode the video blocks in the current video slice.</div>
<div class="description-paragraph" id="p-0075" num="0074">Motion compensation unit <b>72</b> may also perform interpolation based on interpolation filters. Motion compensation unit <b>72</b> may use interpolation filters as used by video encoder <b>20</b> during encoding of the video blocks to calculate interpolated values for sub-integer pixels of reference blocks. In this case, motion compensation unit <b>72</b> may determine the interpolation filters used by video encoder <b>20</b> from the received syntax elements and use the interpolation filters to produce predictive blocks.</div>
<div class="description-paragraph" id="p-0076" num="0075">Inverse quantization unit <b>76</b> inverse quantizes, i.e., de quantizes, the quantized transform coefficients provided in the bitstream and decoded by entropy decoding unit <b>70</b>. The inverse quantization process may include use of a quantization parameter QPY calculated by video decoder <b>30</b> for each video block in the video slice to determine a degree of quantization and, likewise, a degree of inverse quantization that should be applied.</div>
<div class="description-paragraph" id="p-0077" num="0076">Inverse transform unit <b>78</b> applies an inverse transform, e.g., an inverse DCT, an inverse integer transform, or a conceptually similar inverse transform process, to the transform coefficients in order to produce residual blocks in the pixel domain.</div>
<div class="description-paragraph" id="p-0078" num="0077">After motion compensation unit <b>72</b> generates the predictive block for the current video block based on the motion vectors and other syntax elements, video decoder <b>30</b> forms a decoded video block by summing the residual blocks from inverse transform unit <b>78</b> with the corresponding predictive blocks generated by motion compensation unit <b>72</b>. Summer <b>80</b> represents the component or components that perform this summation operation. If desired, a deblocking filter may also be applied to filter the decoded blocks in order to remove blockiness artifacts. Other loop filters (either in the coding loop or after the coding loop) may also be used to smooth pixel transitions, or otherwise improve the video quality. The decoded video blocks in a given frame or picture are then stored in reference picture memory <b>82</b>, which stores reference pictures used for subsequent motion compensation. Reference picture memory <b>82</b> also stores decoded video for later presentation on a display device, such as display device <b>32</b> of <figref idrefs="DRAWINGS">FIG. 1</figref>.</div>
<div class="description-paragraph" id="p-0079" num="0078">Adaptive cross component residual prediction will be discussed next.</div>
<div class="description-paragraph" id="p-0080" num="0079">Although cross component redundancy is significantly reduced in YCbCr color space, correlation between the three color components may still exist. Various methods have been studied to improve the video coding performance by further reducing the correlation, especially for 4:4:4 chroma format video coding. In one approach, a scale factor and offset are used for each block to predict the chroma signal from the reconstructed luma signal. (See B. C. Song, Y. G. Lee, and N. H. Kim, “Block adaptive inter-color compensation algorithm for RGB 4:4:4 video coding,” IEEE Trans. Circuits Syst. Video Technol., vol. 18, no. 10, pp. 1447-1451, October 2008. LM proposal.)</div>
<div class="description-paragraph" id="p-0081" num="0080">In another approach, a technique called Cross Component Prediction (CCP) is performed in the residual domain. (See, W. Pu, W.-S. Kim, J. Chen, J. Sole, M. Karczewicz, “RCE1: Descriptions and Results for Experiments 1, 2, 3, and 4”, Joint Collaborative Team on Video Coding (JCT-VC) of ITU-T SG16 WP3 and ISO/IEC JTC1/SC29/WG11, JCTVC-00202, Gevena, November 2013.) In CCP, the chroma residual signal is predicted using the reconstructed luma residual signal at the encoder side as
<br/>
Δ<i>r</i> <sub>C</sub>(<i>x,y</i>)=<i>r</i> <sub>C</sub>(<i>x,y</i>)−(α×<i>r′</i> <sub>L</sub>(<i>x,y</i>))&gt;&gt;3  (1)
<br/>
and it is compensated at the decoder side as
<br/>
<i>r′</i> <sub>C</sub>(<i>x,y</i>)=Δ<i>r′</i> <sub>C</sub>(<i>x,y</i>)+(α<i>×r′</i> <sub>L</sub>(<i>x,y</i>))&gt;&gt;3  (2)
<br/>
where r<sub>C</sub>(x,y) and r′<sub>C</sub>(x,y) denote the original and reconstructed chroma residual samples at a position (x,y). In CCP, Δr<sub>C</sub>(x,y) and Δr′<sub>C</sub>(x,y) denote the final chroma residual samples after cross component prediction, while r′<sub>L</sub>(x,y) represents the reconstructed luma residual sample value. In some examples, the weighting factor α is explicitly signaled into the bit stream for each chroma transform unit in HEVC. This cross component residual prediction method was adopted in the Format and Range Extension of HEVC standard for 4:4:4 chroma sampling format video coding, performed for both the intra predicted residual and the inter predicted residual. The CCP method was also proposed but has not yet been adopted for 4:2:0 video format coding.
</div>
<div class="description-paragraph" id="p-0082" num="0081">In addition to using luma to predict chroma components, it is possible to use one of the chroma components to predict the other chroma component. That is, in some example approaches, the reconstructed early-coded Cb residual may be used to predict the Cr residual. (See, A. Khairat, T. Nguyen, M. Siekmann, D. Marpe, “Non-RCE1: Extended Adaptive Inter-Component Prediction”, Joint Collaborative Team on Video Coding (JCT-VC) of ITU-T SG16 WP3 and ISO/IEC JTC1/SC29/WG11, JCTVC-O0150, Gevena, November 2013.)</div>
<div class="description-paragraph" id="p-0083" num="0082">In 4:2:0 chroma video coding, a method named Linear Model (LM) prediction mode was well studied during development of the HEVC standard. (See J. Chen, V. Seregi, W.-J. Han, J.-S. Kim, B.-M. Joen. “CE6.a.4: Chroma intra prediction by reconstructed luma samples”, Joint Collaborative Team on Video Coding (JCT-VC) of ITU-T SG16 WP3 and ISO/IEC JTC1/SC29/WG11, JCTVC-E266, Geneva, 16-23 March 2011.) With LM prediction mode, the chroma samples are predicted based on reconstructed luma samples of the same block by using a linear model as follows:
<br/>
pred<sub>C</sub>(<i>i,j</i>)=α·rec<sub>L</sub>(<i>i,j</i>)+β  (3)
<br/>
where pred<sub>C</sub>(i, j) represents the prediction of chroma samples in a block and rec<sub>L</sub>(i, j) represents the downsampled reconstructed luma samples of the same block. Parameters α and β are derived by minimizing regression error between the neighboring reconstructed luma and chroma samples around the current block.
</div>
<div class="description-paragraph" id="p-0084" num="0083">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
<mtr>
<mtd>
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>,</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</mtd>
<mtd>
<mrow>
<mo>(</mo>
<mn>4</mn>
<mo>)</mo>
</mrow>
</mtd>
</mtr>
</mtable>
</math>
</maths>
</div>
<div class="description-paragraph" id="p-0085" num="0084">The parameters α and β are solved as follows:</div>
<div class="description-paragraph" id="p-0086" num="0085"> <maths id="MATH-US-00002" num="00002"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mrow> <mi>α</mi> <mo>=</mo> <mfrac> <mrow> <mrow> <mi>N</mi> <mo>⁢</mo> <mrow> <mo>∑</mo> <mrow> <msub> <mi>x</mi> <mi>i</mi> </msub> <mo>·</mo> <msub> <mi>y</mi> <mi>i</mi> </msub> </mrow> </mrow> </mrow> <mo>-</mo> <mrow> <mo>∑</mo> <mrow> <msub> <mi>x</mi> <mi>i</mi> </msub> <mo>·</mo> <msub> <mi>y</mi> <mi>i</mi> </msub> </mrow> </mrow> </mrow> <mrow> <mrow> <mi>N</mi> <mo>⁢</mo> <mrow> <mo>∑</mo> <mrow> <msub> <mi>x</mi> <mi>i</mi> </msub> <mo>·</mo> <msub> <mi>x</mi> <mi>i</mi> </msub> </mrow> </mrow> </mrow> <mo>-</mo> <mrow> <mo>∑</mo> <mrow> <msub> <mi>x</mi> <mi>i</mi> </msub> <mo>·</mo> <mrow> <mo>∑</mo> <msub> <mi>x</mi> <mi>i</mi> </msub> </mrow> </mrow> </mrow> </mrow> </mfrac> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>5</mn> <mo>)</mo> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mi>β</mi> <mo>=</mo> <mrow> <mrow> <mo>(</mo> <mrow> <mrow> <mo>∑</mo> <msub> <mi>y</mi> <mi>i</mi> </msub> </mrow> <mo>-</mo> <mrow> <mi>α</mi> <mo>·</mo> <mrow> <mo>∑</mo> <msub> <mi>x</mi> <mi>i</mi> </msub> </mrow> </mrow> </mrow> <mo>)</mo> </mrow> <mo>⁢</mo> <mstyle> <mtext>/</mtext> </mstyle> <mo>⁢</mo> <mi>N</mi> </mrow> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>6</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> <br/>
where x<sub>i </sub>is a downsampled reconstructed Luma reference sample, y<sub>i </sub>is a reconstructed Chroma reference sample, and N is the number of the reference samples.
</div>
<div class="description-paragraph" id="p-0087" num="0086">A problem with LM prediction mode is that, in LM prediction mode, the reconstructed luma samples are used to predict chroma components. This introduces additional encoding/decoding delays into chroma coding. Such delay may significantly increase the implementation cost, especially for hardware implementation. Another drawback of LM mode is that it is not easy to be used in inter prediction mode.</div>
<div class="description-paragraph" id="p-0088" num="0087">A problem with the Cross Component Prediction (CCP) method is that the coding gain is limited due to the block-level signaling cost of the weighting factors (or any other parameters for the linear model).</div>
<div class="description-paragraph" id="p-0089" num="0088">In cross component residual prediction, weighting factors are derived in both encoder <b>20</b> and decoder <b>30</b> based on the spatial or temporal neighboring reconstructed samples. The residual could be, while not limited to, the intra and inter predicted residual, and can be the residual of any kind of prediction method. There is no need to transfer linear block parameters as in CCP.</div>
<div class="description-paragraph" id="p-0090" num="0089">Methods of defining the weighting factors are discussed next. They may be applied individually, or in any combination.</div>
<div class="description-paragraph" id="p-0091" num="0090">In general, a linear model can be designed to minimize the prediction error between two sets of signals X and Y, wherein X is denoted as the prediction signal and Y is denoted as the target signal during the optimization:</div>
<div class="description-paragraph" id="p-0092" num="0091"> <maths id="MATH-US-00003" num="00003"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mrow> <mrow> <mi>Min</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>E</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>α</mi> <mo>,</mo> <mi>β</mi> </mrow> <mo>)</mo> </mrow> </mrow> <mo>)</mo> </mrow> </mrow> <mo>,</mo> <mrow> <mrow> <mi>where</mi> <mo>⁢</mo> <mstyle> <mspace height="0.8ex" width="0.8em"> </mspace> </mstyle> <mo>⁢</mo> <mrow> <mi>E</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>α</mi> <mo>,</mo> <mi>β</mi> </mrow> <mo>)</mo> </mrow> </mrow> </mrow> <mo>=</mo> <mrow> <munder> <mo>∑</mo> <mi>i</mi> </munder> <mo>⁢</mo> <msup> <mrow> <mo>(</mo> <mrow> <msub> <mi>y</mi> <mi>i</mi> </msub> <mo>-</mo> <mrow> <mo>(</mo> <mrow> <mrow> <mi>α</mi> <mo>·</mo> <msub> <mi>x</mi> <mi>i</mi> </msub> </mrow> <mo>+</mo> <mi>β</mi> </mrow> <mo>)</mo> </mrow> </mrow> <mo>)</mo> </mrow> <mn>2</mn> </msup> </mrow> </mrow> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>7</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> <br/>
one or more weighting factors α and/or β, are applied to inter or intra predicted residuals of one color component to predict another color component. In one example approach, one or more of the linear model parameters (e.g., weighting factor α or offset β derived from the linear model above apply to the inter or intra predicted residuals of one color component (e.g., luma component) to predict another color component (e.g., Cb and/or Cr component). Such a model can also be applied to other components in the decoding order (e.g., Cb to Cr). In addition, the decoding order of the components may be intermediately switched and the cross component prediction technique still applies.
</div>
<div class="description-paragraph" id="p-0093" num="0092"> <figref idrefs="DRAWINGS">FIG. 4</figref> is a flowchart illustrating an example of the encoding of video data, in accordance with one aspect of this disclosure. In the example approach of <figref idrefs="DRAWINGS">FIG. 4</figref>, video encoder <b>20</b> determines the predicted residual signal of a target color component (<b>100</b>). In one such example approach, encoder <b>20</b> determines the predicted residual signal of the target color component of a current block as a function of one or more parameters of a linear model and of a residual signal of a source color component of the current block. Video encoder <b>20</b> determines a remaining residual signal of the target color component (<b>102</b>). In one such approach, encoder <b>20</b> determines the remaining residual signal of the target color component by subtracting the predicted residual signal of the target color component from the residual signal of the target color component. Encoder <b>20</b> encodes the remaining residual signal of the target color component and the residual signal of the source color component (<b>104</b>) before outputting the encoded signals in the video bitstream (<b>106</b>).</div>
<div class="description-paragraph" id="p-0094" num="0093">In one example approach, the linear model predicts a predicted residual signal of a target color component from the residual signal of a source color component based on parameters of the linear model. Both encoder <b>20</b> and decoder <b>30</b> maintain the linear model parameters of the linear model in memory and apply them as discussed below. In one example approach, encoder <b>20</b> and decoder <b>30</b> calculate the linear model parameters as a function of reference blocks. In one such example approach, default parameter values are maintained in memory for use when calculating the parameter values is not appropriate.</div>
<div class="description-paragraph" id="p-0095" num="0094"> <figref idrefs="DRAWINGS">FIG. 5</figref> is a flowchart illustrating a more detailed example of the encoding of video data, in accordance with one aspect of this disclosure. In the example approach of <figref idrefs="DRAWINGS">FIG. 5</figref>, video encoder <b>20</b> determines the predicted residual signal of a chroma color component (<b>120</b>). In one such example approach, encoder <b>20</b> determines the predicted residual signal of the target color component of a current block as a function of one or more parameters of a linear model and of a residual signal of a source color component of the current block. In one example approach, the linear model parameters include a weighting factor α and an offset β. Encoder <b>20</b> uses the linear model to predict a predicted residual signal of the chroma color component Cr as a function of a residual signal of the luma color component. Encoder <b>20</b> determines a remaining residual signal for the chroma color component Cr (<b>122</b>), encodes the remaining residual signal with the residual signal of the luma color component (<b>124</b>) and outputs the encoded remaining residual signal of the chroma color component Cr with the encoded residual signal of the luma component in the video bitstream.</div>
<div class="description-paragraph" id="p-0096" num="0095">Decoding of the encoded residuals of the color component prediction signal will be discussed next. <figref idrefs="DRAWINGS">FIG. 6</figref> is a flowchart illustrating the prediction of the residual signal of a first color component from the residual signal of a second color component, in accordance with one aspect of this disclosure. In one example approach a video decoder <b>30</b> receives the encoded residual signal of a source color component and the encoded remaining residual signal of the target color component, stores the encoded residual signals in memory of the video decoder <b>30</b> and decodes the encoded residual values. Video decoder <b>30</b> predicts a predicted residual signal of a target color component of the current block based on the decoded residual signal of the source color component of the current block (<b>140</b>). Decoder <b>30</b> then determines a residual signal for the target color component as a function of the predicted residual signal for the target color component and of the decoded remaining residual signal for the target color component (<b>142</b>).</div>
<div class="description-paragraph" id="p-0097" num="0096"> <figref idrefs="DRAWINGS">FIG. 7</figref> is a flowchart illustrating the prediction of the residual signal of a Cb color component from the residual signal of a Cr color component, in accordance with one aspect of this disclosure. In one example approach, a video decoder <b>30</b> receives the encoded residual signal of the Cr color component and the remaining residual signal of the Cb color component, stores the encoded residual signals in memory of the video decoder <b>30</b> and decodes the encoded residual signals. Video decoder <b>30</b> determines the predicted residual signal of the Cb color component of the current block based on the decoded residual signal of the Cr color component and the parameters of the linear model (e.g., weighting factor α and an offset β) (<b>160</b>). Decoder <b>30</b> then determines a residual signal for the Cb color component as a function of the predicted residual signal for the Cb color component and of the decoded remaining residual signal for the Cb color component (<b>162</b>).</div>
<div class="description-paragraph" id="p-0098" num="0097">In one example approach, default values of the parameters of the linear model are used when predicting the residual signal of the target color component. In another example approach, values of one or more of the parameters are derived from sample signals as will be detailed below. In one such example approach, derived values of the linear model parameters are stored in memory of video encoder <b>20</b> and video decoder <b>30</b> and are used as default values until changed.</div>
<div class="description-paragraph" id="p-0099" num="0098">Methods of deriving parameters of the linear model are discussed for inter prediction and intra prediction below.</div>
<div class="description-paragraph" id="p-0100" num="0099"> <figref idrefs="DRAWINGS">FIG. 8</figref> is a flowchart illustrating the derivation of parameters of a linear model based on inter prediction, in accordance with one aspect of this disclosure. In the example approach of <figref idrefs="DRAWINGS">FIG. 8</figref>, a video encoder <b>20</b> selects a reference inter predicted source color component X (<b>200</b>) and a corresponding reference inter predicted target color component Y (<b>202</b>). Video encoder <b>20</b> calculates one or more weighting factors in the linear model as a function of the source color component X and the target color component Y (<b>204</b>), wherein the weighting factors are calculated to minimize prediction error as shown in equation (7) above. In one such example approach, video encoder <b>20</b> predicts values of a target color component Y as a function of the calculated weighting factors and of values of a source color component X.</div>
<div class="description-paragraph" id="p-0101" num="0100">In one example, the linear model is simplified by setting β equal to 0 or to any default value. In another example, the linear model may be simplified by setting α equal to 1 or to any default value.</div>
<div class="description-paragraph" id="p-0102" num="0101">In one example approach, temporal neighboring samples (e. g. motion compensated prediction samples) are used as reference samples to derive the linear model parameters α and/or β. In one such example, the prediction signal X is the motion compensated signal belonging to one component (e.g., the motion compensated luma component, also known as the luma component of the reference block) and the target signal Y is the motion compensated signal belonging to another component (e.g., the motion compensated Cb component also known as the Cb component of the reference block).</div>
<div class="description-paragraph" id="p-0103" num="0102">In one example approach, the prediction signal X is the residual signal of the reference block for one component (e.g., luma component) and the target signal Y is the residual signal of the reference block for another component (e.g., Cb and/or Cr component). In one such case, the residual of the reference block is calculated on the fly based on, e.g., the motion of the reference or a scaled motion vector based on the motion vector of the current block.</div>
<div class="description-paragraph" id="p-0104" num="0103">In one example approach, encoder <b>20</b> stores a residual picture of the reference picture and derives the residual of the reference block from the stored residual picture of the reference picture. In one such example, the residual block is located based on the motion vector of the current block. In another such example, the residual block is additionally set to the residual block that closely (e.g., in 4×4 grids) overlaps with the reference block.</div>
<div class="description-paragraph" id="p-0105" num="0104">In one example approach, encoder <b>20</b> applies interpolation when generating the residual block based on the motion vector of the current block. In one such example, interpolation is via a bi-linear filter.</div>
<div class="description-paragraph" id="p-0106" num="0105">In one example approach, encoder <b>20</b> uses reconstructed spatial (e. g. top and/or left) neighboring samples (as in Intra LM) as reference samples to derive the linear model parameters α and/or β. In one such example, prediction signal X includes the reconstructed values of one component of the neighboring samples (e.g., luma component) and target signal Y includes the reconstructed values of another component of the neighboring samples (e.g., Cb and/or Cr, or Co and/or Cg).</div>
<div class="description-paragraph" id="p-0107" num="0106">In one example approach, encoder <b>20</b> uses both spatial and temporal neighboring samples to derive α and/or β. That is, the prediction signal X is a selective composition from the X signal derived from a temporal reference block (as described above) and the X signal from the spatial neighboring samples (as described above). Meanwhile the target signal Y is a (corresponding) selective composition from the Y signal derived from a temporal reference block (as described above) and the Y signal from the spatial neighboring samples (as described above).</div>
<div class="description-paragraph" id="p-0108" num="0107">In some example approaches, encoder <b>20</b> selects between spatial neighboring samples and temporal neighboring samples when choosing reference samples used to derive the linear model parameters. In one such example, encoder <b>20</b> chooses between using either spatial neighboring samples or temporal neighboring samples as a function of current block size, or based on other statistics corresponding to the current block or one or more of the neighboring blocks. Representative statistics include pixel values, auto correlation of single color component samples, and cross correlation between two color component samples.</div>
<div class="description-paragraph" id="p-0109" num="0108">In some example approaches, source device <b>12</b> signals side information over link <b>16</b> or through storage device <b>31</b>. Side information (could be a flag) may be signaled, for example, at Sequence Parameter Set (SPS), Picture Parameter Set (PPS), slice header, LCU, group of LCU level, or any other block level or high level syntax body to indicate the samples X and Y to be used for deriving the weighting factors.</div>
<div class="description-paragraph" id="p-0110" num="0109">In some example approaches, the linear model parameters α and/or β are derived by minimizing regression error between the reference luma and chroma samples as done in LM prediction mode.</div>
<div class="description-paragraph" id="p-0111" num="0110">In some cross component prediction of intra predicted residual examples, the spatial (e. g. top and/or left) neighboring reconstructed samples may be used as reference samples to derive the linear model parameters.</div>
<div class="description-paragraph" id="p-0112" num="0111"> <figref idrefs="DRAWINGS">FIG. 9</figref> is a flowchart illustrating an example cross component prediction of intra predicted residuals, in accordance with one aspect of this disclosure. In the example approach of <figref idrefs="DRAWINGS">FIG. 9</figref>, one or more weighting factors α and/or β are applied to an intra predicted residual signal of one color component to predict another color component. In one example approach, an encoder <b>20</b> applies one or more of the weighting factors α and β derived from the linear model of equation (7) to the intra predicted residual signal of one color component (e.g., luma component) to determine the predicted residual signal of another color component (e.g., Cb and/or Cr component). As noted in the inter prediction mode discussion above, such a model can also be applied to other components in the decoding order (e.g., Cb to Cr). In addition, the decoding order of the components may be intermediately switched and the cross component prediction technique still applies. The predicted residual signal of a color component can then be combined with the remaining residual signal of the same color component to arrive at the residual signal of the color component.</div>
<div class="description-paragraph" id="p-0113" num="0112">In the approach of <figref idrefs="DRAWINGS">FIG. 9</figref>, a video encoder <b>20</b> selects an intra predicted color component X (<b>300</b>). In one example approach, video encoder <b>20</b> uses the reconstructed samples from the left neighbor as source color component X. In another example approach, video encoder <b>20</b> uses the reconstructed samples from the top neighbor as source color component X. In yet another example approach, video encoder <b>20</b> calculates a source color component X as a function of the reconstructed samples from each of the top and left neighbors.</div>
<div class="description-paragraph" id="p-0114" num="0113">Video encoder <b>20</b> selects a corresponding intra predicted target color component Y (<b>302</b>). Video encoder <b>20</b> calculates one or more weighting factors as a function of the reference source color component X and the reference target color component Y (<b>304</b>), wherein the weighting factors are calculated to minimize prediction error as shown in equation (7) above. Video encoder <b>20</b> then predicts values of a target color component Y as a function of the calculated linear model parameters and values of source color component X.</div>
<div class="description-paragraph" id="p-0115" num="0114">In one example, the linear model may be simplified by setting β equal to 0 or to any default value. In another example, the linear model is simplified by setting α equal to 1 or to any default value.</div>
<div class="description-paragraph" id="h-0006" num="0000">Accounting for Noise or Quantized Error</div>
<div class="description-paragraph" id="p-0116" num="0115">In cross component residual prediction, when the linear model is solved based on the spatial or temporal neighboring reconstructed samples, the linear model parameters value may be suboptimal due to the noise/quantized error of the reference samples or due to the dissimilarity between current block samples and reference samples. To improve the performance of cross component residual prediction, in some examples, a constraint is included so that the optimization problem is subject to the constraint that α is expected to be close to a default value. Similarly, a constraint may be included so that the optimization problem is subject to the constraint that α is expected to be close to some other default value. In some example approaches, by biasing the calculation of α to one or more constraints, video encoder <b>20</b> improves the performance of the cross component residual prediction.</div>
<div class="description-paragraph" id="p-0117" num="0116">In some example approaches, video encoder <b>20</b> uses a pre-defined weighting factor α as a constraint in determining a. In one such example approach, the pre-defined weighting factor α is a function of the color components involved in the residual prediction. In some example approaches, for instance, video encoder <b>20</b> uses a pre-defined default weighting factor of −0.5 when predicting a Cr residual using a Cr residual. In some example approaches, video encoder <b>20</b> uses a pre-defined default weighting factor of 0 when predicting a chroma residual using the luma residual. In some such example approaches, pre-defined default weighting factors of α vary by color component and color space.</div>
<div class="description-paragraph" id="p-0118" num="0117">In one example approach, video encoder <b>20</b> adaptively modifies the default value of α as needed. For instance, video encoder <b>20</b> may signal a default value of α as −0.5 when predicting a Cr residual using a Cr residual based on values of a determined experimentally for the YCbCr space but then modify the default value based on the content of the video bitstream. In one example approach, such changes may occur and be signaled at a high level so that video encoder <b>20</b> and video decoder <b>30</b> can adapt to changes in the video stream.</div>
<div class="description-paragraph" id="p-0119" num="0118">In some example approaches, source device <b>12</b> signals the default weighting factor α value and/or the β offset value in the bitstream. In various example approaches, default values of weighting factors are signaled in SPS, PPS, slice header or any other places as high level syntax. In some examples, default weighting factor values are signaled at CU, LCU, group of LUC or other block level.</div>
<div class="description-paragraph" id="p-0120" num="0119">In some example approaches, when a default value is not signaled, pre-defined values are used. In some such example approaches, a different default value may be used for the different color spaces. In some example approaches a default parameter value is used only for certain color spaces.</div>
<div class="description-paragraph" id="p-0121" num="0120">In some example approaches, the default weighting factor α value and/or offset value are updated using the previously on-the-fly derived α value and/or β offset value for block sizes larger than a pre-defined threshold, which are generally more tolerant of noise/quantization error. In some such examples, a threshold of block size of 16×16, 32×32 or larger is used.</div>
<div class="description-paragraph" id="p-0122" num="0121">In some example approaches, a constraint on the variation of weighting α value and/or β offset value is included so that the difference between the currently derived α value and/or β offset value and neighboring derived α value and/or β offset values is less than a pre-defined threshold value or ratio.</div>
<div class="description-paragraph" id="p-0123" num="0122">In some examples, encoder <b>20</b> includes a selection mechanism which determines whether a dedicated default value is taken into account for the derivation of a weighting factor. In some such examples, the selection depends on the context of the current block. For example, the default weighting factor α value may be taken into account when deriving the weighting factor when cross component prediction is applied between two chroma components, while it may not be considered when a chroma component is predicted from a luma component. In some examples, the default weighting factor α value may be taken into account when deriving the weighting factor derivation when the block size is above or below a threshold size, or based on other features of the current block.</div>
<div class="description-paragraph" id="p-0124" num="0123">In one example approach, a dedicated default value may be taken into account when deriving the weighting factor and may depend on the context of the current block. In one example approach, a regression cost relative to the default a value is added to the error function as follows:</div>
<div class="description-paragraph" id="p-0125" num="0124"> <maths id="MATH-US-00004" num="00004"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mrow> <mrow> <mi>E</mi> <mo>⁡</mo> <mrow> <mo>(</mo> <mrow> <mi>α</mi> <mo>,</mo> <mi>β</mi> </mrow> <mo>)</mo> </mrow> </mrow> <mo>=</mo> <mrow> <mrow> <munder> <mo>∑</mo> <mi>i</mi> </munder> <mo>⁢</mo> <msup> <mrow> <mo>(</mo> <mrow> <msub> <mi>y</mi> <mi>i</mi> </msub> <mo>-</mo> <mrow> <mo>(</mo> <mrow> <mrow> <mi>α</mi> <mo>·</mo> <msub> <mi>x</mi> <mi>i</mi> </msub> </mrow> <mo>+</mo> <mi>β</mi> </mrow> <mo>)</mo> </mrow> </mrow> <mo>)</mo> </mrow> <mn>2</mn> </msup> </mrow> <mo>+</mo> <mrow> <mi>λ</mi> <mo>·</mo> <msup> <mrow> <mo>(</mo> <mrow> <mi>α</mi> <mo>-</mo> <msub> <mi>α</mi> <mi>default</mi> </msub> </mrow> <mo>)</mo> </mrow> <mn>2</mn> </msup> </mrow> </mrow> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>8</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> <br/>
And the optimal α is solved as:
</div>
<div class="description-paragraph" id="p-0126" num="0125"> <maths id="MATH-US-00005" num="00005"> <math overflow="scroll"> <mtable> <mtr> <mtd> <mrow> <mi>α</mi> <mo>=</mo> <mfrac> <mrow> <mrow> <mi>N</mi> <mo>⁢</mo> <mrow> <mo>∑</mo> <mrow> <msub> <mi>x</mi> <mi>i</mi> </msub> <mo>·</mo> <msub> <mi>y</mi> <mi>i</mi> </msub> </mrow> </mrow> </mrow> <mo>-</mo> <mrow> <mo>∑</mo> <mrow> <msub> <mi>x</mi> <mi>i</mi> </msub> <mo>·</mo> <msub> <mi>y</mi> <mi>i</mi> </msub> </mrow> </mrow> <mo>+</mo> <mrow> <msub> <mi>α</mi> <mi>default</mi> </msub> <mo>·</mo> <mi>λ</mi> </mrow> </mrow> <mrow> <mrow> <mi>N</mi> <mo>⁢</mo> <mrow> <mo>∑</mo> <mrow> <msub> <mi>x</mi> <mi>i</mi> </msub> <mo>·</mo> <msub> <mi>x</mi> <mi>i</mi> </msub> </mrow> </mrow> </mrow> <mo>-</mo> <mrow> <mo>∑</mo> <mrow> <msub> <mi>x</mi> <mi>i</mi> </msub> <mo>·</mo> <mrow> <mo>∑</mo> <msub> <mi>x</mi> <mi>i</mi> </msub> </mrow> </mrow> </mrow> <mo>+</mo> <mi>λ</mi> </mrow> </mfrac> </mrow> </mtd> <mtd> <mrow> <mo>(</mo> <mn>9</mn> <mo>)</mo> </mrow> </mtd> </mtr> </mtable> </math> </maths> <br/>
Based on equation (9), the derived α value should stay close to the default value.
</div>
<div class="description-paragraph" id="p-0127" num="0126">The value of λ determines how large the impact of the default value α<sub>default </sub>has on the finally derived α value. The default value α<sub>default </sub>has more impact when a larger λ value is used. The value of λ may be pre-defined for both encoder and decoder, otherwise the value of λ may be signaled in the bitstream. In an example approach, the value of λ may be set equal to (Σx<sub>i</sub>·x<sub>i</sub>)&gt;&gt;k, where k is a pre-defined fixed value (e.g. 7, 8 or 9). In another example approach, the value of λ may change based on context. For example, the value of λ may vary based on a feature of the current block (e.g., block size, whether spatial or temporal reference samples are used, etc.).</div>
<div class="description-paragraph" id="p-0128" num="0127">This process also may be used while deriving the α value and/or β offset value in the LM prediction mode described above, where reconstructed samples of one component (e.g. luma or Cb) are used to predict the sample of another component (e.g. Cb or Cr) with a linear model.</div>
<div class="description-paragraph" id="p-0129" num="0128">In some example approaches, encoder <b>20</b> reduces the complexity of the parameter derivation process in cross component residual prediction by downsampling or subsampling the reference samples (e.g., spatial or temporal neighboring reconstructed samples) before using the downsampled or subsampled reference samples to derive the parameters α and β. In some examples, encoder <b>20</b> determines when and if downsampling or subsampling is applied to reference samples. In some such examples, the decision whether to downsample or subsample, depends on the context of the current block and/or reference samples, such as the size of the current block, whether the reference sample is from temporal neighbors or spatial neighbors, or on other features of the current block or the reference samples.</div>
<div class="description-paragraph" id="p-0130" num="0129">In some such example approaches, encoder <b>20</b> varies the downsampling or sub sampling ratio as a function of the size of the current block. In some example approaches, a higher downsampling/subsampling ratio is applied when a larger block is processed.</div>
<div class="description-paragraph" id="p-0131" num="0130">In some example approaches, the downsampling/subsampling ratio differs according to whether the reference samples are spatial neighboring samples or temporal neighboring samples. In one such example approach, a relatively higher downsampling/subsampling ratio may be applied to temporal reference samples, and a relatively smaller downsampling/subsampling ratio (or no downsampling/subsampling ratio) may be applied to spatial reference samples.</div>
<div class="description-paragraph" id="p-0132" num="0131">This downsampling/subsampling method may also be applied to the LM prediction mode, where reconstructed samples of one component (e.g. luma or Cb) are used to predict, using a linear model, the sample of another component (e.g. Cb or Cr).</div>
<div class="description-paragraph" id="p-0133" num="0132">It is to be recognized that depending on the example, certain acts or events of any of the techniques described herein can be performed in a different sequence, may be added, merged, or left out altogether (e.g., not all described acts or events are necessary for the practice of the techniques). Moreover, in certain examples, acts or events may be performed concurrently, e.g., through multi-threaded processing, interrupt processing, or multiple processors, rather than sequentially.</div>
<div class="description-paragraph" id="p-0134" num="0133">In one or more examples, the functions described may be implemented in hardware, software, firmware, or any combination thereof. If implemented in software, the functions may be stored on or transmitted over as one or more instructions or code on a computer-readable medium and executed by a hardware-based processing unit. Computer-readable media may include computer-readable storage media, which corresponds to a tangible medium such as data storage media, or communication media including any medium that facilitates transfer of a computer program from one place to another, e.g., according to a communication protocol. In this manner, computer-readable media generally may correspond to (1) tangible computer-readable storage media which is non-transitory or (2) a communication medium such as a signal or carrier wave. Data storage media may be any available media that can be accessed by one or more computers or one or more processors to retrieve instructions, code and/or data structures for implementation of the techniques described in this disclosure. A computer program product may include a computer-readable medium. As used herein, the term ‘signaling’ may include storing or otherwise including data with an encoded bitstream. In other words, in various examples in accordance with this disclosure, the term ‘signaling’ may be associated with real-time communication of data, or alternatively, communication that is not performed in real-time.</div>
<div class="description-paragraph" id="p-0135" num="0134">By way of example, and not limitation, such computer-readable storage media can comprise RAM, ROM, EEPROM, CD-ROM or other optical disk storage, magnetic disk storage, or other magnetic storage devices, flash memory, or any other medium that can be used to store desired program code in the form of instructions or data structures and that can be accessed by a computer. Also, any connection is properly termed a computer-readable medium. For example, if instructions are transmitted from a website, server, or other remote source using a coaxial cable, fiber optic cable, twisted pair, digital subscriber line (DSL), or wireless technologies such as infrared, radio, and microwave, then the coaxial cable, fiber optic cable, twisted pair, DSL, or wireless technologies such as infrared, radio, and microwave are included in the definition of medium. It should be understood, however, that computer-readable storage media and data storage media do not include connections, carrier waves, signals, or other transitory media, but are instead directed to non-transitory, tangible storage media. Disk and disc, as used herein, includes compact disc (CD), laser disc, optical disc, digital versatile disc (DVD), floppy disk and Blu-ray disc, where disks usually reproduce data magnetically, while discs reproduce data optically with lasers. Combinations of the above should also be included within the scope of computer-readable media.</div>
<div class="description-paragraph" id="p-0136" num="0135">Instructions may be executed by one or more processors, such as one or more digital signal processors (DSPs), general purpose microprocessors, application specific integrated circuits (ASICs), field programmable logic arrays (FPGAs), or other equivalent integrated or discrete logic circuitry. Accordingly, the term “processor,” as used herein may refer to any of the foregoing structure or any other structure suitable for implementation of the techniques described herein. In addition, in some aspects, the functionality described herein may be provided within dedicated hardware and/or software modules configured for encoding and decoding, or incorporated in a combined codec. Also, the techniques could be fully implemented in one or more circuits or logic elements.</div>
<div class="description-paragraph" id="p-0137" num="0136">The techniques of this disclosure may be implemented in a wide variety of devices or apparatuses, including a wireless handset, an integrated circuit (IC) or a set of ICs (e.g., a chip set). Various components, modules, or units are described in this disclosure to emphasize functional aspects of devices configured to perform the disclosed techniques, but do not necessarily require realization by different hardware units. Rather, as described above, various units may be combined in a codec hardware unit or provided by a collection of interoperative hardware units, including one or more processors as described above, in conjunction with suitable software and/or firmware.</div>
<div class="description-paragraph" id="p-0138" num="0137">Various examples have been described. These and other examples are within the scope of the following claims.</div>
</div>
</div>
</section><section itemprop="claims" itemscope="">
<h2>Claims (<span itemprop="count">77</span>)</h2>
<div html="" itemprop="content"><div class="claims" lang="EN" load-source="patent-office" mxw-id="PCLM131468968">
<claim-statement>The invention claimed is:</claim-statement>
<div class="claim"> <div class="claim" id="CLM-00001" num="00001">
<div class="claim-text">1. A method of encoding video data, the method comprising:
<div class="claim-text">using, within an encoder, a linear model to determine, based on a residual signal of a source color component of a current block of the video data, a predicted residual signal of a target color component of the current block, wherein the linear model is based on one or more parameters;</div>
<div class="claim-text">determining, within the encoder, a remaining residual signal for the target color component based on a residual signal of the target color component and the predicted residual signal of the target color component;</div>
<div class="claim-text">encoding values of the remaining residual signal of the target color component; and</div>
<div class="claim-text">outputting the encoded remaining residual signal values in a video bitstream.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00002" num="00002">
<div class="claim-text">2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising retrieving default parameter values corresponding to the one or more parameters of the linear model.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00003" num="00003">
<div class="claim-text">3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the one or more parameters of the linear model include a weighting factor and an offset and the linear model is defined by a color component type of the source color component, wherein retrieving default parameter values corresponding to the one or more parameters of the linear model includes retrieving a first default parameter value when using the linear model to determine the predicted residual signal of the target color component based on the color component type of a first source color component and retrieving a second default parameter value when using the linear model to determine the predicted residual signal of the target color component based on the color component type of a second source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00004" num="00004">
<div class="claim-text">4. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the one or more parameters of the linear model include a weighting factor and an offset and the linear model is defined by a color component type of the source color component, wherein one color component type is luma and another color component type is chroma, wherein the source color component is one of a luma color component type or a first chroma color component type and wherein the target color component is a second chroma color component type,
<div class="claim-text">wherein retrieving default parameter values corresponding to the one or more parameters of the linear model includes:
<div class="claim-text">retrieving a first default weighting factor when predicting a residual signal of a first chroma color component using a residual signal of a luma color component, and</div>
<div class="claim-text">retrieving a second default weighting factor, different from the first default weighting factor, when predicting the residual signal of the first chroma color component using a residual signal of second chroma color component.</div>
</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00005" num="00005">
<div class="claim-text">5. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the second default weighing factor is −0.5.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00006" num="00006">
<div class="claim-text">6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising determining the one or more parameters of the linear model, wherein determining the one or more parameters of the linear model includes:
<div class="claim-text">determining a prediction error as a function of reference sample values of a reference target color component and reference sample values of a reference source color component; and</div>
<div class="claim-text">selecting values of the one or more parameters of the linear model that minimize the prediction error.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00007" num="00007">
<div class="claim-text">7. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting a weighting factor α and an offset β that minimize E(α,β), where</div>
<div class="claim-text">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>,</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00008" num="00008">
<div class="claim-text">8. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting a weighting factor α that minimizes E(α), where</div>
<div class="claim-text">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mi>α</mi>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00009" num="00009">
<div class="claim-text">9. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting an offset β that minimizes E(β), where</div>
<div class="claim-text">
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mi>β</mi>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00010" num="00010">
<div class="claim-text">10. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting a predefined parameter value based on a color component type of the target color component and a color component type of the source color component and deriving a linear model parameter of the one or more parameters of the linear model by constraining the linear model parameter to be close to the selected pre-defined parameter value.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00011" num="00011">
<div class="claim-text">11. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes deriving a linear model parameter of the one or more parameters of the linear model, wherein deriving the linear model parameter includes constraining the linear model parameter to be close to a pre-defined parameter value and limiting variation between the linear model parameter and linear model parameters of one or more temporal or spatial neighboring blocks.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00012" num="00012">
<div class="claim-text">12. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes:
<div class="claim-text">determining if the source color component is a first color component type, and</div>
<div class="claim-text">deriving a linear model parameter of the one or more parameters of the linear model by constraining the linear model parameter to be close to a pre-defined parameter value when the source color component is the first color component type.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00013" num="00013">
<div class="claim-text">13. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes deriving a linear model parameter of the one or more parameters of the linear model by constraining the linear model parameter to be close to a pre-defined parameter value.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00014" num="00014">
<div class="claim-text">14. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein deriving the linear model parameter includes replacing the pre-defined parameter value with the linear model parameter.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00015" num="00015">
<div class="claim-text">15. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein deriving the linear model parameter includes replacing the pre-defined parameter value with the linear model parameter if a block size is greater than a pre-defined threshold block size.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00016" num="00016">
<div class="claim-text">16. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes deriving a weighting factor α and an offset β that minimize E(α,β), where</div>
<div class="claim-text">
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>,</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
<mo>+</mo>
<mrow>
<mi>λ</mi>
<mo>·</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>-</mo>
<msub>
<mi>α</mi>
<mi>default</mi>
</msub>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where α<sub>default </sub>is a default value of α, where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00017" num="00017">
<div class="claim-text">17. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the reference target color component and the reference source color component are the first and second color components, respectively, of a temporal neighboring or collocated reference block of the current block.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00018" num="00018">
<div class="claim-text">18. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the reference sample values of the reference target color component and the reference sample values of the reference source color component are residual signals corresponding to a first and a second color component, respectively, of a temporal neighboring or collocated reference block of the current block.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00019" num="00019">
<div class="claim-text">19. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the reference sample values of the reference target color component and the reference sample values of the reference source color component are first and second color components, respectively, of reconstructed spatial neighboring samples.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00020" num="00020">
<div class="claim-text">20. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the reference sample values of the reference target color component and the reference sample values of the reference source color component include spatial and temporal neighboring sample values corresponding to a first color component and a second color component, respectively, of the current block.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00021" num="00021">
<div class="claim-text">21. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the reference target color component and the reference source color component are selected from a plurality of samples including spatial neighboring samples and temporal neighboring samples of the current block, and wherein the samples selected are selected as a function of a statistic associated with a current block or a neighboring block.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00022" num="00022">
<div class="claim-text">22. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising determining the one or more parameters of the linear model, wherein determining the one or more parameters of the linear model includes:
<div class="claim-text">determining a prediction error as a function of downsampled or subsampled reference sample values of a reference target color component and downsampled or subsampled reference sample values of a reference source color component; and</div>
<div class="claim-text">selecting values of the one or more parameters of the linear model that minimize the prediction error.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00023" num="00023">
<div class="claim-text">23. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the reference target color component and the reference source color component are selected from a plurality of samples including spatial neighboring samples and temporal neighboring samples of the current block, wherein downsampling is defined by a downsampling ratio, wherein the downsampling ratio used for temporal neighboring samples is different than the downsampling ratio used for spatial neighboring samples.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00024" num="00024">
<div class="claim-text">24. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the reference target color component and the reference source color component are selected from a plurality of samples including spatial neighboring samples and temporal neighboring samples of the current block, wherein subsampling is defined by a subsampling ratio, wherein the subsampling ratio used for temporal neighboring samples is different than the subsampling ratio used for spatial neighboring samples.</div>
</div>
</div> <div class="claim"> <div class="claim" id="CLM-00025" num="00025">
<div class="claim-text">25. A device for encoding video data, the device comprising:
<div class="claim-text">a memory configured to store the video data; and</div>
<div class="claim-text">one or more processors configured to:
<div class="claim-text">use a linear model to determine, based on a residual signal of a source color component of a current block of the video data, a predicted residual signal of a target color component of the current block, wherein the linear model is based on one or more parameters;</div>
<div class="claim-text">determine a remaining residual signal for the target color component based on a residual signal of the target color component and the predicted residual signal of the target color component;</div>
<div class="claim-text">encode values of the remaining residual signal of the target color component; and</div>
<div class="claim-text">output the encoded remaining residual signal values in a video bitstream.</div>
</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00026" num="00026">
<div class="claim-text">26. The device of <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the one or more processors are configured to determine the one or more parameters of the linear model, wherein determining the one or more parameters of the linear model includes:
<div class="claim-text">determining a prediction error as a function of reference sample values of a reference target color component and reference sample values of a reference source color component; and</div>
<div class="claim-text">selecting values of the one or more parameters of the linear model that minimize the prediction error.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00027" num="00027">
<div class="claim-text">27. The device of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting a weighting factor α and an offset β that minimize E(α,β), where</div>
<div class="claim-text">
<maths id="MATH-US-00010" num="00010">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>,</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00028" num="00028">
<div class="claim-text">28. The device of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting a weighting factor α that minimizes E(α), where</div>
<div class="claim-text">
<maths id="MATH-US-00011" num="00011">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mi>α</mi>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00029" num="00029">
<div class="claim-text">29. The device of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting an offset β that minimizes E(β), where</div>
<div class="claim-text">
<maths id="MATH-US-00012" num="00012">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mi>β</mi>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00030" num="00030">
<div class="claim-text">30. The device of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting a predefined parameter value based on a color component type of the target color component and on a color component type of the source color component and deriving a linear model parameter of the one or more parameters of the linear model by constraining the linear model parameter to be close to the selected pre-defined parameter value.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00031" num="00031">
<div class="claim-text">31. The device of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes deriving a linear model parameter of the one or more parameters of the linear model, wherein deriving the linear model parameter includes constraining the linear model parameter to be close to a pre-defined parameter value and limiting variation between the linear model parameter and linear model parameters of one or more temporal or spatial neighboring blocks.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00032" num="00032">
<div class="claim-text">32. The device of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes:
<div class="claim-text">determining if the source color component is of a first color component type, and</div>
<div class="claim-text">deriving a linear model parameter of the one or more parameters of the linear model by constraining the linear model parameter to be close to a pre-defined parameter value when the source color component is the first color component type.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00033" num="00033">
<div class="claim-text">33. The device of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes deriving a linear model parameter of the one or more parameters of the linear model by constraining the linear model parameter to be close to a pre-defined parameter value.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00034" num="00034">
<div class="claim-text">34. The device of <claim-ref idref="CLM-00033">claim 33</claim-ref>, wherein deriving the linear model parameter includes replacing the pre-defined parameter value with the linear model parameter.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00035" num="00035">
<div class="claim-text">35. The device of <claim-ref idref="CLM-00033">claim 33</claim-ref>, wherein deriving the linear model parameter includes replacing the pre-defined parameter value with the linear model parameter if a block size is greater than a pre-defined threshold block size.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00036" num="00036">
<div class="claim-text">36. The device of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes deriving a weighting factor α and an offset β that minimize E(α,β), where</div>
<div class="claim-text">
<maths id="MATH-US-00013" num="00013">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>,</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
<mo>+</mo>
<mrow>
<mi>λ</mi>
<mo>·</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>-</mo>
<msub>
<mi>α</mi>
<mi>default</mi>
</msub>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where α<sub>default </sub>is a default value of α, where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim"> <div class="claim" id="CLM-00037" num="00037">
<div class="claim-text">37. A device for encoding video data, the device comprising:
<div class="claim-text">means for using, within an encoder, a linear model to determine, based on a residual signal of a source color component of a current block of the video data a predicted residual signal of a target color component of the current block, wherein the linear model is based on one or more parameters;</div>
<div class="claim-text">means for determining, within the encoder, a remaining residual signal for the target color component based on a residual signal of the target color component and the predicted residual signal of the target color component;</div>
<div class="claim-text">means for encoding values of the remaining residual signal of the target color component; and</div>
<div class="claim-text">means for outputting the encoded remaining residual signal values in a video bitstream.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00038" num="00038">
<div class="claim-text">38. The device of <claim-ref idref="CLM-00037">claim 37</claim-ref>, further comprising means for determining the one or more parameters of the linear model, wherein the means for determining the one or more parameters of the linear model includes:
<div class="claim-text">means for determining a prediction error as a function of reference sample values of a reference target color component and reference sample values of a reference source color component; and</div>
<div class="claim-text">means for selecting values of the one or more parameters of the linear model that minimize the prediction error.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00039" num="00039">
<div class="claim-text">39. The device of <claim-ref idref="CLM-00038">claim 38</claim-ref>, wherein the means for selecting the values of the one or more parameters of the linear model includes means for deriving a weighting factor α and an offset β that minimize E(α,β), where</div>
<div class="claim-text">
<maths id="MATH-US-00014" num="00014">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>,</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00040" num="00040">
<div class="claim-text">40. The device of <claim-ref idref="CLM-00038">claim 38</claim-ref>, wherein the means for selecting the values of the one or more parameters of the linear model includes means for deriving a weighting factor α and an offset β that minimize E(α,β), where</div>
<div class="claim-text">
<maths id="MATH-US-00015" num="00015">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>,</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
<mo>+</mo>
<mrow>
<mi>λ</mi>
<mo>·</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>-</mo>
<msub>
<mi>α</mi>
<mi>default</mi>
</msub>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where α<sub>default </sub>is a default value of α, where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim"> <div class="claim" id="CLM-00041" num="00041">
<div class="claim-text">41. A non-transitory computer-readable storage medium having stored thereon instructions that, when executed, cause one or more processors of a device for encoding video data to:
<div class="claim-text">use a linear model to determine, based on a residual signal of a source color component of a current block of the video data, a predicted residual signal of a target color component of the current block, wherein the linear model is based on one or more parameters;</div>
<div class="claim-text">determine a remaining residual signal for the target color component based on a residual signal of the target color component and the predicted residual signal of the target color component;</div>
<div class="claim-text">encode values of the remaining residual signal of the target color component; and</div>
<div class="claim-text">output the encoded remaining residual signal values in a video bitstream.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00042" num="00042">
<div class="claim-text">42. The computer-readable storage medium of <claim-ref idref="CLM-00041">claim 41</claim-ref>, wherein the instructions that, when executed, cause the one or more processors to determine the one or more parameters of the linear model, cause the one or more processors to:
<div class="claim-text">determine a prediction error as a function of reference sample values of a reference target color component and reference sample values of a reference source color component; and</div>
<div class="claim-text">select values of the one or more parameters of the linear model that minimize the prediction error.</div>
</div>
</div>
</div> <div class="claim"> <div class="claim" id="CLM-00043" num="00043">
<div class="claim-text">43. A method of decoding video data, comprising:
<div class="claim-text">using a linear model to determine, based on a residual signal of a source color component of a current block of the video data, a predicted residual signal of a target color component of the current block, wherein the linear model is based on one or more parameters;</div>
<div class="claim-text">determining a residual signal of the target color component based on a decoded remaining residual signal of the target color component and the predicted residual signal of the target color component; and</div>
<div class="claim-text">reconstructing samples of the current block based on the residual signal of the target color component.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00044" num="00044">
<div class="claim-text">44. The method of <claim-ref idref="CLM-00043">claim 43</claim-ref>, further comprising: receiving a video bitstream and storing data representative of the remaining residual signal of the target color component and of the residual signal of the source color component in memory.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00045" num="00045">
<div class="claim-text">45. The method of <claim-ref idref="CLM-00043">claim 43</claim-ref>, further comprising: retrieving default parameter values corresponding to the one or more parameters of the linear model.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00046" num="00046">
<div class="claim-text">46. The method of <claim-ref idref="CLM-00045">claim 45</claim-ref>, wherein the one or more parameters of the linear model include a weighting factor and an offset and the linear model is defined by a color component type of the source color component, wherein retrieving the default parameter values corresponding to the one or more parameters of the linear model includes retrieving a first default parameter value when using the linear model to determine the predicted residual signal of the target color component based on a color component type of a first source color component and retrieving a second default parameter value when using the linear model to determine the predicted the residual signal of the target color component based on a color component type of a second source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00047" num="00047">
<div class="claim-text">47. The method of <claim-ref idref="CLM-00045">claim 45</claim-ref>, wherein the one or more parameters of the linear model include a weighting factor and an offset and the linear model is defined by a color component type of the source color component, wherein one color component type is luma and another color component type is chroma, wherein the source color component is one of a luma color component type and a chroma color component type and wherein the target color component is a chroma color component type,
<div class="claim-text">wherein retrieving the default parameter values corresponding to the one or more parameters of the linear model includes:
<div class="claim-text">retrieving a first default weighting factor when predicting a residual signal of a first chroma color component using a residual signal of a luma color component, and</div>
<div class="claim-text">retrieving a second default weighting factor, different from the first default weighting factor, when predicting a residual signal of the first chroma color component using a residual signal of a second chroma color component.</div>
</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00048" num="00048">
<div class="claim-text">48. The method of <claim-ref idref="CLM-00047">claim 47</claim-ref>, wherein the second default weighing factor is −0.5.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00049" num="00049">
<div class="claim-text">49. The method of <claim-ref idref="CLM-00045">claim 45</claim-ref>, further comprising determining the one or more parameters of the linear model, wherein determining the one or more parameters of the linear model includes:
<div class="claim-text">determining a prediction error as a function of reference sample values of a reference target color component and reference sample values of a reference source color component; and</div>
<div class="claim-text">selecting values of the one or more parameters of the linear model that minimize the prediction error.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00050" num="00050">
<div class="claim-text">50. The method of <claim-ref idref="CLM-00049">claim 49</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting a weighting factor α and an offset β that minimize E(α,β), where</div>
<div class="claim-text">
<maths id="MATH-US-00016" num="00016">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>,</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00051" num="00051">
<div class="claim-text">51. The method of <claim-ref idref="CLM-00049">claim 49</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting a weighting factor α that minimizes E(α), where</div>
<div class="claim-text">
<maths id="MATH-US-00017" num="00017">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mi>α</mi>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00052" num="00052">
<div class="claim-text">52. The method of <claim-ref idref="CLM-00049">claim 49</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting an offset β that minimizes E(β), where</div>
<div class="claim-text">
<maths id="MATH-US-00018" num="00018">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mi>β</mi>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00053" num="00053">
<div class="claim-text">53. The method of <claim-ref idref="CLM-00049">claim 49</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting a predefined parameter value based on a color component type of the target color component and a color component type of the source color component and deriving a linear model parameter of the one or more parameters of the linear model by constraining the linear model parameter to be close to the selected pre-defined parameter value.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00054" num="00054">
<div class="claim-text">54. The method of <claim-ref idref="CLM-00049">claim 49</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes deriving a linear model parameter of the one or more parameters of the linear model, and wherein deriving the linear model parameter includes constraining the linear model parameter to be close to a pre-defined parameter value and limiting variation between the linear model parameter and linear model parameters of one or more temporal or spatial neighboring blocks.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00055" num="00055">
<div class="claim-text">55. The method of <claim-ref idref="CLM-00049">claim 49</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes:
<div class="claim-text">determining if the source color component is a first color component type, and</div>
<div class="claim-text">deriving a linear model parameter of the one or more parameters of the linear model by constraining the linear model parameter to be close to a pre-defined parameter value when the source color component is the first color component type.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00056" num="00056">
<div class="claim-text">56. The method of <claim-ref idref="CLM-00049">claim 49</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes deriving a linear model parameter of the one or more parameters of the linear model by constraining the linear model parameter to be close to a pre-defined parameter value.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00057" num="00057">
<div class="claim-text">57. The method of <claim-ref idref="CLM-00056">claim 56</claim-ref>, wherein deriving the linear model parameter includes replacing the pre-defined parameter value with the linear model parameter.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00058" num="00058">
<div class="claim-text">58. The method of <claim-ref idref="CLM-00056">claim 56</claim-ref>, wherein deriving the linear model parameter includes replacing the pre-defined parameter value with the linear model parameter if a block size is greater than a pre-defined threshold block size.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00059" num="00059">
<div class="claim-text">59. The method of <claim-ref idref="CLM-00049">claim 49</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes deriving a weighting factor α and an offset β that minimize E(α,β), where</div>
<div class="claim-text">
<maths id="MATH-US-00019" num="00019">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>,</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
<mo>+</mo>
<mrow>
<mi>λ</mi>
<mo>·</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>-</mo>
<msub>
<mi>α</mi>
<mi>default</mi>
</msub>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where α<sub>default </sub>is a default value of α, where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00060" num="00060">
<div class="claim-text">60. The method of <claim-ref idref="CLM-00049">claim 49</claim-ref>, wherein the reference target color component and the reference source color component are the first and second color components, respectively, of a temporal neighboring or collocated reference block of the current block.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00061" num="00061">
<div class="claim-text">61. The method of <claim-ref idref="CLM-00049">claim 49</claim-ref>, wherein the reference sample values of the reference target color component and the reference sample values of the reference source color component are residual signals corresponding to a first color component and a second color component, respectively, of a temporal neighboring or collocated reference block of the current block.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00062" num="00062">
<div class="claim-text">62. The method of <claim-ref idref="CLM-00049">claim 49</claim-ref>, wherein the reference sample values of the reference target color component and the reference sample values of the reference source color component are first and second color components, respectively, of reconstructed spatial neighboring samples.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00063" num="00063">
<div class="claim-text">63. The method of <claim-ref idref="CLM-00049">claim 49</claim-ref>, wherein the reference sample values of the reference target color component and the reference sample values of the reference source color component include spatial and temporal neighboring sample values corresponding to a first color component and a second color component, respectively, of the current block.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00064" num="00064">
<div class="claim-text">64. The method of <claim-ref idref="CLM-00049">claim 49</claim-ref>, wherein the reference target color component and the reference source color component are selected from a plurality of samples including spatial neighboring samples and temporal neighboring samples of the current block, wherein the samples selected are selected as a function of a statistic associated with a current block or a neighboring block.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00065" num="00065">
<div class="claim-text">65. The method of <claim-ref idref="CLM-00043">claim 43</claim-ref>, further comprising determining the one or more parameters of the linear model, wherein determining the one or more parameters of the linear model includes:
<div class="claim-text">determining a prediction error as a function of downsampled or subsampled reference sample values of a reference target color component and downsampled or subsampled reference sample values of a reference source color component; and</div>
<div class="claim-text">selecting values of the one or more parameters of the linear model that minimize the prediction error.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00066" num="00066">
<div class="claim-text">66. The method of <claim-ref idref="CLM-00065">claim 65</claim-ref>, wherein the reference target color component and the reference source color component are selected from a plurality of samples including spatial neighboring samples and temporal neighboring samples of the current block, wherein downsampling is defined by a downsampling ratio, wherein the downsampling ratio used for temporal neighboring samples is different than the downsampling ratio used for spatial neighboring samples.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00067" num="00067">
<div class="claim-text">67. The method of <claim-ref idref="CLM-00065">claim 65</claim-ref>, wherein the reference target color component and the reference source color component are selected from a plurality of samples including spatial neighboring samples and temporal neighboring samples of the current block, wherein subsampling is defined by a subsampling ratio, wherein the subsampling ratio used for temporal neighboring samples is different than the subsampling ratio used for spatial neighboring samples.</div>
</div>
</div> <div class="claim"> <div class="claim" id="CLM-00068" num="00068">
<div class="claim-text">68. A device for decoding video data, the device comprising:
<div class="claim-text">a memory configured to store the video data; and</div>
<div class="claim-text">one or more processors configured to:
<div class="claim-text">use a linear model to determine, based on a residual signal of a source color component of a current block of the video data, a predicted residual signal of a target color component of the current block, wherein the linear model is based on one or more parameters; and</div>
<div class="claim-text">determine a residual signal of the target color component based on a decoded remaining residual signal of the target color component and the predicted residual signal of the target color component; and</div>
<div class="claim-text">reconstruct samples of the current block based on the residual signal of the target color component.</div>
</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00069" num="00069">
<div class="claim-text">69. The device of <claim-ref idref="CLM-00068">claim 68</claim-ref>, wherein the one or more processors are configured to determine the one or more parameters of the linear model, wherein determining the one or more parameters of the linear model includes:
<div class="claim-text">determining a prediction error as a function of reference sample values of a reference target color component and reference sample values of a reference source color component; and</div>
<div class="claim-text">selecting values of the one or more parameters of the linear model that minimize the prediction error.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00070" num="00070">
<div class="claim-text">70. The device of <claim-ref idref="CLM-00069">claim 69</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting a weighting factor α and an offset β that minimize E(α,β), where</div>
<div class="claim-text">
<maths id="MATH-US-00020" num="00020">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>,</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00071" num="00071">
<div class="claim-text">71. The device of <claim-ref idref="CLM-00069">claim 69</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting a weighting factor α that minimizes E(α), where</div>
<div class="claim-text">
<maths id="MATH-US-00021" num="00021">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mi>α</mi>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00072" num="00072">
<div class="claim-text">72. The device of <claim-ref idref="CLM-00069">claim 69</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes selecting an offset β that minimizes E(β), where</div>
<div class="claim-text">
<maths id="MATH-US-00022" num="00022">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mi>β</mi>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00073" num="00073">
<div class="claim-text">73. The device of <claim-ref idref="CLM-00069">claim 69</claim-ref>, wherein selecting the values of the one or more parameters of the linear model includes deriving a weighting factor α and an offset β that minimize E(α,β), where</div>
<div class="claim-text">
<maths id="MATH-US-00023" num="00023">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>,</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
<mo>+</mo>
<mrow>
<mi>λ</mi>
<mo>·</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>-</mo>
<msub>
<mi>α</mi>
<mi>default</mi>
</msub>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where α<sub>default </sub>is a default value of α, where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> <div class="claim"> <div class="claim" id="CLM-00074" num="00074">
<div class="claim-text">74. A device for decoding video data, the device comprising:
<div class="claim-text">means for using a linear model to determine, based on a residual signal of a source color component of a current block of the video data, a predicted residual signal of a target color component of the current block, wherein the linear model is based on one or more parameters;</div>
<div class="claim-text">means for determining a residual signal of the target color component based on a decoded remaining residual signal of the target color component and the predicted residual signal of the target color component; and</div>
<div class="claim-text">means for reconstructing samples of the current block based on the residual signal of the target color component.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00075" num="00075">
<div class="claim-text">75. The device of <claim-ref idref="CLM-00074">claim 74</claim-ref>, further comprising means for determining the one or more parameters of the linear model, wherein determining the one or more parameters of the linear model includes:
<div class="claim-text">determining a prediction error as a function of reference sample values of a reference target color component and reference sample values of a reference source color component; and</div>
<div class="claim-text">selecting values of the one or more parameters of the linear model that minimize the prediction error.</div>
</div>
</div>
</div> <div class="claim"> <div class="claim" id="CLM-00076" num="00076">
<div class="claim-text">76. A computer-readable storage medium having stored thereon instructions that, when executed, cause one or more processors of a device for decoding video data to:
<div class="claim-text">use a linear model to determine, based on a residual signal of a source color component of a current block of the video data, a predicted residual signal of a target color component of the current block, wherein the linear model is based on one or more parameters;</div>
<div class="claim-text">determine a residual signal of the target color component based on a decoded remaining residual signal of the target color component and the predicted residual signal of the target color component; and</div>
<div class="claim-text">reconstruct samples of the current block based on the residual signal of the target color component.</div>
</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" id="CLM-00077" num="00077">
<div class="claim-text">77. The computer-readable storage medium of <claim-ref idref="CLM-00076">claim 76</claim-ref>, wherein the instructions that, when executed, cause the one or more processors to determine the one or more parameters of the linear model, cause the one or more processors to:
<div class="claim-text">determine a prediction error as a function of reference sample values of a reference target color component and reference sample values of a reference source color component; and</div>
<div class="claim-text">select values of the one or more parameters of the linear model that minimize the prediction error, wherein selecting the values of the one or more parameters of the linear model includes selecting a weighting factor α and an offset β that minimize E(α,β), where</div>
</div>
<div class="claim-text">
<maths id="MATH-US-00024" num="00024">
<math overflow="scroll">
<mrow>
<mrow>
<mi>E</mi>
<mo>⁡</mo>
<mrow>
<mo>(</mo>
<mrow>
<mi>α</mi>
<mo>,</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>=</mo>
<mrow>
<munder>
<mo>∑</mo>
<mi>i</mi>
</munder>
<mo>⁢</mo>
<msup>
<mrow>
<mo>(</mo>
<mrow>
<msub>
<mi>y</mi>
<mi>i</mi>
</msub>
<mo>-</mo>
<mrow>
<mo>(</mo>
<mrow>
<mrow>
<mi>α</mi>
<mo>·</mo>
<msub>
<mi>x</mi>
<mi>i</mi>
</msub>
</mrow>
<mo>+</mo>
<mi>β</mi>
</mrow>
<mo>)</mo>
</mrow>
</mrow>
<mo>)</mo>
</mrow>
<mn>2</mn>
</msup>
</mrow>
</mrow>
</math>
</maths>
</div>
<div class="claim-text">where y<sub>i </sub>are reference sample values of the reference target color component and x<sub>i </sub>are reference sample values of the reference source color component.</div>
</div>
</div> </div>
</div>
</section>
                </article>
            </search-app>
        </body>
    </html>
    