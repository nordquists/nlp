
    <html>
        <body>
            <search-app>
                <article class="result" itemscope="" itemtype="http://schema.org/ScholarlyArticle">
    <h1 itemprop="pageTitle">CN107913509A - 一种基于映射范围识别的乒乓球定位方法及系统 
        - Google Patents</h1><section itemprop="abstract" itemscope="">
<h2>Abstract</h2>
<div html="" itemprop="content"><abstract lang="ZH" load-source="patent-office" mxw-id="PA319080212">
<div class="abstract" num="0001">本发明公开了一种基于映射范围识别的乒乓球定位方法及系统。其系统包括获取映射图像数据及判断乒乓球是否在映射区域模块、计算乒乓球在映射图像中的位置模块、识别乒乓球是否在桌面范围及转换坐标系模块、计算乒乓球的空间位置模块。乒乓球桌面上方布置的灰度相机所拍摄的图像背景中存在乒乓球桌和地面两个高低不同的平面，本发明首先通过映射范围识别判断乒乓球是否位于桌面范围，然后计算乒乓球在两个映射平面中的位置，转换为统一空间中的位置，最终计算出乒乓球位置。本发明解决了基于物联网的乒乓球运动系统不能简单有效地计算处于运动状态的乒乓球的实时位置的问题。</div>
</abstract>
</div>
</section><section itemprop="description" itemscope="">
<h2>Description</h2>
<div html="" itemprop="content"><div class="description" lang="ZH" load-source="patent-office" mxw-id="PDES133664308">
<div class="description-paragraph">一种基于映射范围识别的乒乓球定位方法及系统</div>
<technical-field>
<div class="description-paragraph">技术领域</div>
<div class="description-paragraph">[0001] 本发明属于智能乒乓球运动技术领域，特别是涉及一种基于映射范围识别的乒乓 球定位方法及系统。</div>
</technical-field>
<background-art>
<div class="description-paragraph">背景技术</div>
<div class="description-paragraph">[0002] 目前对乒乓球运动定位的方案主要有两类，一种是计算机视觉分析方法，一种是 信号触发判断方法。</div>
<div class="description-paragraph">[0003] 计算机视觉分析方法主要通过多台高速高清摄像机实时采集兵兵球运动时的录 像，对录像中的每个图像进行目标识别和空间定位后形成数据，再通过滤波和跟踪计算乒 乓球的位置，该方法的缺点是计算复杂度高。</div>
<div class="description-paragraph">[0004] 信号触发判断方法是通过安装在乒乓球台和球网的压电传感器获取因受到乒乓 球撞击而产生的震动信号，比较多个震动信号的强度和产生时间，从而计算出乒乓球的撞 击位置和大致的运动轨迹，该方案的缺点是不能定位乒乓球在空中的位置。</div>
</background-art>
<disclosure>
<div class="description-paragraph">发明内容</div>
<div class="description-paragraph">[0005] 本发明所要解决的技术问题是基于物联网的乒乓球运动系统不能简单有效地计 算处于运动状态的乒乓球的实时位置的问题，提出一种基于映射范围识别的乒乓球定位方 法及系统。</div>
<div class="description-paragraph">[0006] 映射解析定位是指用灰度相机以纯色幕布为背景拍照获取某物体在幕布上的图 像，确定该物体在幕布上的映射位置，根据多组相机的位置及其对应的映射位置实现物体 定位。由于大多数映射背景不是同一平面，若采用相同平面计算乒乓球位置会导致位置计 算偏差。本发明基于如图1所示的乒乓球运动系统，部署在乒乓球桌上方和侧方的灰度相机 获取乒乓球在不同映射平面的映射图像数据，然后发送至服务器，服务器存储数据，计算乒 乓球位置。</div>
<div class="description-paragraph">[0007] 本发明的前置基础是己建立三维空间坐标系，三维空间坐标系原点为乒乓球桌正 中心，X轴和y轴组成水平面，Z轴垂直于桌面向上。正上方灰度相机和侧方灰度相机分别记 为相机1和相机2，记录相机1和相机2的x-y-z三维空间坐标值为(¾，Yi，ZD和(X2，Y2，Z2)。设 置采样时间间隔T，采样时间间隔T小于乒乓球撞击球桌的平均时间间隔(根据历史数据统 计获得）。</div>
<div class="description-paragraph">[0008] 本发明的基于映射范围识别的乒乓球定位系统，包括获取映射图像数据及判断乒 乓球是否在映射区域内模块、计算乒乓球在映射图像中的位置模块、识别乒乓球是否在桌 面范围及转换坐标系模块、计算乒乓球的空间位置模块。</div>
<div class="description-paragraph">[0009]获取映射图像数据及判断乒乓球是否在映射区域内模块:灰度相机按照事先设置 的采样时间间隔T拍摄灰度图像，然后将图像发送至服务器;服务器获取图像数据，根据基 于灰度匹配的图像匹配算法判断灰度图像中是否存在乒乓球的灰度图形，若存在则判定乒 乓球在映射区域内，进入计算乒乓球在映射图像中的位置模块;否则判定乒乓球不在映射 区域内，返回获取映射图像数据及判断乒乓球是否在映射区域内模块。</div>
<div class="description-paragraph">[0010]计算乒乓球在映射图像中的位置模块:球桌正上方和侧方的灰度相机记为相机1 和相机2,两个相机获得的灰度图像分别记为图像1和图像2;以图像1所在平面为基准建立 平面坐标系，记为m-n坐标系，根据灰度图像匹配算法中的互相关度量标准计算图像1中乒 乓球中心点的坐标值为(tn，n);以图像2所在平面为基准建立平面坐标系，记为j_k坐标系， 根据灰度图像匹配算法中的互相关度量标准计算图像2中乒乓球中心点的坐标值为(j，k); 根据图像1和图像2所在平面在x-y-z三维空间系中的位置，将图像1和图像2中乒乓球中心 点的坐标值(m,n)和(j ,k)转化为x-y-z三维空间坐标值(xi，yi，zi)和(X2,y2,Z2)。 识别乒乓球是否在桌面范围及转换坐标系模块:根据图像1中乒乓球中心点的坐 标值以及乒乓球桌面在图像1中的范围判断乒乓球是否在桌面范围内，若乒乓球在桌面范 围内，则根据乒乓球桌在x-y-Z三维空间系中的位置，将映射图像1中乒乓球的坐标值(tn，n) 转化为x-y-z三维空间坐标值(X1，yi，Zl);否则判定乒乓球在地面范围，根据地面在x-y-z三 维空间系中的位置，将映射图像1中兵兵球的坐标值(m,n)转化为x-y-z三维空间坐标值 (xi，y 1，zi);根据幕布在x-y-z三维空间系中的位置，将映射图像2中兵兵球的坐标值(j , k) 转化为x-y-z三维空间坐标值(X2，y2，Z2)。</div>
<div class="description-paragraph">[0012] 计算乒乓球的空间位置模块:相机1和相机2的x-y-z三维空间坐标值为固定值，记 为(mjO和(X2，Y2，Z2)，记相机1与图像1中乒乓球中心点的连线为线段1，记相机2与图 像2中乒乓球中心点的连线为线段2;根据定位精确度设置线段1的拟合数M和线段2的拟合 数N，M和N均为正整数;在线段1上均匀选取M个拟合点，计算M个拟合点的三维空间坐标值， 具体地，根据(Xi，Yi，Zi)和(xi，yi，zi)计算三轴坐标差为 A xi = xi_Xi，A ypyi-Yi，A zi = zi-Zi，将三轴坐标差M等分并在(¾，h的基础上进行依次叠加，获得M个拟合点的三维空间 坐标值;在线段2上均匀选取N个拟合点，计算N个拟合点的三维空间坐标值;计算线段1上M 个拟合点与线段2上N个拟合点之间的最小距离L，则以最小距离L对应的两个拟合点坐标值 的平均值为乒乓球的三维空间坐标值;返回获取映射图像数据及判断乒乓球是否在映射区 域内模块。</div>
<div class="description-paragraph">[0013]基于映射范围识别的乒乓球定位系统的系统框图如图2所示。</div>
<div class="description-paragraph">[0014]本发明的基于映射范围识别的乒乓球定位方法按以下步骤：</div>
<div class="description-paragraph">[0015]步骤1、设置采样间隔及记录相机位置。</div>
<div class="description-paragraph">[0016]设置采样时间间隔T，采样时间间隔T小于乒乓球撞击球桌的平均时间间隔(根据 历史数据统计获得）。球桌正上方和侧方的灰度相机分别记为相机1和相机2,记录相机1和 相机2在X-y-z三维空间系中的位置坐标值为(¾，Yi，Z〇和(X2，Y2，Z2)。</div>
<div class="description-paragraph">[0017]步骤2、获取映射图像数据及判断乒乓球是否在映射区域内。</div>
<div class="description-paragraph">[0018]灰度相机按照事先设置的采样时间间隔T拍摄灰度图像，然后将图像发送至服务 器;服务器获取图像数据，根据基于灰度匹配的图像匹配算法判断灰度图像中是否存在乒 乓球的灰度图形，若存在则判定乒乓球在映射区域内，进入步骤3;否则判定乒乓球不在映 射区域内，返回步骤2。</div>
<div class="description-paragraph">[0019]步骤3、计算乒乓球在映射图像中的位置。</div>
<div class="description-paragraph">[0020]相机1和相机2获得的灰度图像分别记为图像1和图像2;以图像1所在平面为基准 建立平面坐标系，记为m-n坐标系，根据灰度图像匹配算法中的互相关度量标准计算图像1 中乒乓球中心点的坐标值为(m，n);以图像2所在平面为基准建立平面坐标系，记为j-k坐标 系，根据灰度图像匹配算法中的互相关度量标准计算图像2中乒乓球中心点的坐标值为(j， k) 〇</div>
<div class="description-paragraph">[0021]步骤4、识别乒乓球是否在桌面范围及转换坐标系。</div>
<div class="description-paragraph">[0022] 根据图像1中乒乓球中心点的坐标值以及乒乓球桌面在图像1中的范围判断乒乓 球是否在桌面范围内，若兵兵球在桌面范围内，则根据兵兵球桌在x-y-z三维空间系中的位 置，将映射图像1中乒乓球的坐标值(m,n)转化为x-y-z三维空间坐标值(Xl，yi，zi);否则判 定兵兵球在地面范围，根据地面在x-y-z三维空间系中的位置，将映射图像1中兵兵球的坐 标值(m，n)转化为x-y-z三维空间坐标值(xi，yi，zi);根据幕布在x-y-z三维空间系中的位 置，将映射图像2中乒乓球的坐标值(j，k)转化为x-y-z三维空间坐标值(X2，y2，Z2)。</div>
<div class="description-paragraph">[0023] 步骤5、计算乒乓球的空间位置。</div>
<div class="description-paragraph">[0024] 记相机1与图像1中乒乓球中心点的连线为线段1，记相机2与图像2中乒乓球中心 点的连线为线段2;根据定位精确度设置线段1的拟合数M和线段2的拟合数N，M和N均为正整 数;在线段1上均匀选取M个拟合点，计算M个拟合点的三维空间坐标值，具体地，根据(¾，Yi， Zi)和(xi，yi，zi)计算三轴坐标差为A xi = xi_Xi，A yi = yi-Yi，A zi = zi-Zi，将三轴坐标差M 等分并在(X^Y^ZD的基础上进行依次叠加，获得M个拟合点的三维空间坐标值;在线段2上 均匀选取N个拟合点，计算N个拟合点的三维空间坐标值;计算线段1上M个拟合点与线段2上 N个拟合点之间的最小距离L，则以最小距离L对应的两个拟合点坐标值的平均值为乒乓球 的三维空间坐标值;返回步骤2。</div>
<div class="description-paragraph">[0025]基于映射范围识别的乒乓球定位方法流程图，如图3所示。</div>
<div class="description-paragraph">[0026]本发明的方法及系统具有的优点是：</div>
<div class="description-paragraph">[0027] (1)通过识别桌面映射范围区分乒乓球桌面和地面，使映射解析定位更准确。</div>
<div class="description-paragraph">[0028] ⑵采用线段拟合算法进行映射解析定位，降低计算乒乓球位置的复杂度。</div>
</disclosure>
<description-of-drawings>
<div class="description-paragraph">附图说明</div>
<div class="description-paragraph">[0029]图1是本发明的基于映射范围识别乒乓球定位的乒乓球运动系统的结构示意图； [0030]图2是本发明的基于映射范围识别的乒乓球定位系统框图；</div>
<div class="description-paragraph">[0031]图3是本发明的基于映射范围识别的乒乓球定位方法流程图；</div>
<div class="description-paragraph">[0032]图4是本发明实施例的基于映射范围识别的乒乓球系统中乒乓球空间位置示意 图；</div>
</description-of-drawings>
<mode-for-invention>
<div class="description-paragraph">具体实施方式</div>
<div class="description-paragraph">[0033]下面对本发明优选实施例作详细说明。</div>
<div class="description-paragraph">[0034]本发明基于映射解析定位技术。映射解析定位是指用灰度相机以纯色幕布为背景 拍照获取某物体在幕布上的图像，确定该物体在幕布上的映射位置，根据多组相机的位置 及其对应的映射位置实现物体定位。由于大多数映射背景不是同一平面，若采用相同平面 计算乒乓球位置会导致位置计算偏差。在如图1所示的乒乓球运动系统中，部署在乒乓球桌 上方和侧方的灰度相机获取乒乓球在不同映射平面的映射图像数据，然后发送至服务器， 服务器存储数据，计算乒乓球位置，其中乒乓球桌面上方布置的灰度相机所拍摄的图像背 景中存在乒乓球桌和地面两个高低不同的平面。本发明首先通过映射范围识别判断乒乓球 是否位于桌面范围，然后计算乒乓球在两个映射平面中的位置及转换为统一空间中的位 置，最终计算出乒乓球位置。</div>
<div class="description-paragraph">[0035]本发明的前置基础是已建立三维空间坐标系，三维空间坐标系原点为乒乓球桌正 中心，x轴和y轴组成水平面，z轴垂直于桌面向上。正上方灰度相机和侧方灰度相机分别记 为相机1和相机2，记录相机1和相机2的x-y-z三维空间坐标值为(¾，Yi，ZD和(X2，Y2，Z2)。设 置采样时间间隔T，采样时间间隔T小于乒乓球撞击球桌的平均时间间隔(根据历史数据统 计获得）。本实施例中，三维空间坐标系的原点为乒乓球桌正中心，乒乓球桌正中心是指乒 乓球网中心轴与乒乓球桌的交点，x轴平行于乒乓球桌窄边，y轴平行于乒乓球桌长边，2轴 垂直于桌面向上，如图4所示。正上方灰度相机和侧方灰度相机分别记为相机1和相机2,相 机1的三维空间坐标值为(〇,〇,2)，相机2的三维空间坐标值为(2.4,0,0)，单位为米。设置采 样时间间隔T = 1微秒。</div>
<div class="description-paragraph">[0036]本发明的基于映射范围识别的乒乓球定位系统，包括获取映射图像数据及判断乒 乓球是否在映射区域内模块、计算乒乓球在映射图像中的位置模块、识别乒乓球是否在桌 面范围及转换坐标系模块、计算乒乓球的空间位置模块。</div>
<div class="description-paragraph">[0037]获取映射图像数据及判断乒乓球是否在映射区域内模块:灰度相机按照事先设置 的采样时间间隔T拍摄灰度图像，然后将图像发送至服务器;服务器获取图像数据，根据基 于灰度匹配的图像匹配算法判断灰度图像中是否存在乒乓球的灰度图形，若存在则判定乒 乓球在映射区域内，进入计算乒乓球在映射图像中的位置模块;否则判定乒乓球不在映射 区域内，返回获取映射图像数据及判断乒乓球是否在映射区域内模块。本实施例中，设置的 采样时间间隔T=1微秒，灰度相机按照采样时间间隔T拍摄灰度图像，然后将图像发送至服 务器；服务器根据基于灰度匹配的图像匹配算法计算对比度差异区域的面积，若面积在 0.0015平方米到0.002平方米之间，则判定为灰度图像中存在乒乓球图形;某时刻两个灰度 相机获得的两个灰度图像中，对比度差异较大区域的面积分别为0.0016平方米和0.0018平 方米，均在0.0015平方米到0.002平方米之间，则判定为乒乓球在映射区域内，进入计算乒 乓球在映射图像中的位置模块。</div>
<div class="description-paragraph">[0038] 计算乒乓球在映射图像中的位置模块:球桌正上方和侧方的灰度相机记为相机1 和相机2,两个相机获得的灰度图像分别记为图像1和图像2;以图像1所在平面为基准建立 平面坐标系，记为m-n坐标系，根据灰度图像匹配算法中的互相关度量标准计算图像1中乒 乓球中心点的坐标值为(m，n);以图像2所在平面为基准建立平面坐标系，记为j-k坐标系， 根据灰度图像匹配算法中的互相关度量标准计算图像2中乒乓球中心点的坐标值为(j,k); 根据图像1和图像2所在平面在x-y-z三维空间系中的位置，将图像1和图像2中乒乓球中心 点的坐标值(m，n)和（j，k)转化为x-y-z三维空间坐标值(xi，yi，zi)和(x2，y2，z2)。本实施例 中，图像1为乒乓球桌正面的图像，图像2为幕布的图像，以图像1和图像2所在平面建立的平 面坐标系的坐标原点均为各自图像的左上角，图像1长边为m，短边为n，图像2长边为j，短边 为k。根据灰度图像匹配算法中已有的互相关度量标准，计算出与图像1取得互相关函数最 大值的坐标点为图像1中乒乓球中心点的坐标值(2 • 7，1 • 2)，计算出与图像2取得互相关函 数最大值的坐标点为图像2中乒乓球中心点的坐标值(2.65,0.24)。</div>
<div class="description-paragraph">[0039] 识别乒乓球是否在桌面范围及转换坐标系模块:根据图像1中乒乓球中心点的坐 标值以及乒乓球桌面在图像1中的范围判断乒乓球是否在桌面范围内，若乒乓球在桌面范 围内，则根据乒乓球桌在x-y-z三维空间系中的位置，将映射图像丨中乒乓球的坐标值(m，n) 转化为x-y-z三维空间坐标值(X1，yi，Z1);否则判定乒乓球在地面范围，根据地面在x_y_z三 维空间系中的位^，将映射图像1中乒乓球的坐标值(m，n)转化为x-y_z三维空间坐标值 (xi，y 1，z 1);根据幕布在x-y-z三维空间系中的位置，将映射图像2中兵兵球的坐标值(j，k) 转化为X-y-Z三维空间坐标值(X2，y2，Z2)。本实施例中，根据图像丨中乒乓球中心点坐标值 (2.7，1_2)判定乒乓球在乒乓球桌面范围内，则根据乒乓球桌面在x_y_z三维空间系中的位 置，得到图像1中乒乓球的三维空间坐标值为（1 • 2，2 • 7，0);图像2所在平面在三维空间坐标 系中的位置根据幕布的大小和位置确定，幕布为2740毫米X 2500毫米，放置位置距离乒乓 球桌距离为1米，放置高度为离地面3米，则图像2中乒乓球的三维空间坐标值为(-1.7625， 2_65,2) 〇</div>
<div class="description-paragraph">[0040]计算乒乓球的空间位置模块:相机1和相机2的x-y-z三维空间坐标值为固定值，记 为(Xi，h，Z0和(Xs，Ys，Zs)，记相机1与图像i中乒乓球中心点的连线为线段丨，记相机2与图 像2中乒乓球中心点的连线为线段2;根据定位精确度设置线段1的拟合数M和线段2的拟合 数N，M和N均为正整数;在线段1上均匀选取M个拟合点，计算M个拟合点的三维空间坐标值， 具体地，根据(Xi，Yi，Zi)和(xi，yi，zi)计算二轴坐标差为 A xi = xi~Xi，A yi = yi_Yi，A zi = zi-Zi，将三轴坐标差M等分并在％，Yi，ZD的基础上进行依次叠加，获得M个拟合点的三维空间 坐标值;在线段2上均匀选取N个拟合点，计算N个拟合点的三维空间坐标值;计算线段1上M 个拟合点与线段2上N个拟合点之间的最小距离，则以最小距离对应的两个拟合点坐标值的 平均值为乒乓球的三维空间坐标值;返回获取映射图像数据及判断乒乓球是否在映射区域 内模块。本实施例中，相机1的三维空间坐标值为(0,0,2)，相机2的三维空间坐标值为(2.4， 〇，〇)，图像1中乒乓球的三维空间坐标值为（1 • 2,2 • 7，0)，图像2中乒乓球的三维空间坐标值 为(-1.76¾，2 • 65，2)，线段1和线段2如图4所示，根据定位精度(厘米级)粗略设置其拟合点 个数均为10,即M=N=10。贝!J线段1的三轴坐标差：AX1 = 1.2, Ayi = 2.7, AZ1 = -2,线段1中 10个拟合点的三维空间坐标值分别为(0.12，0.27,1.8)、（0.24,0.54,1.6)、（0.36,0.81， 1.4)、（0.48,1.08,1.2)、（0.6,1.35,1)、（0.72,1.62,0.8)、（0.84,1.89,0.6)、（0.96,2.16， 0) 、（1.08,2.43,0)、（1.2,2_7,0);同理线段2的二轴坐标差：A x2 = -4.16, A y2 = 2.65, A Z2 =2，则线段2中10个拟合点的三维空间坐标值分别为（1.984，0 • 265，0.2)、（1.568，0.53， 0.4)、（1.152,0.795,0.6)、（0.736，1.06,0.8)、（0.32，1.325，1)、（—0.096，1.59，1.2)、（— 0-512，1.855，1.4)、（-0_928,2.12，1_6)、（-1.344,2_385，1.8)、（-1.7625,2_65,2);计算出 线段1中各点到线段2中各点的最小距离L = 0.28m，L由坐标值（0 • 6，1.35,1)和（0.32， 1.325,1)得到，计算(0.6,1.35,1)和(0.32,1.325,1)的平均值(x，y，z) = (0.46,1.3375， 1) ，以此作为乒乓球三维空间坐标值;返回获取映射图像数据及判断乒乓球是否在映射区 域内模块。</div>
<div class="description-paragraph">[0041] 本发明的基于映射范围识别的乒乓球定位方法按以下步骤：</div>
<div class="description-paragraph">[0042]步骤1、设置采样间隔及记录相机位置。</div>
<div class="description-paragraph">[0043]设置采样时间间隔T，采样时间间隔T小于乒乓球撞击球桌的平均时间间隔（根据 历史数据统计获得）。球桌正上方和侧方的灰度相机分别记为相机1和相机2,记录相机1和 相机2在x-y-Z三维空间系中的位置坐标值为(¾，Yi, ZD和(Xs，Y2，Zs)。本实施例中，设置采 样时间间隔T=1微秒;球桌正上方和侧方的灰度相机记为相机1和相机2,相机1的三维空间 坐标值为(〇,〇,2)，相机2的三维空间坐标值为(2.4,0,0)，单位为米。</div>
<div class="description-paragraph">[0044] 步骤2、获取映射图像数据及判断乒乓球是否在映射区域内。</div>
<div class="description-paragraph">[0045]灰度相机按照事先设置的采样时间间隔T拍摄灰度图像，然后将图像发送至服务 器;服务器获取图像数据，根据基于灰度匹配的图像匹配算法判断灰度图像中是否存在乒 乓球的灰度图形，若存在则判定乒乓球在映射区域内，进入步骤3;否则判定乒乓球不在映 射区域内，返回步骤2。本实施例中，灰度相机按照事先设置的采样时间间隔T拍摄灰度图 像，然后将图像发送至服务器;服务器根据基于灰度匹配的图像匹配算法计算对比度差异 区域的面积，若面积在0.0015平方米到0.002平方米之间，则判定为灰度图像中存在乒乓球 图形；某时刻两个灰度相机获得的两个灰度图像中，对比度差异较大区域的面积分别为 0.0016平方米和0.0018平方米，均在0.0015平方米到0.002平方米之间，则判定为乒乓球在 映射区域内，进入步骤3。</div>
<div class="description-paragraph">[0046] 步骤3、计算乒乓球在映射图像中的位置。</div>
<div class="description-paragraph">[0047]相机1和相机2获得的灰度图像分别记为图像1和图像2;以图像1所在平面为基准 建立平面坐标系，记为m-n坐标系，根据灰度图像匹配算法中的互相关度量标准计算图像1 中乒乓球中心点的坐标值为(m，n);以图像2所在平面为基准建立平面坐标系，记为j-k坐标 系，根据灰度图像匹配算法中的互相关度量标准计算图像2中乒乓球中心点的坐标值为(j， k)。本实施例中，图像1为乒乓球桌正面的图像，图像2为幕布的图像，以图像1和图像2所在 平面建立的平面坐标系的坐标原点均为各自图像的左上角，图像1长边为m，短边为n，图像2 长边为j，短边为k。根据灰度图像匹配算法中已有的互相关度量标准，计算出与图像1取得 互相关函数最大值的坐标点为图像1中乒乓球中心点的坐标值(2.7,1.2)，计算出与图像2 取得互相关函数最大值的坐标点为图像2中乒乓球中心点的坐标值(2.65,0.24)。</div>
<div class="description-paragraph">[0048]步骤4、识别乒乓球是否在桌面范围及转换坐标系。</div>
<div class="description-paragraph">[0049]根据图像1中乒乓球中心点的坐标值以及乒乓球桌面在图像1中的范围判断乒乓 球是否在桌面范围内，若乒乓球在桌面范围内，则根据乒乓球桌在x-y-z三维空间系中的位 置，将映射图像1中乒乓球的坐标值(m,n)转化为x-y-z三维空间坐标值(X1，yi,zi);否则判 定乒乓球在地面范围，根据地面在x-y-z三维空间系中的位置，将映射图像丨中乒乓球的坐 标值(m，n)转化为x-y-z三维空间坐标值(xi,yi, zi);根据幕布在x-y-z三维空间系中的位 置，将映射图像2中乒乓球的坐标值(j ,k)转化为x-y-z三维空间坐标值(X2，y2，Z2)。本实施 例中，根据图像1中乒乓球中心点坐标值(2.7，1.2)判定乒乓球在乒乓球桌面范围内，则根 据乒乓球桌面在x - y - z三维空间系中的位置，得到图像1中乒乓球的三维空间坐标值为 (1 • 2，2 • 7，0);图像2所在平面在三维空间坐标系中的位置根据幕布的大小和位置确定，幕 布为2740毫米X 2500毫米，放置位置距离乒乓球桌距离为1米，放置高度为离地面3米，则图 像2中乒乓球的三维空间坐标值为(-1 • 7625，2.65，2)。</div>
<div class="description-paragraph">[0050] 步骤5、计算乒乓球的空间位置。</div>
<div class="description-paragraph">[0051]记相机1与图像1中乒乓球中心点的连线为线段1，记相机2与图像2中乒乓球中心 点的连线为线段2;根据定位精确度设置线段1的拟合数M和线段2的拟合数N，M和N均为正整 数;在线段1上均匀选取M个拟合点，计算M个拟合点的三维空间坐标值，具体地，根据(Xl，Yl， Zi)和(xi，yi，zi)计算三轴坐标差为A xi = xi-Xi，A yi = yi—Yi，A Z1 = Z1-Zi，将三轴坐标差M 寺分开仕的基础上进行依次叠加，获得M个拟合点的三维空间坐标值;在线段2上 均匀选取N个拟合点，计算~个拟合点的三维空间坐标值;计算线段个拟合点与线段2上 N个拟合点之间的最小距离，则以最小距离对应的两个拟合点坐标值的平均值为乒乓球的 三维空间坐标值;返回步骤2。本实施例中，相机1的三维空间坐标值为(〇，〇，2)，相机2的三 维空间坐标值为(2.4,0,0)，图像1中兵兵球的三维空间坐标值为（1.2,2.7,0)，图像2中兵 乓球的三维空间坐标值为(-1 •7625，2 •65，2)，线段1和线段2如图4所示，根据定位精度(厘 米级)粗略设置其拟合点个数均为10，S卩M=N= 10。则线段1的三轴坐标差：A X1 = 1 • 2，A y 1 =2 • 7，A Z1 = -2，线段1中10个拟合点的三维空间坐标值分别为(〇.丨2，〇. 27，1 • 8)、(0 • 24， 0.54,1.6) &gt; (0.36,0.81,1.4) , (0.48,1.08,1.2) , (0.6,1.35,1) , (0.72,1.62,0.8) , (0.84, 1.89,0.6)、（0.96,2.16,0)、（1.08,2.43,0)、（1_2,2.7,0);同理线段 2 的三轴坐标差：AX2 =-4.16，&amp;amp;72 = 2_65，八22 = 2，则线段2中10个拟合点的三维空间坐标值分别为（1.984， 0.265,0.2)、（1.568,0.53，0.4)、（1.152,0.795，0.6)、（0.736，1.06,0.8)、（0.32,1.325， 1)、（-0.〇96，1.59，1.2)、（-0.512，1.855，1.4)、（-0.928,2.12,1.6)、（-1.344,2.385,1.8)、 H.7625,2.65,2);计算出线段1中各点到线段2中各点的最小距离L = 0.28m，L由坐标值 (0.6,1.35,1)和(0.32,1.325,1)得到，计算(0.6,1.35,1)和(0.32,1.325,1)的平均值(X， y，z) L (〇.46，1.3375，1)，以此作为乒乓球三维空间坐标值;返回步骤2。</div>
<div class="description-paragraph">[0052]当然，本技术领域中的普通技术人员应当认识到，以上实施例仅是用来说明本发 明的，而并非作为对本发明的限定，只要在本发明的范围内，对以上实施例的变化、变型都 将落入本发明的保护范围。</div>
</mode-for-invention>
</div>
</div>
</section><section itemprop="claims" itemscope="">
<h2>Claims (<span itemprop="count">10</span>)</h2>
<div html="" itemprop="content"><div class="claims" lang="ZH" load-source="patent-office" mxw-id="PCLM127073035">
<div class="claim"> <div class="claim" num="1">
<div class="claim-text">1. —种基于映射范围识别的乒乓球定位系统，其特征在于包括获取映射图像数据及判 断乒乓球是否在映射区域内模块、计算乒乓球在映射图像中的位置模块、识别乒乓球是否 在桌面范围及转换坐标系模块、计算乒乓球的空间位置模块。</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" num="2">
<div class="claim-text">2. 根据权利要求1所述的基于映射范围识别的乒乓球定位系统，其获取映射图像数据 及判断乒乓球是否在映射区域内模块的特征在于:灰度相机按照事先设置的采样时间间隔 T拍摄灰度图像，然后将图像发送至服务器;服务器获取图像数据，判断灰度图像中是否存 在乒乓球的灰度图形，若存在则判定乒乓球在映射区域内，进入计算乒乓球在映射图像中 的位置模块;否则判定乒乓球不在映射区域内，返回获取映射图像数据及判断乒乓球是否 在映射区域内模块。</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" num="3">
<div class="claim-text">3. 根据权利要求1所述的基于映射范围识别的乒乓球定位系统，其计算乒乓球在映射 图像中的位置模块的特征在于:球桌正上方和侧方的灰度相机记为相机1和相机2,两个相 机获得的灰度图像分别记为图像1和图像2;以图像1所在平面为基准建立平面坐标系，记为 m-n坐标系，计算图像1中乒乓球中心点的坐标值为(ra，n);以图像2所在平面为基准建立平 面坐标系，记为j-k坐标系，计算图像2中兵兵球中心点的坐标值为(j,k)。</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" num="4">
<div class="claim-text">4. 根据权利要求1所述的基于映射范围识别的乒乓球定位系统，其识别乒乓球是否在 桌面范围及转换坐标系模块的特征在于:根据图像1中乒乓球中心点的坐标值以及乒乓球 桌面在图像1中的范围判断乒乓球是否在桌面范围内，若乒乓球在桌面范围内，则根据乒乓 球桌在x-y-z三维空间系中的位置，将映射图像1中兵兵球的坐标值(m，n)转化为x-y-z三维 空间坐标值(xum);否则判定乒乓球在地面范围，根据地面在x-y-z三维空间系中的位 置，将映射图像1中兵兵球的坐标值(m,n)转化为x-y-z三维空间坐标值(xi，yi,zi);根据幕 布在x-y-z三维空间系中的位置，将映射图像2中兵兵球的坐标值(j ,k)转化为x-y-z三维空 间坐标值(X2，y2,Z2)。</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" num="5">
<div class="claim-text">5. 根据权利要求1所述的基于映射范围识别的乒乓球定位系统，其计算乒乓球的空间 位置模块的特征在于:相机1和相机2的x-y-z三维空间坐标值为固定值，记为(Xi，Yi，Z：〇和 (X2，Y2，Z2)，记相机1与图像1中乒乓球中心点的连线为线段1，记相机2与图像2中乒乓球中 心点的连线为线段2;根据定位精确度设置线段1的拟合数M和线段2的拟合数N，M和N均为正 整数;在线段1上均匀选取M个拟合点，计算M个拟合点的三维空间坐标值;在线段2上均匀选 取N个拟合点，计算N个拟合点的三维空间坐标值;计算线段1上M个拟合点与线段2上N个拟 合点之间的最小距离，则以最小距离对应的两个拟合点坐标值的平均值为乒乓球的三维空 间坐标值;返回获取映射图像数据及判断乒乓球是否在映射区域模块。</div>
</div>
</div> <div class="claim"> <div class="claim" num="6">
<div class="claim-text">6. —种基于映射范围识别的乒乓球定位方法，其特征在于包括： 步骤1、设置采样间隔及记录相机位置； 步骤2、获取映射图像数据及判断乒乓球是否在映射区域内； 步骤3、计算乒乓球在映射图像中的位置； 步骤4、识别乒乓球是否在桌面范围及转换坐标系； 步骤5、计算乒乓球的空间位置。</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" num="7">
<div class="claim-text">7. 根据权利要求6所述的基于映射范围识别的乒乓球定位方法，其步骤1和步骤2的特 征在于： 步骤1:设置采样时间间隔T;球桌正上方和侧方的灰度相机分别记为相机1和相机2,记 录相机1和相机2在x-y-z三维空间系中的位置坐标值为(X^Y^ZO和(X2，Y2，Z2)。 步骤2:灰度相机按照事先设置的采样时间间隔T拍摄灰度图像，然后将图像发送至服 务器;服务器获取图像数据，判断灰度图像中是否存在乒乓球的灰度图形，若存在则判定乒 乓球在映射区域内，进入步骤3;否则判定乒乓球不在映射区域内，返回步骤2。</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" num="8">
<div class="claim-text">8. 根据权利要求6所述的基于映射范围识别的乒乓球定位方法，其步骤3的特征在于： 相机1和相机2获得的灰度图像分别记为图像1和图像2;以图像1所在平面为基准建立平面 坐标系，记为m-n坐标系，计算图像1中乒乓球中心点的坐标值为(m，n);以图像2所在平面为 基准建立平面坐标系，记为j-k坐标系，计算图像2中乒乓球中心点的坐标值为(j，k)。</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" num="9">
<div class="claim-text">9. 根据权利要求6所述的基于映射范围识别的乒乓球定位方法，其步骤4的特征在于： 根据图像1中乒乓球中心点的坐标值以及乒乓球桌面在图像1中的范围判断乒乓球是否在 桌面范围内，若乒乓球在桌面范围内，则根据乒乓球桌在x-y-z三维空间系中的位置，将映 射图像1中乒乓球的坐标值(m，n)转化为x-y-z三维空间坐标值(X1，yi，zi);否则判定乒乓球 在地面范围，根据地面在x-y-z三维空间系中的位置，将映射图像1中乒乓球的坐标值(m，n) 转化为x-y-z三维空间坐标值(X1，，Z1);根据幕布在x-y-z三维空间系中的位置，将映射图 像2中兵兵球的坐标值(j，k)转化为x-y-z三维空间坐标值(X2, y2, Z2)。</div>
</div>
</div> <div class="claim-dependent"> <div class="claim" num="10">
<div class="claim-text">10. 根据权利要求6所述的基于映射范围识别的乒乓球定位方法，其步骤5的特征在于： 记相机1与图像1中乒乓球中心点的连线为线段1，记相机2与图像2中乒乓球中心点的连线 为线段2;根据定位精确度设置线段1的拟合数M和线段2的拟合数N，M和N均为正整数;在线 段1上均匀选取M个拟合点，计算M个拟合点的三维空间坐标值;在线段2上均匀选取N个拟合 点，计算N个拟合点的三维空间坐标值;计算线段1上M个拟合点与线段2上N个拟合点之间的 最小距离，则以最小距离对应的两个拟合点坐标值的平均值为乒乓球的三维空间坐标值； 返回步骤2。</div>
</div>
</div> </div>
</div>
</section>
                </article>
            </search-app>
        </body>
    </html>
    